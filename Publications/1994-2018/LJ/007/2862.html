<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>What's GNU</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    This month's column discusses groff, the GNU version of&#10;    troff.&#10;    "><meta name="keywords" content="Groff, command, GNU"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x1048580.0x113fab0"></a>What's GNU</h1></div><div><div class="author"><h3 class="author">Arnold Robbins</h3></div><div class="issuemoyr">Issue #7, November 1994</div></div><div><p>
    This month's column discusses groff, the GNU version of
    troff.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1048580.0x11403a0"></a>groff</h2></div></div><p><span   class="emphasis"><em>This month's column discusses
<b>groff</b>, the GNU version of
<b>troff</b>. Explaining <b>troff</b> in
full detail can (and has!) taken more than one book. For now, we'll
provide a little bit of history and an overview of what
<b>groff</b> is, what the input tends to look like, and
how you would use it.</em></span>
</p><p>by Arnold Robbins</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1048580.0x11406b8"></a>What is <b  >troff</b>?</h2></div></div><p>While there are many WYSIWYG word processing programs out
there, some of which are quite powerful, and others which are
usable and freely available, many long time &ldquo;power users&rdquo; still
prefer text formatters like <b  >troff</b> and TeX for
the control they give you. Another advantage that these programs
have is that you can edit the input using any text editor, even
<b  >ed</b> or <b  >vi</b> over a 2400 baud
modem connection, or on a laptop system that can't support X
windows.</p><p><b  >nroff</b> and <b  >troff</b> are the
Unix text formatters. They are essentially twins; each accepts the
same input &ldquo;language&rdquo;. The difference is in the output they
produce. <b  >nroff</b> was designed to produce output
for devices with fixed-width and fixed-size characters, such as
terminals and line printers. <b  >troff</b> was designed
for photo-typesetters. <b  >nroff</b> simply ignores
requests that it cannot honor. From now on, we will follow the
time-honored convention of referring to both programs as
<b  >troff</b>, to make things simpler.</p><p><b  >troff</b> was written at Bell Laboratories by
the late Joseph Osanna. It was modeled after the text formatters of
the time, notably one named <b  >runoff</b>.
(<b  >runoff</b> was written by Jerry Saltzer for the
CTSS system at MIT, running on a modified IBM 7094, in the middle
1960's time frame.) Interestingly enough, <b  >nroff</b>
was written first; the name stood for &ldquo;new
<b  >runoff</b>&rdquo;. Later, when the research group acquired
a photo-typesetter, <b  >nroff</b> was enhanced to deal
with the newly acquired capabilities, and thus
<b  >troff</b> was born. In the early 1980's, after the
death of Mr. Osanna, Brian Kernighan took over
<b  >troff</b>, cleaned it up and enhanced it. The
<b  >troff</b> language is now frozen. It will not evolve
further.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1048580.0x1140ef8"></a><b  >troff</b>'s Capabilities</h2></div></div><p>Input to <b  >troff</b> is a mixture of text and
formatting commands. You might think of this as &ldquo;what you want to
say&rdquo; and &ldquo;how you want to say it.&rdquo; Typically, commands are on
separate lines by themselves. <b  >troff</b> is able to
distinguish commands from text, since command lines begin with a
dot, or period. Special tricks have to be used to get
<b  >troff</b> to treat a line that begins with a dot as
real text.</p><p>There are a large number of commands in
<b  >troff</b>. Some of the more important commands are
for the following tasks:</p><div class="itemizedlist"><ul type="disc"><li><p>Filling. This means putting as many words of input
text on one output line as possible.</p></li><li><p>Adjusting. This means padding lines with blanks so
that the margins on both sides are even. Book and magazine text is
typically both filled and adjusted.</p></li><li><p>Font changes. Printed text is often in multiple
fonts. <span   class="emphasis"><em>Italics</em></span> are often used for emphasis.
<span   class="bold"><b>Bold</b></span> text is used for strong
emphasis and for headings. <b  >troff</b> supports at
least four fonts normally, with the ability to easily add
others.</p></li><li><p>Size changes. Photo-typesetters give you the
ability to print characters at different sizes. Most text is set in
10-point type, where one point is 1/72 of an inch. Text can be made
smaller or larger as needed. For example, footnotes are often set
in a smaller point size than normal text.</p></li><li><p>Margin control. <b  >troff</b> gives you
separate commands to control the size of all four margins on the
piece of paper. This is typically done using a combination of the</p><div class="itemizedlist"><ul type="circle"><li><p>- line length, how many characters or inches of
text that can be in a line</p></li><li><p>- the page offset, how far to the right to shift
the entire line, and</p></li><li><p>- the indentation, how far left or right from the
beginning of the line to actually place text. E.g., in a book, the
first line of a paragraph is often indented 1/2 an inch.</p></li></ul></div></li><li><p>Centering. Any number of input lines can be
centered in the output text.</p></li><li><p>Line drawing. <b  >troff</b> can draw
horizontal, and vertical lines, as well as arbitrary curves.</p></li><li><p>Horizontal and Vertical Motions. You can move text
up or down an arbitrary amount. Consider subscripts and
superscripts in mathematical formulae, or footnotes indicators,
which are often one half a line up and in a smaller point
size.</p></li></ul></div><p>You can add comments to your <b  >troff</b> source.
They begin with <b  >\"</b> and continue to the end of
the line. We will be using comments in our examples, to help
explain what is going on.</p><p>Many of the facilities can be done both as standalone
commands, and with in-line escape sequences. For example, to change
to a bold font, one might have text like this:</p><pre     class="programlisting">
        Here is some regular text.
        .ft B  \" now switch to bold
        This is bold.
        .ft    \" switch back to earlier font
        This will be regular again.
</pre><p>You can do the same thing with in-line escape sequences. For
font changes, you use <b  >\f</b> and either a single
letter font name, or a <b  >(</b> and a two letter font
name. A similar example would be:</p><pre     class="programlisting">
        Here is some regular text. \fBThis is bold.\fP This will
        be regular again.
</pre><p>The letter <b  >P</b> is special. It means to use
the previous font.</p><p><b  >troff</b> provides two nice features, strings
and number registers. A string is a shorthand for some text. For
example, if you don't want to type <b  >the Linux Operating
System</b> over and over again, you could define a string
<b  >LX</b>, and then use the string in your text. This
feature can save a lot of typing.</p><pre     class="programlisting">
        .ds LX the Linux Operating System \" ds means define string
        If you are new to \*(LX, then you should subscribe to
        \fILinux Journal\fP. It covers \*(LX in great detail,
        month after month.
</pre><p>Number registers are like variables in programming languages.
They can contain numeric values. They can also be used in an
&ldquo;auto-increment&rdquo; and &ldquo;auto-decrement&rdquo; fashion. This means that with
each use, the value goes up by one or down by one. Why would you
need such a thing? Think about automatically numbering chapters,
sections, and subsections, as well as figures and footnotes. You
would have a register for the chapter number, another for the
section number, and so on. With each new chapter, the section
register is reset to one. With each new section, the subsection
register is also reset to one, and so on.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1048580.0x1138a70"></a>Macros</h2></div></div><p>As you are hopefully beginning to see,
<b  >troff</b> provides you all the mechanisms you need
for complete control over your document's format. Unfortunately,
this is often more control than you need. Writing documents using
bare <b  >troff</b>, while possible, can be quite
painful. It is very much like programming in assembly language: you
have complete control, and when the result works it works really
well, but there is an awful lot of detail to keep track of, and it
can be tedious and difficult.</p><p>To make it easier for regular users to manage the detail,
<b  >troff</b> allows you to define macros. A macro is
like a subroutine in a programming language. You can group commands
together to perform a larger task, and use the macro name, instead
of writing out the entire sequence of commands each time.</p><p>Consider starting a new paragraph. You have to do the
following tasks:</p><div class="itemizedlist"><ul type="disc"><li><p>1. See if there is room left on the page for at
least two lines of text.</p></li><li><p>2. Skip a space after the last paragraph.</p></li><li><p>3. Indent the first line of text by 1/2 an
inch.</p></li></ul></div><p>You could write the commands to do this over and over again.
But that is (a) tedious, (b) a hassle to update if you change how
you do paragraphing. Instead, you can define a macro, say
<b  >.P</b>, to do this for you.</p><pre     class="programlisting">
        .de P   \" DEfine paragraph macro
        .ne 3   \" we NEed at least three lines
        .sp     \" SPace down one line
        .ti .5i \" Temporary Indent .5 inches
        ..      \" end the macro definition
</pre><p>Then, in your text, you just put <b  >.P</b> on a
line by itself wherever you want a paragraph.</p><pre     class="programlisting">
        .ds LX the Linux Operating System
        .ds LJ \fILinux Journal\fP
        If you are new to \*(LX, then you should subscribe to
        \*(LJ. It covers \*(LX in great detail,
        month after month.
        .P
        And even if you are an experienced user of \*(LX,
        \*(LJ will bring you valuable tips and tricks to keep
        your Linux system up and running.
</pre><p>One of the less attractive features of standard
<b  >troff</b> is that command, macro, string, and
register names are limited to no more than two characters.
Fortunately, <b  >groff</b> allows longer names, with a
different syntax for accessing them. In fact,
<b  >groff</b> has many nice extensions over
<b  >troff</b>, making the task of writing macro packages
considerably easier. The extensions are documented in the
<b  >gtroff</b>(1) man page.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1048580.0x11393b8"></a>Popular Macro Packages</h2></div></div><p>There are a number of popular <b  >troff</b> macro
packages. Using them is like programming in FORTRAN; it beats the
heck out of Assembly Language, but it's not as nice as C or
Modula-3.</p><p>The common macro packages are:</p><div class="itemizedlist"><ul type="disc"><li><p><b  >-ms</b> - Manuscript macros.
Originated in V7, popular on Berkeley Unix.</p></li><li><p><b  >-man</b> - Manual Page
macros.</p></li><li><p><b  >-mm</b> - Memorandum Macros. Very
powerful macros, popular on System V.</p></li><li><p><b  >-me</b> - Berkeley Technical Paper
macros. An ugly package.</p></li><li><p><b  >-mdoc</b> - The new Document Macros
from Berkeley.</p></li><li><p><b  >-mandoc</b> - A package that figures
out dynamically if you want <b  >-man</b> or
<b  >-mdoc</b>.</p></li></ul></div><p><b  >groff</b> will support these directly if you
have them, particularly using the <b  >-C</b>
compatibility mode option. It also has its own version of many of
these packages.</p><p>The <b  >-ms</b> and <b  >-mm</b> are the
most portable packages to use. <b  >-mm</b> has many more
features than <b  >-ms</b>, thus making it harder to
learn. In the long run though, the effort is worth it, because you
can do so much.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1048580.0x1139f68"></a>Preprocessors For
<b  >troff</b></h2></div></div><p>Over the years, it was found that macros helped, but that
there were some things that were just too difficult to do in bare
<b  >troff</b>, even with macro packages. The approach
that was developed was to write a &ldquo;little language&rdquo; that solved a
particular task, and to pre-process the language into raw
<b  >troff</b>. The common pre-processors are:</p><div class="itemizedlist"><ul type="disc"><li><p><b  >tbl</b> - formats tables</p></li><li><p><b  >eqn</b> - formats equations</p></li><li><p><b  >pic</b> - formats pictures
(diagrams)</p></li><li><p><b  >grap</b> - formats graphs</p></li></ul></div><p>As an example, here is part of a table from a reference card
I worked on:</p><pre     class="programlisting">
        .TS
        tab(~);
        lfB l lfB l.
        abs~absolute value~int~integer part
        acos~arc cosine~log~natural logarithm
        asin~arc sine~sin~sine
        atan~arc tangent~sinh~hyperbolic sine
        cos~cosine~sqrt~square root
        cosh~hyperbolic cosine~tan~tangent
        .TE
</pre><p>We'll explain it line by line. First, <b  >tbl</b>
only looks at lines between <b  >.TS</b> (table start)
and <b  >.TE</b> (table end). Everything else is left
alone. This makes it easy to use <b  >tbl</b> in a
pipeline with the other preprocessors. The first line sets the tab
character to <b  >~</b>. Normally, tabs in the input
separate each column of the table. For this table, a
<b  >~</b> is used to make it easier to mark off the
columns.</p><p>Then, for each line of data in the table, you provide a line
that describes the layout information. <b  >l</b> means
left justified, <b  >r</b> means right justified, and
<b  >c</b> means centered. All the columns in this table
are left justified. The first and third columns also use a
different font (the <b  >f</b>). Here, they are using the
bold font.</p><p>In this example, there is only one control line, so it is
applied to all the data lines. For more complicated tables, you
have one control line per data line, with the last control line
applying to any remaining data lines.</p><p>The other preprocessors are similar in functionality.
<b  >grap</b> is actually a preprocessor for
<b  >pic</b>.</p><p>Typically, the commands are used in a pipeline:</p><pre     class="programlisting">
        grap doc.tr <b  >pic</b>  tbl <b  >eqn</b>  troff -mm -Tps &gt; doc.ps
</pre><p>The actual usage will vary from machine to machine; we'll see
below how to run <b  >groff</b>.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1048580.0x144e3d0"></a>Output Devices</h2></div></div><p><b  >nroff</b> was originally designed for
terminals and line printers, which are devices with fixed width
characters. <b  >troff</b> was designed for the Wang CAT
photo-typsetter, which could have up to four different fonts
available, in many different point sizes.</p><p>Around 1980, Brian Kernighan revamped
<b  >troff</b> to create <b  >ditroff</b>, the
device-independent <b  >troff</b>. This version accepted
an enhanced language, and generated ASCII output that described the
motions the output device should make around the page, the size and
placement of characters, and so on. Then, to add a new output
device (laser printer, photo-typesetter, or whatever), you would
write a post-processor for the device independent output that would
correctly drive your device. Recent version of
<b  >troff</b> are the device-independent version,
usually with support for PostScript(TM) output.</p><p>The <b  >ditroff</b> saga can be found in Bell Labs
Computing Science Technical Report #97. You can get PostScript for
this report via anonymous <b  >ftp</b> to
<b  >netlib.att.com</b>. Change to
<b  >/netlib/att/cs/cstr</b>, use
<b  >binary</b> mode, and retrieve
<b  >97.ps.Z</b>.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1048580.0x144e9a8"></a>GNU <b  >troff</b></h2></div></div><p>Now that you know what <b  >troff</b> is, we'll
discuss the specifics of the GNU version, <b  >groff</b>.
<b  >groff</b> is written in C++. This is somewhat
unusual; most GNU programs are written in C. To compile it, you
need a C++ compiler. The GNU C++ compiler, <b  >g++</b>,
will usually do it with little problem. You will need both
<b  >g++</b> and the GNU C++ library,
<b  >libg++</b> to compile the <b  >groff</b>
suite of programs.</p><p>The programs in the suite are:</p><pre     class="programlisting">
        <b  >gtroff</b> - the actual <b  >troff</b> clone
        <b  >gtbl</b> - the <b  >tbl</b> clone
        <b  >geqn</b> - the <b  >eqn</b> clone
        <b  >gpic</b> - the <b  >pic</b> clone
        <b  >groff</b> - the driver for the other programs
</pre><p>There is no <b  >grap</b> clone. Anyone who wishes
to write one should contact
<b  >gnu@prep.ai.mit.edu</b>.</p><p><b  >groff</b> has a large number of extensions
over Unix <b  >troff</b>. It particular,
<b  >groff</b> supports long names for commands, strings,
and registers, and has many additional commands. It also has a
compatibility mode, where all the extensions are turned off. This
is occasionally necessary when using macro packages meant for
original <b  >troff</b>.</p><p>The <b  >groff</b> pre-processors described above
cannot be used with original <b  >troff</b>; they take
advantage of <b  >groff</b>'s extensions.</p><p><b  >groff</b> uses the <b  >ditroff</b>
model of post-processors for different devices, with the same
intermediate format. By default, <b  >groff</b> generates
PostScript output. The other most useful output format is plain
ASCII. This is in fact how <b  >nroff</b> is provided; by
a shell script that calls <b  >groff -Tascii</b> (i.e.,
the output type [<b  >-T</b>] is ASCII). An interesting
output type is TeX DVI, which can be used on many older laser
printers that do not support PostScript. <b  >groff</b>
comes with two previewers for X windows, using different density
fonts (75 and 100 dots per inch).</p><p><b  >groff</b> comes with a number of macro
packages. It has its own version of the <b  >-man</b>
macros. The <b  >-mgs</b> package is the GNU version of
<b  >-ms</b>, and <b  >-mgm</b> is the GNU
version of <b  >-mm</b>. These should be used in
preference to the original packages, since they can also take
advantage of the <b  >groff</b> extensions. The Berkeley
<b  >-me</b>, <b  >-mdoc</b>, and
<b  >-mandoc</b> packages are themselves freely
distributable, and are included with the <b  >groff</b>
distribution.</p><p>What is really nice about <b  >groff</b> is that it
is like <b  >lint</b> for your <b  >troff</b>
documents. The programs check *everything*. Many things that Unix
<b  >troff</b> silently ignores, <b  >groff</b>
will warn you about. Often there are subtle errors in your files,
and <b  >groff</b> will help you catch the problems.
Although every once in a while, there really is no problem, and you
need to use compatibility mode instead.</p><p>Unfortunately, the one major lack in the
<b  >groff</b> distribution is that there is no
comprehensive manual. The Tenth Edition Research Unix Programmer's
Manual describes <b  >troff</b> and its friends in
detail. <b  >groff</b> is based on this specification.
Additional information can be found in the man pages that come with
<b  >groff</b>.</p><p>Information about <b  >pic</b> can be obtained via
anonymous <b  >ftp</b> from the same site and directory
mentioned above, in the file <b  >116.ps.Z</b>. A
description of <b  >grap</b> can be found in
<b  >114.ps.Z</b>.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1048580.0x16cac78"></a>Summary</h2></div></div><p>GNU <b  >troff</b>, <b  >groff</b> is a
powerful, complete implementation of the <b  >troff</b>
software suite. If you will be doing anything with
<b  >troff</b>, it is definitely the version to get. It
generates PostScript by default, will find bugs in your documents,
and supports all popular macro packages. The source code is
available on <b  >prep.ai.mit.edu</b> in
<b  >/pub/gnu</b>, in the file
<b  >groff-1.09.tar.gz</b>. It should be found on all GNU
mirror sites as well.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1048580.0x16cafe8"></a>Editorial</h2></div></div><p>Every once in a while, it is a worthwhile exercise to step
back and stop and think about the free software you use with Linux,
day in and day out. The Linux kernel is only one part of it. There
are literally hundreds of utility programs, the majority of which
were produced by Free Software Foundation staff and volunteers. The
GNU General Public License, whose terms cover the utilities and the
Linux kernel, came from the FSF. Linux is testimony to the idea
that freely distributable software can be usable, and of high
quality. Linux would have never happened if it had it *not* been
free, and had there not been the GNU utilities to complete the
picture.</p><p><a href="2862s1.html" target="_self">Free Software Foundation
Information</a></p><p>It is only good sportsmanship and fair play to &ldquo;give
something back&rdquo; to the organization that has done so much for you:
the FSF. You can help further the cause of the FSF in a number of
ways, both directly and indirectly.</p><p>If you are a programmer or a writer, or both, the FSF has
software *and* documentation that needs to be written. Serious
volunteers are always welcome.</p><p>If you want to help support the FSF monetarily, you can do
that too. You can buy software and/or documentation from them. The
FSF sells tape and CD-ROMs with their software on it. You probably
already have most of the software, but you may wish to have the
printed documentation that goes with it. The GNU manuals are nicely
printed and bound, and are not that expensive. Buying software and
manuals directly contributes to the production of more, high
quality, free software.</p><p>In the U.S., you can make tax-deductible donations to the
FSF. It is considered a non-profit organization under U.S. law.
This also helps.</p><p>Indirectly, you can choose to buy your Linux distributions
from resellers who state that they give a percentage to the FSF. If
your favorite distributor does not do this, then ask them *why*
they don't, and encourage them to do so.</p><p>Consider what you can do to help the FSF, and then do
it!</p></div></div>
<div class="authorblurb"><p>
           <span   class="bold"><b>Arnold Robbins</b></span>
           is a professional programmer and semi-professional author. He has been doing volunteer work for the GNU project since 1987 and working with Unix and Unix-like systems
           since 1981.
        </p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../007/toc007.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>