<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Paranoid Penguin
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Use old-school administration skills to benefit from modern tools on Ubuntu&#10;Server.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x137b580.0x1472ac0"></a>
Paranoid Penguin
</h1></div><div><h3 class="subtitle"><i>
Security Features in Ubuntu Server
</i></h3></div><div><div class="author"><h3 class="author">
Mick
 
Bauer
</h3></div><div class="issuemoyr">Issue #168, April 2008</div></div><div><p>
Use old-school administration skills to benefit from modern tools on Ubuntu
Server.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x1473460"></a></h2></div></div><p>
Last month, I offered a survey of security features in Ubuntu Desktop
7.10, a single-CD Linux distribution that combines the flexibility of
Debian with a very easy-to-use set of graphical setup/administration
tools. Ubuntu also comes in a server version, which
in some ways is just a re-configuration of Ubuntu Desktop, but nonetheless,
it's a
different distribution in its own right.
</p><p>
This month, I survey some of the major security features in Ubuntu
Server 7.10. Unlike Ubuntu Desktop, Ubuntu Server is probably the wrong choice
for complete Linux newcomers. It's extremely command-line-centric, and
its documentation is not exactly encyclopedic. Accordingly, this month's
column assumes you've got a basic understanding of how Linux works
and some comfort with the command prompt.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x1473670"></a>
Ubuntu Server vs. Desktop</h2></div></div><p>
There are several key differences between Ubuntu Server and Ubuntu
Desktop. First, and most obvious, is the lack of any graphical tools.
Ubuntu Server doesn't install the X Window System automatically. This
has become an increasingly rare approach, even with server-oriented Linux
distributions. But, as I explain shortly, omitting the X Window System
improves system security and performance and decreases system complexity.
</p><p>
Second, Ubuntu Server installs a much smaller set of packages overall
than Ubuntu Desktop. (In fact, there's ample room on the Ubuntu Server
CD image to add things of your own&mdash;watch this column for a future
series on customizing and building your own bootable CD images.) You
might think this means that Ubuntu Server offers fewer choices in
server applications, but as I show here, these aren't fewer choices than
on other popular server-oriented distributions. And besides, you can
install additional Ubuntu packages easily over the Internet.
</p><p>
The last major difference worth noting is that Ubuntu Server's default
kernel is tuned for server performance, whereas Ubuntu Desktop's default
kernel is tuned for maximum responsiveness. An article by Carla Schroder
on these differences details some specifics as
to how this is achieved (see Resources).
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x1473828"></a>
Did Mick Just Say, &ldquo;No Graphical Tools?&rdquo;</h2></div></div><p>
Yes, you read that right. By default, Ubuntu Server is a
purely console-driven distribution. On Ubuntu Server, you do things the
old-school way, with shell sessions, man page lookups and the vi editor.
</p><p>
Of course, there's nothing to stop you from installing the X Window System,
complete with a fully packed KDE desktop environment, OpenOffice.org
and <span   class="emphasis"><em>Tux Racer</em></span>. Ubuntu's download repositories don't distinguish between
Server and Desktop, so you can install whatever you like. However, I
very strongly suggest you resist the temptation to install the X Window
System on your Ubuntu Server system.
</p><p>
When the first edition of my book <span   class="emphasis"><em>Linux Server
Security</em></span> came out (which
I try not to plug here, but this is after all an article on Linux server
security), one reviewer complained bitterly about my advice to omit the
X Window System from server installations. But, for years I've stood firm
on this advice. The X Window System increases complexity. It has a history of
&ldquo;local privilege escalation&rdquo; vulnerabilities (that can often be exploited
remotely), and it always imposes a significant performance penalty.
</p><p>
&ldquo;Keep it simple&rdquo; is one of the most important tenets of good system
security. If you don't need something, you should live without it. And,
in most server scenarios, when a system's primary function is to
provide various network services, and wherein what little
&ldquo;interactive&rdquo;
access necessary for administration can be done remotely, it's hard to
justify the increased attack surface and overall complexity that come
from running X.
</p><p>
Besides, even in Ubuntu Desktop, many if not most serious configuration
and security tasks at some point require you to open a terminal
and issue commands with sudo. If you want to be an Ubuntu system
administrator (or more than a novice at Linux in general), there's no
getting around needing to be able to cope with the command line. So I
applaud the Ubuntu team's common sense (and courage) in keeping the X
Window System out of the default installation of Ubuntu Server.
</p><p>
If you really need a GUI experience in administering your Ubuntu Server
system, there are remote administration tools you can use (Webmin,
for example&mdash;see Resources, and also see Federico Kereki's article
&ldquo;Graphic Administrationwiht Webmin&rdquo; on page 64) that provide this without requiring X on
the server itself.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x1473e00"></a>
Ubuntu Server Installation</h2></div></div><p>
As I've often said, security begins with operating system installation.
This is where you decide your system's role, what set of applications
will run on the machine, and what type and degree of user access it
will support. So, to what degree does the Ubuntu Server installer help
system security?
</p><p>
The Ubuntu Server installer is very similar to the Ubuntu Desktop
installer, except that the Server installer is, if anything, even more
minimalist. It guides you through partitioning your hard disk, asks
what category of software packages to install, walks you through
creating a login account (<span   class="emphasis"><em>not</em></span> root), installs the software, and
then, depending on what you installed, it may or may not ask you a few
very basic questions with which it begins (barely) configuring
one or more of those applications.
</p><div       class="mediaobject"><a href="10012f1.large.jpg"><img src="10012f1.jpg"></a><div class="caption"><p>
Figure 1. Ubuntu Server installer offers encrypted volumes.
</p></div></div><p>
The good news is that the Ubuntu Server installer: 
</p><div class="itemizedlist"><ul type="disc"><li><p>
Can create encrypted disk volumes.
</p></li><li><p>
Doesn't ask you for a root password, because you never log on as root in
Ubuntu.
</p></li><li><p>
Is surprisingly fast, obviously thanks to its simplicity.
</p></li><li><p>
Generally installs things with conservative, fairly secure, default
settings (which is actually a function of packages' individual
installation scripts).
</p></li></ul></div><p>
The bad news is that the Ubuntu Server installer:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Doesn't allow you to select specific/individual software packages; instead,
it just asks you the general role the server will play (Figure 2).
</p></li><li><p>
Prompts you for the MySQL administrator's password, but doesn't prompt
you a second time to make sure you didn't mistype it.
</p></li><li><p>
Doesn't check passwords for complexity (uppercase/lowercase, numerals and
so forth).
</p></li></ul></div><div       class="mediaobject"><a href="10012f2.large.jpg"><img src="10012f2.jpg"></a><div class="caption"><p>
Figure 2. Selecting Server Software Bundles
</p></div></div><p>
After installation, you may notice that most if not all the server
applications you installed (Apache, Postfix and so forth) are up and
running, even though you haven't really configured them yet. You'll
need to do that yourself by editing the appropriate configuration files
in /etc.
</p><p>
On the one hand, my personal preference is that, by default, network
services should be disabled initially, to make it harder for an attacker
to exploit an application that has been overlooked altogether or
that is still in the process of being configured. On the other hand,
because
Ubuntu's default application configurations tend to be fairly secure,
this probably doesn't pose a huge risk.
</p><p>
For example, immediately after installation, Apache is started,
displaying a simple &ldquo;It works!&rdquo; page, which announces to the world that
you've just installed Apache but haven't gotten around to configuring it
yet. (Ow!) But, there's no obvious way for an attacker to exploit this.
You can't recurse out of the nearly empty default http root directory,
default CGI scripts aren't present and so on.
</p><p>
If you're worried about this, you simply can shut down these newly installed
services until you've configured them. Or, better still, stage your
new server on a protected LAN before connecting it to the Internet.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x1474b68"></a>
How Not to Be Root in Ubuntu</h2></div></div><p>
As I explained in last month's column, Ubuntu is set up so that you never
can actually
log on as root. Instead, you create one or more nonprivileged login
accounts that are authorized to execute root-privileged commands via
sudo, the &ldquo;superuser do&rdquo; command. This makes it harder to 
damage your system accidentally, and it has the security benefit of removing the root
account as a viable attack vector, because root has no password and can't
log in.
</p><p>
So, for example, whereas on a standard Debian system you might install
the package foo with this command:

<pre     class="programlisting">
aptitude install foo
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x186cfc8"></a></h2></div></div><p>
On Ubuntu, you'd use:

<pre     class="programlisting">
sudo aptitude install foo
</pre>
</p><p>
After issuing any command with sudo, you'll be prompted for your
<span   class="emphasis"><em>own</em></span>
password, not root's, which will be cached for a brief period of time
during which subsequent sudo commands won't require re-authorization.
</p><p>
If you need to change sudo's configuration (which determines who is
authorized to run which commands, under what circumstances), you must
use the visudo command to edit the file /etc/sudoers. The Ubuntu
RootSudo Page (see Resources) provides more information.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x186d230"></a>
Installing Optional Software</h2></div></div><p>
It's no coincidence that I used the aptitude command in the above
examples. Chances are, one of the first things you'll do after installing
Ubuntu Server is install some additional software, and aptitude is
Ubuntu Server's best tool for this job.
</p><p>
Perhaps surprisingly, given that the Ubuntu Server distribution doesn't
even fill a 650MB CD-ROM, there are many useful packages from which to choose 
on the CD in its /pool directory. When you install Ubuntu Server, the
installer also automatically configures the Advanced Package Tool
(apt) system, for which aptitude is a front end, with the locations of
some download repositories.
</p><p>
In last month's column, I described the Ubuntu repository structure in detail. In
case you missed that, here's a quick review:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Main contains Ubuntu's fully supported, fully patched, free software
packages.
</p></li><li><p>
Restricted contains Ubuntu's fully supported, nonfree (copyrighted)
software packages.
</p></li><li><p>
Universe contains Ubuntu's free but not fully supported/patched packages.
</p></li><li><p>
Multiverse contains packages that are neither fully free nor fully
supported/patched.
</p></li></ul></div><p>
You might think that on a server system, universe and multiverse
packages should be avoided, as they lack any guarantee of timely
security patches or bug fixes. And, as a general rule, I think you'd
be right.
</p><p>
But, there are some notable packages in universe and multiverse that may
be worth installing and sustaining whatever risk is entailed. One such
package is Bastille (in universe), a comprehensive system-hardening tool
you can uninstall after it does its thing. Another
<span   class="emphasis"><em>might</em></span> be Tripwire
(in multiverse), which is the classic file integrity checker, though
the main repository's aide packages provide the same functionality
and are fully supported by the Ubuntu security team.
</p><p>
All of these packages are part of the main repository. Unlike with
Ubuntu Desktop, however, these can be installed from the Ubuntu Server CD.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x186d860"></a>
Notable Ubuntu Server Packages</h2></div></div><p>
Space does not permit me to include lengthy charts of
security-related packages like those I provided in the Ubuntu Desktop
column last month. If I did, they would be very similar except
for two things.
</p><p>
First, I would omit security auditing tools, such as Nessus and tcpdump
(though both are on the Ubuntu Server CD). You shouldn't install anything
on any Internet server, or other multiuser system, that can be used
by an attacker against the system itself or other systems on your
network. Instead, you should run such tools from an administrative system,
where they're less likely to be abused.
</p><p>
Second, you would see that many packages on Ubuntu Desktop
must be downloaded from a main repository Web site. These are, in fact,
provided on the Ubuntu Server CD under /pool. These include the following:
</p><div class="itemizedlist"><ul type="disc"><li><p>
aide            
</p></li><li><p>
auth-client-config  
</p></li><li><p>
apparmor     
</p></li><li><p>
chkrootkit      
</p></li><li><p>
cryptsetup      
</p></li><li><p>
dovecot-imapd    
</p></li><li><p>
exim4-daemon-heavy   
</p></li><li><p>
gnupg    
</p></li><li><p>
ipsec-tools      
</p></li><li><p>
libkrb53        
</p></li><li><p>
sasl2-bin
</p></li><li><p>
libselinux1
</p></li><li><p>
libwrap0, tcpd
</p></li><li><p>
openssh-server
</p></li><li><p>
libpam-opie
</p></li><li><p>
shorewall
</p></li><li><p>
slapd, ldap-utils
</p></li><li><p>
squid
</p></li><li><p>
vlan
</p></li><li><p>
vsftpd
</p></li></ul></div><p>
I'll leave it to you to explore the many other security-related packages
available in the Ubuntu repositories. One of the best ways to do this
is to look them up on <a href="http://packages.ubuntu.com" target="_self">packages.ubuntu.com</a>.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x186e938"></a>
No Automatic Updates in Ubuntu Server</h2></div></div><p>
Given the importance of patching to maintain system security, you
might be surprised to learn that Ubuntu Server doesn't have any specific
mechanism for automatically downloading and installing security updates. I
can explain why in two words: change control.
</p><p>
On a production server that does real work, it's a bad idea to apply
any patches, even security updates, until after you've tested them on a
similar server in a lab to make sure they don't break anything. Sure,
you can run the commands <tt  >aptitude -y update</tt>,
<tt  >aptitude -y upgrade</tt>,
<tt  >aptitude -y dist-upgrade</tt> and <tt  >aptitude -y
autoclean</tt> from a cron job
each night. But that -y option, which allows aptitude to run unattended,
also might cause a package update to overwrite some custom configuration
file with a default configuration.
</p><p>
On a server, you're better off running these commands manually as needed,
without the -y option (after first doing so on a test system if you
run in a change-controlled environment). That way, you'll be prompted
before any configuration files are overwritten, and you'll be able to
observe firsthand the changes aptitude makes to your system as they
happen. Subscribe to the ubuntu-security-announce mailing list (via
<a href="http://www.ubuntu.com/support/community/mailinglists" target="_self">www.ubuntu.com/support/community/mailinglists</a>) to
receive e-mail
notifications of security patches as they're made available.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x186ed00"></a>
Novell AppArmor in Ubuntu</h2></div></div><p>
As I discussed last month, the Ubuntu port of Novell AppArmor is installed by
default in Ubuntu systems. This is true of both Server and Desktop. In
Ubuntu Server, however, AppArmor is present but not configured; you'll
need to activate any policies you want to enforce manually (AppArmor
profiles reside in /etc/apparmor.d).
</p><p>
If you're unfamiliar with AppArmor, it's a powerful means of running
applications in contained environments, such that applications' access
to local resources is kept to a minimum. It's similar to SELinux, but
less comprehensive and, therefore, easier to understand and administer.
</p><p>
However, on Ubuntu, no graphical tools are provided for this purpose,
even in Ubuntu Desktop. What's more, the only Ubuntu documentation
(besides man pages) is the AppArmor page on the Ubuntu User Community Wiki
(see Resources), which is little more than a listing of commands and their
command-line syntax; no HOWTOs or other introductory material are provided.
</p><p>
For the time being, it appears AppArmor on Ubuntu Server is for expert
users only.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x186ef10"></a>
Conclusion</h2></div></div><p>
I've discussed Ubuntu's sensible omission of the X Window System in its default
installations, enumerated security features in the Ubuntu Sever
installer, pondered the merits of the disabled root account, listed
some security-enhancing software packages available in Ubuntu Server
and considered Ubuntu's fledgling AppArmor support.
</p><p>
My overall opinion? Ubuntu Server 7.10 is a remarkably compact,
straightforward, command-line-oriented Linux distribution with a
reasonably secure set of default configurations and an impressive array
of fully supported, security-related software packages. (Fewer than
Debian, but many more than CentOS or RHEL.) If you're an intermediate-to-advanced Linux system administrator, depending on what you need to do,
Ubuntu Server may be worth checking out.
</p><p>
If you're a Linux newbie looking for a gentle introduction to
the Linux experience, Ubuntu Desktop is a much better choice, even if
you want practice setting up server applications.
</p><p>
That's it for now. Until next time, be safe!
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x137b580.0x186f120"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
The Official Ubuntu Home Page: <a href="http://www.ubuntu.com" target="_self">www.ubuntu.com</a>
</p><p>
Ubuntu Server Guide: <a href="https://help.ubuntu.com/7.10/server/C/index.html" target="_self">https://help.ubuntu.com/7.10/server/C/index.html</a>
</p><p>
Christer Edwards' blog, which consists almost entirely of handy Ubuntu
HOWTOs: <a href="http://ubuntu-tutorials.com" target="_self">ubuntu-tutorials.com</a>
</p><p>
&ldquo;Ubuntu Server: Considering Kernel Configuration&rdquo;
by Carla Schroder:
<a href="http://www.enterprisenetworkingplanet.com/netos/article.php/3710641" target="_self">www.enterprisenetworkingplanet.com/netos/article.php/3710641</a>
</p><p>
Home Page for Webmin, a Free Web-based GUI for Remote Server Management:
<a href="http://www.webmin.com" target="_self">www.webmin.com</a>
</p><p>
The Ubuntu RootSudo Page, Describing Ubuntu's sudo Implementation in
Detail:
<a href="https://help.ubuntu.com/community/RootSudo" target="_self">https://help.ubuntu.com/community/RootSudo</a>
</p><p>
Security Pages on the Ubuntu User Community's Wiki:
<a href="https://help.ubuntu.com/community/Security" target="_self">https://help.ubuntu.com/community/Security</a>
</p><p>
AppArmor Page on the Ubuntu User Community's Wiki:
<a href="https://help.ubuntu.com/community/AppArmor" target="_self">https://help.ubuntu.com/community/AppArmor</a>
</p><p>
The &ldquo;Securing Debian Manual&rdquo;, Indirectly Applicable to Ubuntu:
<a href="http://www.debian.org/doc/manuals/securing-debian-howto/index.en.html" target="_self">www.debian.org/doc/manuals/securing-debian-howto/index.en.html</a>
</p><p>
Bauer, Michael D. <span   class="emphasis"><em>Linux Server Security</em></span>, 2nd ed. Sebastopol, CA:
O'Reilly Media, 2005. Provides detailed procedures for securing popular
server applications.
</p></div></div></div>
<div class="authorblurb"><p>
Mick Bauer (<a href="mailto:darth.elmo@wiremonkeys.org">darth.elmo@wiremonkeys.org</a>) is Network
Security
Architect for one of the US's largest banks. He is the author of
the O'Reilly book <span   class="emphasis"><em>Linux Server Security</em></span>, 2nd edition
(formerly called
<span   class="emphasis"><em>Building Secure Servers With Linux</em></span>), an occasional
presenter at
information security conferences and composer of the &ldquo;Network
Engineering Polka&rdquo;.

</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../168/toc168.html">Issue Table of Contents</a>
    <a class="link3" href="../168/10012.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>