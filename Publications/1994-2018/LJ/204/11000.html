<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Drush: Drupal for People Who Hate Mice
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Read on for more about this command-line shell and scripting interface for&#10;Drupal.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0xe5a580.0xf51ac0"></a>
Drush: Drupal for People Who Hate Mice
</h1></div><div><div class="author"><h3 class="author">
James
 
Walker
</h3></div><div class="issuemoyr">Issue #204, April 2011</div></div><div><p>
Read on for more about this command-line shell and scripting interface for
Drupal.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xe5a580.0xf52358"></a></h2></div></div><p>
During its ten-year rise to prominence, Drupal dramatically has changed the
way people use it to build Web sites. Without needing to write a single line
of code, Drupal users are able to build complex, custom Web sites through
the point-and-click Web interface. The problem is I hate Web interfaces.
</p><p>
To be fair, the rise of keyboard shortcuts in modern Web applications has
made them far more comfortable for me, but I don't like mice (and don't
even get me started on trackpads). I am a keyboard kind of guy; hands on home
row make me happy.
</p><p>
Even for those of you proficient with your pointing devices, there 
still are times when you just can't beat the elegant power of the command
line.
As Linux users, you have all experienced the sheer joy of a simple shell
script to automate repetitive tasks (and if you haven't, why not?). There
is a long list of scenarios where using Drupal's Web interface is either
inefficient or inconvenient, but the truth is, for most Web developers and
sysadmins, the command line is a comfortable place.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xe5a580.0xf52618"></a>
Enter Drush</h2></div></div><p>
Drush (DRUpal SHell) is a command-line shell and scripting interface for Drupal, a
veritable Swiss Army knife designed to make life easier for those of us who
spend some of our working hours hacking away at the command prompt.
</p><p>
Drush began several years ago as a project to provide
a command-line interface to Drupal. Although somewhat limited in its early
utility, Drush has matured to become an essential tool for many Drupal
developers and administrators (myself included).
</p><p>
The current version, 4.1, brings a ton of great new built-in commands,
plenty of internal cleanup and better support for Drupal 7. Arguably more
exciting, however, is the growth of add-ons and extensions for Drush.
Although
not a traditional Drupal module, Drush is highly extensible via its own
API. A large number of existing Drupal modules now include Drush commands
in their official releases.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xe5a580.0xf52828"></a>
Getting Started</h2></div></div><p>
Initial versions of Drush required a working Drupal installation prior to
installing Drush. Since version 2, however, Drush has become Drupal-version-independent. You don't need a working Drupal site to install Drush.
In fact,
as you will see shortly, you can use Drush to install your Drupal
site fully.
</p><p>
Installing Drush on Debian/Ubuntu systems is as simple as running
<tt  >apt-get
install drush</tt>. However, the current stable Debian/Ubuntu versions include
packages for Drush 3. To get the latest and greatest, or if you're on a
system without a Drush package, you need to go through a few extra
steps:
</p><div class="orderedlist"><ol type="1"><li><p>
Make sure you have a working version of PHP CLI. This generally can be
accomplished by installing the php5-cli package on your system.
</p></li><li><p>
Download Drush from <a href="http://drupal.org/project/drush" target="_self">drupal.org/project/drush</a> (I am currently using
the &ldquo;All-versions-4.1&rdquo; release). Extract the downloaded package (.zip or
.tar.gz) and place it where you won't lose it. I typically place Drush in
~/local/drush on my development machines and /usr/local/drush on servers,
but the location is flexible.
</p></li><li><p>
Get the drush command into your $PATH. You can make this happen in several
ways. Drush includes a shell script (called drush) that tries
to determine the &ldquo;best&rdquo; PHP interpreter to use and runs the drush.php PHP
script. I typically symlink this script into a directory already in my
$PATH (<tt  >ln -s /usr/local/drush/drush
/usr/local/bin/drush</tt>).
Alternatively, you can add the path of your Drush install to your $PATH or
provide your own shell alias to the PHP script itself. See the included
README.txt file for full details.
</p></li></ol></div><p>
To test your new Drush install, you should be able to run <tt  >drush
status</tt> in
your terminal and see output something like this:

<pre     class="programlisting">
PHP configuration     :  /etc/php5/cli/php.ini 
Drush version         :  4.1                   
Drush configuration   :                        
Drush alias files     :
</pre>
</p><p>
If that worked, it's time to let the real fun begin!
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xe5a580.0xf52f08"></a>
Look, Ma! No Mouse!</h2></div></div><p>
Although Drush works without an existing Drupal installation, it is certainly
much more fun with one around. In fact, one of the most fun uses of Drush
is to install new Drupal sites. Normally, this process would include
something like: browse to <a href="http://drupal.org" target="_self">drupal.org</a>, click Get Started, then
click Download Drupal, then click to download the tar.gz file. Extract
that package into your Web server's document root. Create a database for
your new Drupal site. Browse to your new Drupal install (that is,
http://localhost/drupal) where you will be tossed into the installer. Begin
clicking your way through the installer (where you'll likely be asked to
<tt  >chmod</tt> your settings file), and after seven or more
screens, you'll have a
working Drupal install. Of course, chances are good that from here you'll
go on to download a handful of modules (again, browsing drupal.org and
extracting zip files) and clicking through the interface to turn them on
and configure them.
</p><p>
Phew, that's a lot of clicking!
</p><p>
Okay, it's not so bad when you are installing your first Drupal site, but
it takes a lot of time with your mouse, and if you install (or re-install)
Drupal sites a lot, it can become tedious. Let's look at that process with
Drush:
</p><div class="orderedlist"><ol type="1"><li><p>
Change into your Web server's root directory (<tt  >cd
/var/www</tt>).
</p></li><li><p>
Run <tt  >drush dl drupal-7.0</tt>. This downloads Drupal 7.0 from drupal.org and
extracts the files into /var/www/drupal-7.0.
</p></li><li><p>
Change into the newly created directory (<tt  >cd
/var/www/drupal-7.0</tt>) and run
the <tt  >site-install</tt> command:


<pre     class="programlisting">
drush site-install --db-url=mysql://root:secret@localhost/drupal
</pre>
</p></li></ol></div><p>
Answer &ldquo;y&rdquo; to the following prompt, and in a few short moments, you'll have
a working Drupal install (using the &ldquo;drupal&rdquo; database on localhost). To
verify, you can browse to http://localhost/drupal-7.0/ and log in using
admin/admin as the user name/password, respectively. The site-install command
has several additional options; run <tt  >drush help
site-install</tt> for full
details.
</p><p>
What if you need a handful of Drupal-contributed modules for your site (as
most people do)? Don't reach for your mouse yet! Let's grab
&ldquo;views&rdquo; and
&ldquo;devel&rdquo; while we're here (still in our Drupal directory):

<pre     class="programlisting">
drush dl ctools views devel
drush en views views_ui devel
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xe5a580.0xf538a8"></a></h2></div></div><p>
(Note that ctools is a required dependency for Views in Drupal 7.)
</p><p>
The Drush dl command (a shortcut for pm-download) is very clever about how
it downloads the modules and where it places the extracted folders. By
default, it grabs the .tar.gz file from drupal.org and places folders
inside the sites/all/modules directory, but you have full control
(including using CVS checkouts or where the folders belong). See
<tt  >drush help dl</tt> for
full details.
</p><p>
As with most tools, people develop their own habits with Drush, but here
are a few built-in commands you are likely to appreciate (at least in time):
</p><div class="itemizedlist"><ul type="disc"><li><p>
<tt  >drush cc</tt> (or cache-clear): Drupal developers learn
early on to &ldquo;clear the
cache&rdquo; while developing, because Drupal aggressively caches its more complex
internal data structures. Chances are good that if you're writing code, you
have a terminal window nearby, and running <tt  >drush cc
all</tt> will ensure that
when you check your latest work in the browser, you'll accurately see the
most recent changes.
</p></li><li><p>
<tt  >drush cron</tt>: the Drupal installation guide (INSTALL.txt) recommends running
Drupal's periodic maintenance tasks by adding a crontab entry that uses
wget to fetch http://example.com/cron.php periodically. In Drupal 7, this
now requires a generated &ldquo;cron_key&rdquo; parameter as part of the URL to inhibit
nefarious requests. Using Drush eliminates the need for the key and avoids
tying up a Web server process to do periodic maintenance.
</p></li><li><p>
<tt  >drush up</tt> (or pm-update): this command checks drupal.org for new
releases for all installed modules and offers to download all updates and
run the database upgrades for you. It even handles that pesky, easily
forgotten &ldquo;backup first&rdquo; step.
</p></li></ul></div><p>
Running <tt  >drush help</tt> in your Drupal directory always
will give you the list
of currently available commands (based on modules installed and so forth). For more
information on each command, run <tt  >drush help
&lt;command&gt;</tt>.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xe5a580.0x134c2e0"></a>
The Power of Aliases</h2></div></div><p>
You may have noticed that we ran our drush commands above from inside the
Drupal install directory. This allows Drush to determine which Drupal site
(and configuration options) to use. However, for those looking for a bit
more freedom and particularly those working within Drupal
&ldquo;multi-site&rdquo;
environments, you need to make use of the --root and --uri switches
for Drush. This can lead to a lot of repetitive typing. If you have only a
single Drupal site, you can specify these options (and lots more) by
creating a .drushrc.php file in your home directory. See the
example.drushrc.php file in the examples folder of your Drush installation
for more details.
</p><p>
For those of you who work on several Drupal sites across various versions and
installations, Drush provides an &ldquo;alias&rdquo; mechanism to define the common
parameters. To create an alias for this example site here, you can create a file
~/.drush/aliases.drushrc.php containing the following PHP code:

<pre     class="programlisting">
$aliases['example'] = array(
  'root' =&gt; '/var/www/example/drupal',
  'uri' =&gt; 'example.com',
);
</pre>
</p><p>
Now you can run drush commands for your example site from any directory
using <tt  >drush @example &lt;command&gt;</tt> (for example,
<tt  >drush @example status</tt>). To make things
even better, aliases can reference remote sites (accessible via SSH)
by including the remote-host and remote-user options. See the
example.aliases.drushrc.php file from the examples folder in your Drush
install directory for full details.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xe5a580.0x134c6a8"></a>
The Sky Is the Limit</h2></div></div><p>
With each new release, Drush includes more commands, and Drupal modules are
increasingly offering Drush commands with their releases. If that's not
enough (and you aren't afraid of writing some PHP), you can write your own
Drush commands. The examples folder in your Drush install includes a sample
command, <tt  >make-me-a-sandwich</tt> (XKCD fans rejoice!), for those interested in
learning more.
</p><p>
One of the greatest testaments to the power of Drush is the Aegir Hosting
Platform (see Resources), which provides a mass-hosting
environment (with support for multiserver installations). Although it
includes a Web interface, Aegir does all of its heavy lifting via custom
Drush commands.
</p><p>
If you work with Drupal and hate using your mouse (or prefer your
terminal), Drush can save you countless hours of clicking and open a whole
new world of scripted Drupal tasks.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xe5a580.0x134c8b8"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
Download Drush 4: <a href="http://drupal.org/project/drush" target="_self">drupal.org/project/drush</a>
</p><p>
Handy On-Line Reference (for those who still prefer Web pages):
<a href="http://drush.ws" target="_self">drush.ws</a>
</p><p>
Modules That Already Include Drush Support:
<a href="http://drupal.org/project/modules?filters=tid:4654" target="_self">drupal.org/project/modules?filters=tid:4654</a>
</p><p>
Drush Aliases:
<a href="http://developmentseed.org/blog/2010/mar/10/drush-30-more-powerful-flexible-and-magical" target="_self">developmentseed.org/blog/2010/mar/10/drush-30-more-powerful-flexible-and-magical</a>
</p><p>
For Shell Completion Junkies:
<a href="http://drupal.org/node/437568" target="_self">drupal.org/node/437568</a>
</p><p>
Aegir for Mass-Hosting Drupal: <a href="http://www.aegirproject.org" target="_self">www.aegirproject.org</a>
</p></div></div></div>
<div class="authorblurb"><p>
James Walker is a longtime Drupal developer, consultant, trainer and
advocate. He is a co-author of the O'Reilly book <span   class="emphasis"><em>Using
Drupal</em></span> and
often can be found speaking at Drupal conferences and events. Find him
on-line as &ldquo;walkah&rdquo; or via <a href="http://walkah.net" target="_self">walkah.net</a>.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../204/toc204.html">Issue Table of Contents</a>
    <a class="link3" href="../204/11000.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>