<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Detecting Chaos in the Field</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    All that is real is reasonable, and all that is reasonable is real.&#10;    &mdash;G.W.F. Hegel, 1770-1831&#10;    "><meta name="keywords" content="science, sound, audio"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x25ea580.0x26e1ab0"></a>Detecting Chaos in the Field</h1></div><div><div class="author"><h3 class="author">Juergen Kahrs</h3></div><div class="issuemoyr">Issue #75, July 2000</div></div><div><p>
    All that is real is reasonable, and all that is reasonable is real.
    &mdash;G.W.F. Hegel, 1770-1831
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x25ea580.0x26e24a8"></a></h2></div></div><p>Scientists and engineers were among the
first to notice what a powerful combination the Linux kernel and
the GNU tools are. Thus, it is no surprise that it was the sober
scientists who started replacing expensive
<span   class="emphasis"><em>supercomputers</em></span> with inexpensive networks of
GNU/Linux systems. In spite of the strong position of GNU/Linux in
all areas of scientific computing, there are still some aspects of
the Linux kernel which have been neglected by engineers. One of
them is the sound card interface.
</p><p>In the early days of Linux, sound cards were notoriously
unreliable in their ability to process data and continuous signals.
They were supposed to handle sounds in games, and nothing more; few
people tried to record data with them. Today, modern sound cards
allow for simultaneous measurement of signals and control of
processes in real time, and good sound cards can compete with
expensive <span   class="emphasis"><em>data acquisition cards</em></span> which cost
more than the surrounding PC. This article demonstrates how to
abuse a sound card for measurements in the field.</p><p>With appropriate software, an ordinary PC can do much more
than just record data in the field and analyse it off-line in the
office. Due to the extreme computing power of modern CPUs, it is
possible to analyse data while recording it in real time. On-line
analysis allows for interactive exploration of the environment in
the field, just like oscilloscopes of earlier days, but with an
added dimension.</p><p><a href="3914s2.html" target="_self">Sound Installation</a></p><p>First, you will need to install the sound card and its
drivers in your Linux system. As usual, the book that comes with
your Linux distribution should help a lot, and HOWTOs on the
Internet provide the necessary instructions (see sidebar &ldquo;Sound
Installation&rdquo;). When your sound card and its drivers are
installed, you should do some testing with it. Make a recording
while adjusting the mixer gain, and play the recording back through
your loudspeaker. The mixer is an important feature of your sound
card, because it allows you to adjust the sensitivity of the A/D
converter to the level of the signal to be recorded. This is even
more important when recording with a resolution of 8 bits. Keep in
mind that we are looking for fast and robust measures of
qualitative effects, rather than precise quantitative
measurements.</p><p><a href="3914s3.html" target="_self">Phase Space</a></p><p>If your GNU/Linux system does not already have some audio
applications installed, see Resources for a collection of addresses
on the Internet. There, you will find applications like
<span   class="bold"><b>smix</b></span>, a mixer with a well-designed
user interface. It can handle multiple sound cards, and has the
features needed for serious work:</p><div class="orderedlist"><ol type="1"><li><p>interactive graphical user interface</p></li><li><p>command-line interface</p></li><li><p>configuration file settings</p></li></ol></div><p>It makes no difference to your sound card whether the
recorded signal comes from an acoustic microphone or an industrial
sensor. Signals of any origin are always stored as sequences of
values, measured at fixed time intervals (i.e., equidistant in
time). Acoustic signals on a CD, for example, are sampled 44,100
times per second, resulting in one (stereo) value every 1/44100 =
22.7 microseconds.
</p><p>
<div       class="mediaobject"><a href="3914f1.large.jpg"><img src="3914f1.jpg"></a><div class="caption"><p>Figure 1. Phase Space Portrait of a
Pendulum</p></div></div>
</p><p>While musicians may be interested in filtering these signals
digitally (thereby distorting them), we are more interested in
finding and analysing properties of the measured, undistorted
signal. We are striving to find the rules of change governing the
sampled series of values. The major tool in Nonlinear Signal
Processing for finding the laws of motion is <span   class="emphasis"><em>delay
coordinate embedding</em></span>, which creates a so-called
<span   class="emphasis"><em>phase space portrait</em></span> from a single time series
(Figures 1 and 2). If you are not interested in technical details,
you may envisage it as a tool which turns a sequence of sampled
numbers into a spatial curve, with each direction in space
representing one independent variable. If you are interested in
technical details, you will find them in the <span   class="emphasis"><em>Phase
Space</em></span> sidebar. In any case, you should look at the list
of FAQs of the newsgroup sci.nonlinear (see Resources). These
explain the basic concepts and some misconceptions, and provide
sources for further reading.</p><p>
<div       class="mediaobject"><a href="3914f2.large.jpg"><img src="3914f2.jpg"></a><div class="caption"><p>Figure 2. Progress of the Pendulum in Phase
Space</p></div></div>
</p><p>Before delving into multi-dimensional space, let us look at
an example. Plug a microphone into your sound card's jack, whistle
into the microphone and use any of the many freely available sound
editors (see Resources) to record the whistling. The resulting
recording will look very much like the sine wave in Figure 3. It is
not surprising that your recorded wave form looks similar to the
wave form of the pendulum in Figure 3. The vibrating substances
(gas or solid) may be different, but the laws of motion are very
similar; thus, the same wave form.</p><p>
<div       class="mediaobject"><a href="3914f3.large.jpg"><img src="3914f3.jpg"></a><div class="caption"><p>Figure 3. Wave Form of Pendulum</p></div></div>
</p><p>You can download some software from the FTP server of
<i  >Linux Journal</i>, which records your whistling
and does the phase-space analysis for you (see Resources). Instead
of displaying the wave form, the software just extracts important
measures of the signal which help you refine your measurements
(Figure 4). Remember, it is not my objective to show you how to
present stunning, glossy pictures; rather, it is to demonstrate
what a valuable tool your Linux machine is when analysing
real-world signals in the field.</p><p>
<div       class="mediaobject"><a href="3914f4.large.jpg"><img src="3914f4.jpg"></a><div class="caption"><p>Figure 4. Finding a Good Embedding by Adjusting
Independent Parameters</p></div></div>
</p><p>Start the software by typing</p><pre     class="programlisting">
wish -f embed.tcl | dmm
</pre><p>A window will pop up that looks like Figure 4. In this
window, you can control the way the software measures the whistling
sound from your microphone. You can change the sample rate (click
on 44,100Hz) from left to right, the length of the analysed blocks
(click on 1 second) and the parameters <span   class="emphasis"><em>tau</em></span> and
<span   class="emphasis"><em>de</em></span>, which are needed for reconstruction of the
<span   class="emphasis"><em>phase space portrait</em></span> from just one measured
signal. This is comparable to the displacement of Figure 1; we have
no velocity measurement here.
</p><p><a href="3914s4.html" target="_self">Embedding</a></p><p>Each time we analyse an unknown signal, we have to start with
some educated guessing of the two parameters:</p><div class="itemizedlist"><ul type="disc"><li><p><span   class="emphasis"><em>tau</em></span> is the temporal distance,
or delay, between spatial coordinates</p></li><li><p><span   class="emphasis"><em>de</em></span> is the number of dimensions
of the reconstructed phase space</p></li></ul></div><p>These parameters are of crucial importance for a good
unfolding of the portrait of the signal in reconstructed phase
space (see the sidebar <span   class="emphasis"><em>Embedding</em></span>). In Figure
5, you can see how the choice of tau influences the portrait.
Values which are too small cannot unfold the portrait; values which
are too large are not shown, but often lead to meaningless (noisy,
uncorrelated) portraits. The software supports you in finding good
values for <span   class="emphasis"><em>tau</em></span> and <span   class="emphasis"><em>de</em></span>.
After years of intense research, scientists still rely on some
heuristics for choosing suitable values for these parameters.
</p><p>
<div       class="mediaobject"><a href="3914f5.large.jpg"><img src="3914f5.jpg"></a><div class="caption"><p>Figure 5. Differences in Unfolding, Depending on
Parameter </p></div></div>
</p><p>In the particular case of your whistling, the values in
Figure 4 should result in a good unfolding of the portrait. Do not
worry about the text lines which fill your terminal window. They
are needed for checking the quality of the unfolding. Restart the
software by typing</p><pre     class="programlisting">
wish -f embed.tcl | dmm | wish -f out.tcl
</pre><p>
<div       class="mediaobject"><a href="3914f6.large.jpg"><img src="3914f6.jpg"></a><div class="caption"><p>Figure 6. Parameters of a Sine Wave</p></div></div>
</p><p>and the text lines will be converted into the more readable
form of Figure 6. In the additional window popping up now, you will
see several columns. On the left (in grey), the independent
parameters of the first window are repeated. The second column from
the left tells you if the loudness of the measured signal is
well-adjusted to the sensitivity of your sound card's input. The
general rule is, as long as there are red lines in the second
column, you have to adjust sensitivity (with a separate mixer
software) or loudness. Now, turning to the third column, we see
more-advanced parameters:</p><div class="itemizedlist"><ul type="disc"><li><p><span   class="emphasis"><em>Spread</em></span> is the difference
between the largest and the smallest value, measured in AD
converter units. Small values indicate insufficient strength of the
signal.</p></li><li><p><span   class="emphasis"><em>Inf</em></span> is the average information
content of one sample, measured in bits. A constant baseline signal
yields 0 bits (minimum) and random noise has 8 bits (the maximum
with 8-bit samples).</p></li><li><p><span   class="emphasis"><em>MutInf</em></span> is the average mutual
information of one sample and the delayed one. Thus, it tells you
how <span   class="emphasis"><em>similar</em></span> the signals of both axes in Figure
5 are. A value of 1 means they are perfectly coupled (in the sense
of probabilistic dependency), 0 means completely
independent.</p></li><li><p><span   class="emphasis"><em>AutoCorr</em></span> (autocorrelation) is
another measure of similarity. Since the late 1980s, there has been
a (questionable) rule of thumb saying that a value near 0 indicates
a good unfolding of the reconstructed portrait. The maximum is
1.</p></li><li><p><span   class="emphasis"><em>PrErHy</em></span> measures predictability
and therefore determinism of the signal. The underlying algorithm
of prediction is the conventional linear predictive filter as used
in many adaptive filtering applications like modems. The minimum 0
indicates perfect (linear) predictability, while the maximum 1
indicates complete unpredictability by means of linear
filtering.</p></li></ul></div><p><a href="3914s5.html" target="_self">Determinism, Prediction and
Filtering</a>
</p><p>Again, the rule is, as long as there are red lines in the
third column, phase space is not reconstructed properly. Now,
turning to the last two columns, you will notice they look
identical. Indeed, they are. The difference is this: when
evaluating the parameters of the fourth column, the software uses a
reversed time axis. When reversing time, i.e., exchanging past and
future, prediction turns into postdiction and vice versa. Reversing
the time axis is a simple and effective way of checking the
validity of parameters which are especially susceptible to
measurement errors. In general, if reversal of time changes a
parameter, it is not trustworthy, which bring us to the next
parameter:</p><div class="itemizedlist"><ul type="disc"><li><p>If <b  >FNearN</b> (percentage of false
nearest neighbours) is reliable, the lines will turn green and be
the same in both columns (near 0). Otherwise, it will turn red and
indicate that the neighbourship relation of points in phase space
is not preserved when changing the parameter
<span   class="emphasis"><em>de</em></span>, indicating an insufficient
embedding.</p></li><li><p><b  >PrErLi</b> is the result of
re-calculating parameter <span   class="bold"><b>PrErHy</b></span>
over the whole data block. They should always be roughly the same.
If not, there must be a reason for it, and things get
interesting.</p></li><li><p><b  >PrErN</b> measures the
predictability with a nonlinear prediction algorithm. Signals
originating from a linear system are usually predicted more
precisely by <span   class="emphasis"><em>PrErLi</em></span> while signals from
nonlinear sources are often predicted better by nonlinear
prediction.</p></li><li><p><b  >MaxLyap</b> measures separation
(progressing over time) of points nearby in phase space. By
definition, values larger than 0 indicate chaos.</p></li></ul></div><p>When measuring signals from nonlinear systems,
<span   class="emphasis"><em>PrErLi</em></span> often turns red (indicating
insufficient linear predictability) while
<span   class="emphasis"><em>PrErN</em></span> stays green (indicating sufficient
nonlinear predictability). In case of a truly chaotic signal,
<span   class="emphasis"><em>MaxLyap</em></span> will turn green (valid) and have
opposite signs on the right-most columns. This indicates nearby
points are separating over time when time is going forward, and
they are approaching each other at the same rate when moving
backward in time.
</p><p><a href="3914s3.html" target="_self">Embedding</a></p><p>For the moment, the number of parameters and values may be
overwhelming. If you start by playing with the software and
actually analysing some signals in the field, you will soon become
acquainted with the parameters in their colours and columns. The
first time, you should look only at the two left-most columns in
Figure 6. All parameters there have intuitive meanings, and you
will soon be able to foretell how they change when applied to a
different signal, a clipped signal or an oversampled signal. Here
are some typical situations and how to recognize them:</p><div class="itemizedlist"><ul type="disc"><li><p>Sine wave: just as in Figure 6,
<span   class="emphasis"><em>de</em></span> (embedding dimension) should be 2 or 3.
<span   class="emphasis"><em>Mean</em></span> (i.e., average) and
<span   class="emphasis"><em>Median</em></span> (i.e., &ldquo;middlest&rdquo;) are the same.
<span   class="emphasis"><em>Modus</em></span> is jumping back and forth between
<span   class="emphasis"><em>Maximum</em></span> and <span   class="emphasis"><em>Minimum</em></span>. If
the <span   class="emphasis"><em>Spread</em></span> reaches its maximum (256),
<span   class="emphasis"><em>Inf</em></span> gets near 8 (bits).</p></li><li><p>Zero baseline (short-circuit or switched off) can
be recognized by looking at column 2. All values are identical. In
column 3, <span   class="emphasis"><em>Spread</em></span> and <span   class="emphasis"><em>Inf</em></span>
are almost 0.</p></li><li><p>Switching on a microphone, there is a short and
sharp impulse resulting in a sudden change of
<span   class="emphasis"><em>Spread</em></span>; few others change.</p></li><li><p>Sawtooth (Figure 7) looks much like the sine,
except for <span   class="emphasis"><em>Modus</em></span>, which jumps wildly.
<span   class="emphasis"><em>MutInf</em></span> is at its maximum, linear prediction
works only with higher-order filters, while nonlinear prediction
works better with low embedding dimensions.</p></li><li><p>Noise comes in many different flavours, all of them
having low values of <span   class="emphasis"><em>AutoCorr</em></span> and most with a
low <span   class="emphasis"><em>MutInf</em></span>.</p></li></ul></div><p>
<div       class="mediaobject"><a href="3914f7.large.jpg"><img src="3914f7.jpg"></a><div class="caption"><p>Figure 7. Parameters of a Sawtooth
Signal</p></div></div>
</p><p>Why not calculate some kind of <span   class="emphasis"><em>fractal
dimension</em></span> of a signal? By definition, calculation of
dimensions must look at the values over a wide range of scales.
With 8 bits of resolution, this is impossible or questionable. But
even if we had some <span   class="emphasis"><em>fractal dimension</em></span> value,
it would not be as useful as the largest Lyapunov exponent.
Furthermore, are all these measurements any good? Yes, there are
some areas of application:</p><div class="itemizedlist"><ul type="disc"><li><p><span   class="bold"><b>System
Identification</b></span>: in some applications, the focus of
attention is more on the quality of the signal (stochastic or
deterministic, linear or nonlinear, chaotic or not).</p></li><li><p><span   class="bold"><b>Prediction</b></span>: today,
linear prediction is one of the most important algorithms for
digital signal processors (DSPs) in telecommunication, be it mobile
telephony, modems or noise canceling. If there are systems with
nonlinear behaviour involved, nonlinear prediction can be
advantageous (see sidebar &ldquo;Determinism, Prediction &amp;
Filtering&rdquo;).</p></li><li><p><span   class="bold"><b>Control</b></span>: if you
know the structure of your system's phase space well enough, you
can try to control the system like this:</p></li></ul></div><div class="orderedlist"><ol type="1"><li><p>Identify periodic orbits in phase space.</p></li><li><p>Look for an orbit which meets the given
requirements (goes through a certain point, or has minimum energy
or cost).</p></li><li><p>Modify a suitable parameter or a variable just
slightly to stabilize the desired periodic orbit.</p></li><li><p>When Ott, Grebogi &amp; Yorke first published
successful application of this method (called the OGY method) in
1990, they even managed to control a system in the presence of
chaos.</p></li></ol></div><p><a href="3914s6.html" target="_self">Projects</a>
</p><p>In the late 1990s, several people analysed the time series of
the financial markets in order to find signs of nonlinearity or
chaos (for example, Blake LeBaron in Weigend &amp; Gershenfeld's
book, page 457). Some hoped to be able to predict time series of
stock values in this way. Kantz &amp; Schreiber took the idea one
step further, and contemplated the application of the OGY method to
control the stock market. But in a footnote on page 223 of their
book, they admit, &ldquo;We are not aware of any attempts to control the
stock market as yet, though.&rdquo; When I looked at the chart of Red
Hat stock in late 1999, I wondered whether someone had finally
managed to apply the OGY method to the time series of the Red Hat
share price.</p><p><a href="3914s1.html" target="_self">Resources</a></p></div></div>
<div class="authorblurb"><p>
       email: <a href="mailto:Juergen.Kahrs@t-online.de">Juergen.Kahrs@t-online.de</a>
       </p><p>
      <span   class="bold"><b>Juergen Kahrs</b></span>
      (Juergen.Kahrs@t-online.de) is a
      development engineer at STN Atlas Elektronik in Bremen, Germany.
      There, he uses Linux for generating sound in educational
      simulators. He likes old-fashioned tools like GNU AWK and Tcl/Tk.
      Juergen also did the initial work for integrating TCP/IP support
      into <span   class="bold"><b>gawk</b></span>.</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../075/toc075.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>