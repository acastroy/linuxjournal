<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Managing Multiple Cooks</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    Marcel offers an intranet recipe called Grand Salmar Station.&#10;    "><meta name="keywords" content="intranet, user, management, DBI, modules"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x1065580.0x115cab0"></a>Managing Multiple Cooks</h1></div><div><div class="author"><h3 class="author">Marcel Gagn&eacute;</h3></div><div class="issuemoyr">Issue #84, April 2001</div></div><div><p>
    Marcel offers an intranet recipe called Grand Salmar Station.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1065580.0x115d608"></a></h2></div></div><p> <span   class="emphasis"><em>Vien ici</em></span>,
Fran&ccedil;ois! Have a look at this. What do you mean, what is it?
It is our new intranet. What do you think of it? <span   class="emphasis"><em>Mon
Dieu</em></span>! You cannot tell me because you do not know what an
intranet is? I am certainly glad our guests have not yet arrived,
Fran&ccedil;ois. You know, working here at Chez Marcel, they
naturally assume that you are an expert about these things.
</p><p>An intranet, Fran&ccedil;ois, can be thought of as your own
private Internet, a networked environment where users can share
information, participate in discussions and use networking
technologies to make getting to that information as easy as
possible. It can be many things, really&mdash;a database providing
access to corporate documents, an information center for job
postings, a discussion board or a place to find the results of the
latest hockey pool, <span   class="emphasis"><em>non</em></span>? An intranet is a
place to share information. It can take many forms, but the essence
of an intranet is a high-tech bulletin board, one that lets you
post simple notices as well as entire multipage documents. Unlike
that corkboard in most company lunchrooms, a good web-based
intranet has virtually unlimited room.</p><p>Fran&ccedil;ois, why are you not looking at me when I talk to
you? Ah! <span   class="emphasis"><em>Mes amis</em></span>. Welcome to my restaurant.
Fran&ccedil;ois! To the cellar <span   class="emphasis"><em>pour du vin</em></span>.
<span   class="emphasis"><em>Vite</em></span>! Bring back the 1990 Vosne-Roman&eacute;e
Les Beaux Monts. Nothing like a good Burgundy to discuss networks,
<span   class="emphasis"><em>non</em></span>? <span   class="emphasis"><em>Merci</em></span>,
Fran&ccedil;ois.</p><p>Please sit, <span   class="emphasis"><em>mes amis</em></span>. Before you
arrived, I was showing Fran&ccedil;ois a special feature from this
very restaurant. Although we love to bring you delicacies from
around the world, sometimes it is our kitchens that do the
creating, <span   class="emphasis"><em>non</em></span>? Sally Tomasevic, master chef,
has written an intranet package we call Grand Salmar Station. What
is really wonderful about this package is that it is virtually
self-administering. A common problem with intranet solutions is
that they require a technical person to oversee the project. At the
very least, someone has to write HTML, maintain the structure and
deal with dated information. Unfortunately, sometimes that person
(and their dedication) can be hard to come by.</p><p>Ah, Fran&ccedil;ois, you have returned.
<span   class="emphasis"><em>Merci</em></span>. Please pour for our guests. What if I
told you, <span   class="emphasis"><em>mes amis</em></span>, that you could deploy an
intranet and turn it over to your users and let them maintain it
without having to train them? They would not need to know any HTML,
and they would not have to code a single line. Chef Sally has
created just such a package. It's even better. Grand Salmar Station
will automatically create and maintain all links for you and will
even expire old postings or dated information without you lifting a
finger. Any newly added item will magically appear on the
intranet's What's New page to highlight it. Normally, such adding
and deleting requires user intervention and links must be verified
and re-created. No problem with this intranet. It does it all for
you.</p><p>It is a bulletin board, a flexible news center, an internet
reference list, an office directory and a document management
system, all in one. Best of all, Grand Salmar Station is freely
distributed under the GPL.</p><div       class="mediaobject"><img src="4568f1.jpg"><div class="caption"><p>
Figure 1. Grand Salmar Station Front Page
</p></div></div><p>For this recipe, you will need the following ingredients: a
Linux System (but that goes without saying,
<span   class="emphasis"><em>non</em></span>?), an Apache web server, Perl, PostgreSQL
and the latest Grand Salmar Station source.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1065580.0x115df50"></a>La Pr&eacute;paration</h2></div></div><p>Grand Salmar Station is written completely in Perl and uses
PostgreSQL as its database. You may recall PostgreSQL from past
visits to the restaurant. Our menu has featured applications based
on this excellent database, so you may already be quite familiar
with it. It is possible that you even have it running as part of
your day-to-day processes. In case you do not, I will give you a
quick introduction. For the others, may I recommend a little brie
while you wait? You will find cooking instructions for the intranet
a little further on.</p><p>PostgreSQL is an advanced multiuser, relational database
management system (RDBMS) distributed freely along with its source
code. Originally written in 1985 and worked on by many developers
worldwide, PostgreSQL is fast, powerful, supports most (if not all)
SQL standards, and best of all, it is free. You probably don't even
have to go looking for PostgreSQL since it is usually packaged as
part of most major Linux distributions. Look on your distribution
CD it is probably already there. In fact, on some systems,
PostgreSQL is part of the default install making it that much
easier.</p><p>Here at Chez Marcel, we enjoy cooking with open source,
<span   class="emphasis"><em>non</em></span>? And we love working from source. So, for
this recipe, we will be building PostgreSQL from the freshest of
ingredients. The latest version is available by visiting the site
at
<a href="http://www.postgresql.org" target="_self">http://www.postgresql.org/</a>,
or as I mentioned mere moments ago, simply take it from your own
distribution CD.</p><p>After downloading the latest bundle, I extracted it to a
temporary location, changed directory to the source directory and
compiled. Here are the steps:</p><pre     class="programlisting">
tar -xzvf postgresql-7.0.3.tar.gz
cd postgresql-7.0.3/src
./configure
make
make install
</pre><p>The distribution directory (postgresql-7.0.3 in this case)
has a nice INSTALL file that you might want to take a moment to
read since there are some options related to the configure script
that you might find useful. For instance, by default, PostgreSQL
will install in the /usr/local/pgsql directory, and you may find
that location less than palatable. Tastes vary.
</p><p>When the compile is done, PostgreSQL will have to know how to
find its libraries. You can always modify your environment variable
to include /usr/local/pgsql/lib in the LD_LIBRARY_PATH, but it's
probably easier to add the path to the /etc/ld.so.conf file. This
is a text file that tells the system where to search for libraries.
Because it is straight text, just add the path to your libraries
and run this command as root:</p><pre     class="programlisting">
ldconfig
</pre><p>If you decided to install a PostgreSQL binary from your CD, a
postgres user will have been created as part of the installation.
Otherwise, create a postgres user with its home directory being the
PostgreSQL install directory. Then, assign a password to the user
and log in as postgres. If you built your database along with me,
you will be in the /usr/local/pgsql directory. Next step is to
create a data directory:
<pre     class="programlisting">
mkdir data
</pre>


To initialize the database for the first time, use the following
command:
<pre     class="programlisting">
$ bin/initdb -D /usr/local/pgsql/data
</pre>


That is, of course, the data directory that you just finished
creating, <span   class="emphasis"><em>n'est-ce pas</em></span>?
</p><p>You will see a number of messages going by as PostgreSQL
reports on what it is doing. Not quite enough time for a full meal,
but perhaps a single escargot and a sip from your wineglass,
<span   class="emphasis"><em>non</em></span>? Meanwhile, some default permissions will
be set. In addition, a default database will be created along with
PostgreSQL's own database (pg_database) for user and other database
information. Several views are then created after which you should
get a message like this:</p><pre     class="programlisting">
Success. You can now start the database server using:
/usr/bin/postmaster -D /var/lib/pgsql
    or
/usr/bin/pg_ctl -D /var/lib/pgsql start
</pre><p>Either will work, but the second is a better choice because
it launches the process into the background for you. You will also
want to add this to your startup for system boot.
</p><p>Now, it is time to create some users that will have access to
your database. If you are installing as root (for access to Perl
directories, CGI directories, etc.), then root will have to be
added, as will the user &ldquo;nobody&rdquo;. This is often the user that
your httpd server runs as. Some have a user called &ldquo;www&rdquo; to run
web services. I will use &ldquo;nobody&rdquo; as mine, and you may use
whatever your server is configured for. Start by logging in as your
postgres user, and execute the following commands to add users
&ldquo;root&rdquo; and &ldquo;nobody&rdquo; to your PostgreSQL system:</p><pre     class="programlisting">
$ createuser root
</pre><p>You'll be prompted for root's UID (accept the default) and
whether user root is allowed to create databases. Answer &ldquo;y&rdquo;.
When asked whether root is allowed to create users, I answered
&ldquo;y&rdquo; again. Now, do the same thing for user nobody. The only
difference is that I answer &ldquo;n&rdquo; to the question of whether nobody
is allowed to create databases as well. Depending on which version
of PostgreSQL you are using, the question of whether a user is
allowed to create other users may be worded this way:
<pre     class="programlisting">
Is user <b  >whoever</b> a superuser?
</pre>


The answer is still &ldquo;n&rdquo; or &ldquo;no&rdquo;.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1065580.0x115e7e8"></a>And Now, Your Perl Modules</h2></div></div><p>Now, onto the Perl side of things. In order to make
programming database access easier with Perl, the DBI modules were
developed. DBI stands for Database Interface and consists of a
collection of routines that offer standard hooks into an SQL
database. DBD is an application program interface (API) for Perl 5
to interface with database systems. The idea is to provide a
consistent set of modules and calls so that database access code is
portable without too much fuss.</p><p>Now, since there are a number of database formats out there
(PostgreSQL, MySQL, Sybase, Oracle, etc.), there will be some
variance in accessing and talking to those various databases. This
is where the DBD modules come into play. DBD are the Database
Dependent modules. They are identified by the database they support
by a simple suffix. For instance, DBD-Pg is the DBD module for
PostgreSQL. Meanwhile, DBD-Informix is the DBD module for the
Informix database.</p><p>Essentially, the DBI module is common to all the various
databases, but the DBD module must be (and is)
database-specific.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1065580.0x115e9a0"></a>Downloading and Installing the Modules</h2></div></div><p>Both the DBD and DBI module can be found at the CPAN FTP
site, a huge Perl resource on the Web. Because the two modules are
in slightly different directories, I will give you both starting
with the DBI module. See
<a href="ftp://ftp.cpan.org/CPAN/modules/by-module/DBI" target="_self">ftp://ftp.cpan.org/CPAN/modules/by-module/DBI/</a>.</p><p>The DBD module can be found at the CPAN site at
<a href="ftp://ftp.cpan.org/CPAN/modules/by-module/DBD" target="_self">ftp://ftp.cpan.org/CPAN/modules/by-module/DBD/</a>.
At the time of this writing, the latest and greatest DBI version
was DBI-1.14, whereas the DBD release number was DBD-Pg-0.95. It
probably makes sense to get the latest and greatest when it comes
to these modules, particularly if you are using the latest
PostgreSQL. The reason for this is that the modules grow and
develop with the databases they reference. The most recent
PostgreSQL database is best served by the most recent
DBD-Pg.</p><p>Install the DBI module first by unpacking the distributions
into some temporary directory and following these steps:</p><pre     class="programlisting">
cd /usr/local/temp_dir
tar -xzvf DBI-1.14.tar.gz
cd DBI-1.14
perl Makefile.PL
make
make test
make install
</pre><p>To install the DBD module, the process is similar. Please
note that more recent versions of the DBD module now require you to
set a couple of environment variables before the install can occur.
These are POSTGRES_LIB and POSTGRES_INCLUDE:
<pre     class="programlisting">
export POSTGRES_LIB=/usr/local/pgsql/lib
export POSTGRES_INCLUDE=/usr/local/pgsql/include
</pre>


Now, you can run the install:
<pre     class="programlisting">
cd /usr/local/temp_dir
tar -xzvf DBD-Pg-0.95.tar.gz
cd DBD-Pg-0.95
perl Makefile.PL
make
make test
make install
</pre>


</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1065580.0x11555f8"></a>Installing the Intranet Software</h2></div></div><p>Ah, <span   class="emphasis"><em>la pi&egrave;ce de
r&eacute;sistance</em></span>. Start by downloading the latest
release from the Salmar web site at
<a href="http://www.salmar.com/gss" target="_self">http://www.salmar.com/gss/</a>.
Then, extract it into a temporary directory. Once again, it comes
with a lovely little README file that you may want to indulge in.
For the impatient, this is all you do:</p><pre     class="programlisting">
tar -xzvf sciintra.tar.gz
cd installintra
</pre><p>Before we begin the actual install, we must pause and modify
one little configuration script. This is a small text file called
sciintra_conf.pl, and you can edit it with your favorite text
editor. Here is what you will find in the file.
</p><p><a href="4568l1.html" target="_self">Listing 1. Contents of
sciintra_conf.pl</a></p><p>The first thing to do is make sure that the path to your Perl
executable is correct. It will either be /usr/bin/perl or
/usr/local/bin/perl. Now, go down to the last three lines and fill
in the path to your Apache server's document root and cgi-bin
directory. What you see above is the file's default configuration.
If this fits your own system configuration, then you don't have to
change anything.</p><p>Now, it is time to finish our install:</p><pre     class="programlisting">
./install
</pre><p>Right away, the script does a couple of sanity checks,
specifically to make sure that you have PostgreSQL running and Perl
installed. Once satisfied, it will ask you an interesting little
question:
<pre     class="programlisting">
Do you also wish to install the phonebook (Y/N) ?
</pre>


A call for you, perhaps? Can you hear the music, <span   class="emphasis"><em>mes
amis</em></span>? Ah, memories. Think back to the June 2000 issue of
<i  >Linux Journal</i>. Chez Marcel's little kitchen
turned up an intranet telephone book for the &ldquo;Who's Who in
Linux?&rdquo; issue. Well, if you have our little phonebook installed,
then you can reply with an &ldquo;N&rdquo; for no, otherwise, why not install
this wonderful little phonebook? It will then be available from the
Grand Salmar Station Intranet menu, and it will be wonderful, like
this lovely little Syrah. <span   class="emphasis"><em>Pardonner moi</em></span> while
I have a little sip. Ah, wonderful.
</p><p>Next, you will be asked whether you wish to install the
intranet. Well, <span   class="emphasis"><em>mes amis</em></span>. That is why we are
here, <span   class="emphasis"><em>non</em></span>? Just respond with a &ldquo;Y&rdquo;. The
install then calls a Perl script to do the rest of the
installation. You are almost done, <span   class="emphasis"><em>mes amis</em></span>.
One more thing.</p><p>As I mentioned in the introduction, Grand Salmar Station can
automatically clean up after itself. If you decide to post a
date-sensitive item, the software can automatically remove this
item from the intranet after a specific date. To activate this
feature, add the following command to run with
<span   class="bold"><b>cron</b></span>:</p><pre     class="programlisting">
/usr/local/apache/cgi-bin/scimaint/dailyclean.pl
</pre><p>You may, if you wish, copy it to some other location. We will
discuss the security aspects of the administrator shortly.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1065580.0x1155e90"></a>Working with the Intranet</h2></div></div><p>There are two different faces to the intranet. What everyone
else sees and has access to and a few little items strictly for the
administrator's eyes. The administrator's menu is available via
your favorite browser at
http://yourmachine_name/scimaint/admin/.</p><p>From here, you can set various configuration parameters. The
first option allows you to create, modify or remove posting
categories. You'll see that as &ldquo;Update Categories&rdquo; on the menu.
The Posting Category Heading is what your users will see when they
look at the public face of the intranet. The default category is
&ldquo;News&rdquo;, but you can set it to documents. News items will show up
in the user menu under &ldquo;All the News&rdquo; while documents will show
up under &ldquo;All the Documents&rdquo;. Both will appear briefly in the
&ldquo;What's New&rdquo; menu, but you can decide to override that default at
this point.</p><p>You can also define who is allowed to post here. Your choice
is between allowing only administrators or making it a public
category and letting everyone have a go. Have a look at Figure 2
for a special category created by your chef.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1065580.0x1156048"></a>Figure 2. Creating Posting Categories</h2></div></div><p>Another choice you have at this point is whether to allow
internet links. Links can refer to sites anywhere else on the
Internet, internally, or for that matter, company documents
somewhere on your local network. You can then decide on posting
order: whether alphabetically or by date, ascending or descending.
Finally, you specify whether the system will take care of expiring
and removing these links automatically.</p><p>Grand Salmar Station offers many other options. For instance,
you can change the style of the intranet&mdash;in essence, the look and
feel of it. You will find six styles included with the distribution
with such exotic names as &ldquo;Beach Time&rdquo;, &ldquo;Copper Kettle&rdquo; and
&ldquo;Blue Skies&rdquo;. <span   class="emphasis"><em>Mais oui</em></span>, of course you can
create your own. Any style you choose can then be propagated across
your entire intranet.</p><p>The phonebook can also be administered from here (if you
chose to install it) as can other intranet defaults like expiration
dates. Explore. Enjoy. And, <span   class="emphasis"><em>bien sur</em></span>, be sure
to read the accompanying documentation, also available from the
Administrator's menu.</p><p>If you want to get a feel for what a user will see, use
http://yourmachine_name/scimaint/admin/demoreset.html to generate a
demonstration database along with some sample entries.
<span   class="emphasis"><em>Ah, oui</em></span>. The users&mdash;they have their own path
into the intranet: http://yourmachine_name/sciintranet/.</p><p>Have a look at Figure 3 for a peek at their &ldquo;What's New&rdquo;
screen.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1065580.0x11563b8"></a>Figure 3. What's New on the Intranet?</h2></div></div><p><span   class="emphasis"><em>Mon Dieu, mes amis</em></span>. It is late,
<span   class="emphasis"><em>non</em></span>? Fran&ccedil;ois, please, refill our
guests' wineglasses before they go! I hope, <span   class="emphasis"><em>mes
amis</em></span>, that you will enjoy working with our intranet.
Sally and I are quite proud of it, and we hope you will find it
useful as well. In the meantime, I must thank you for coming
tonight. Finish your wines, relax and make sure you join us next
time at <span   class="emphasis"><em>Chez Marcel</em></span>. Your table will always be
waiting.</p><p>A votre sant&eacute;! Bon app&eacute;tit!</p><p><a href="4568s1.html" target="_self">Resources</a></p></div></div>
<div class="authorblurb"><p>
        <div       class="mediaobject"><img src="4568aa.jpg"></div>

        <span   class="bold"><b>Marcel
      Gagn&eacute;</b></span> lives in Mississauga, Ontario. In real
      life, he is president of Salmar Consulting, Inc., a systems
      integration and network consulting firm. He is also a pilot, writes
      science fiction and fantasy and is coeditor of TransVersions, a
      science fiction, fantasy and horror anthology. He loves Linux and
      all flavors of UNIX and will even admit it in public. In fact, he
      is currently working on <span   class="emphasis"><em>Linux System Administration: A
      User's Guide</em></span>, coming soon from Addison-Wesley Longman.
      He can be reached via e-mail at mggagne@salmar.com. You can
      discover lots of other things from his web site at
      <a href="http://www.salmar.com/marcel" target="_self">http://www.salmar.com/marcel/</a>.</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../084/toc084.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>