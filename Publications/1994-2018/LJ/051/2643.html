<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Graphical Desktop Korn Shell</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    The Graphical Desktop Korn Shell (DtKsh) is a featured part&#10;    of the Common Desktop Environment (CDE). DtKsh provides a&#10;    consistent and reliable graphical Motif shell language that&#10;    is supported on all CDE-compliant systems.&#10;    "><meta name="keywords" content="desktop, graphics, shell"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x10f8580.0x11efab0"></a>Graphical Desktop Korn Shell</h1></div><div><div class="author"><h3 class="author">George Kraft IV</h3></div><div class="issuemoyr">Issue #51, July 1998</div></div><div><p>
    The Graphical Desktop Korn Shell (DtKsh) is a featured part
    of the Common Desktop Environment (CDE). DtKsh provides a
    consistent and reliable graphical Motif shell language that
    is supported on all CDE-compliant systems.
    </p></div></div><div       class="mediaobject"><img src="2643f3.jpg"></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x10f8580.0x11f05b0"></a></h2></div></div><p> Portability and pervasiveness are two
important characteristics to consider when you are developing code.
Using a programming language with a well-defined and stable
application programming interface (API) answers the need for
portability. A programming language with a large, established
installed base provides pervasiveness. Although Perl, Tcl/Tk,
Common Gateway Interface (CGI) and Java have large installed bases,
they are not suited for some projects. The reason for this is their
inconsistent installation base due to the lack of a well-defined or
rapidly changing API.
</p><p>The Desktop Korn Shell (DtKsh) that comes with the Common
Desktop Environment (CDE) is built on the
<span   class="bold"><b>ksh93</b></span> standard with X, Xt, Motif,
ToolTalk and CDE built-in APIs. Unlike Perl and Tcl/Tk, major
vendors have built and supported DtKsh through the CDE initiative.
Using DtKsh, desktop programmers can develop and/or prototype
plug-and-play Graphical User Interface (GUI) applications that are
compatible on all CDE-compliant systems without compilation.
Although DtKsh applications are interpreted for portability, they
can easily be migrated to Motif in C for performance.</p><p>Tcl/Tk can be ported to C with the aid of special Tcl/Tk
libraries; however, programmers are as disadvantaged with the C
Tcl/Tk libraries as they are with the Tcl/Tk shell, because of a
not-so-standard application programming interface. DtKsh, unlike
Tcl/Tk, provides a well-established API set where the programmer's
knowledge transcends from C to shell programming.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x10f8580.0x11f07c0"></a>DtKsh Benefits</h2></div></div><p>In AIX, /bin/ksh is an XPG4-compliant version of ksh88. CDE's
<span   class="emphasis"><em>/usr/dt/bin/dtksh</em></span> on AIX is based on the newer
ksh93 standard. ksh93 now includes floating-point mathematics,
associative arrays, new string operations, hierarchical variables,
reference variables, developer-extendable APIs using attached
shared libraries and character class patterns.</p><p><span   class="bold"><b>Floating-point mathematics</b></span>:
Korn Shell variables can be cast, or defined, to various aggregate
data types. Floating-point mathematics is a new feature in the Korn
Shell that enables the assignment and operation of decimal values.
The following example defines the floating-point variable
<b  >PI</b>, then assigns to it the decimal value of
3.14159.</p><pre     class="programlisting">
typeset -F PI # define "PI" as a float
PI = 3.14159
</pre><p><span   class="bold"><b>Associative arrays</b></span>: Instead
of using positive integer indices, associative arrays allow
elements of an array to be addressed using alphanumeric strings.
The following example shows <b  >SYSINFO</b> as an array
containing information about an operating system. The associative
<b  >SYSINFO</b> array can be indexed with the
alphanumeric string of <b  >"os"</b> to find the string
value of AIX.
<pre     class="programlisting">
typeset -A SYSINFO # define "SYSINFO" as an
# associative array
SYSINFO["os"]=AIX
</pre>


<span   class="bold"><b>New string operations</b></span>: Six new
string operations were introduced in ksh93. These new operations
provide substringing and substitution of a string pattern with an
alternate. Substringing permits extraction of a smaller string,
given an offset indicating where to begin and possibly its length.
<div class="itemizedlist"><ul type="disc"><li><p>A substring of a larger string can be extracted by
length at a given starting point, or a substring can be taken by
starting at the offset within the larger string and stopping at the
end of the string. The following shows a substring of a given
length:
<pre     class="programlisting">
${variable:offset:length}
</pre>

</p></li><li><p>A substring of no particular length can be taken by
just providing the offset.
<pre     class="programlisting">
${variable:offset}
</pre>


String substitution of a character pattern can be performed for the
first occurrence, a repeated occurrence, at the beginning of the
string (prefix) or at the end of the string (suffix).</p></li><li><p>Substitute the first occurrence of a pattern with
an alternate string:
<pre     class="programlisting">
${variable/pattern/string}
</pre>

</p></li><li><p>Substitute all occurrences of a pattern with an
alternate string:
<pre     class="programlisting">
${variable//pattern/string}
</pre>

</p></li><li><p>Substitute the pattern prefix with the alternate
string:
<pre     class="programlisting">
${variable/#pattern/string}
</pre>

</p></li><li><p>Substitute the pattern suffix with the alternate
string:
<pre     class="programlisting">
${variable/%pattern/string}
</pre>

</p></li></ul></div>

<span   class="bold"><b>Hierarchical variables</b></span>:
Hierarchical variables, or compound names, enable C structure-like
aggregate data types. This allows Korn Shell to store information
in variables in an associative fashion. For example, if we had a
box with a width of 80 and a height of 24, then we could store all
that information in one hierarchical variable instead of separate
and disjointed variables of storage. Each element of the compound
name must be used before setting sub-members.
<pre     class="programlisting">
BOX= # declare before assigning sub-members
BOX.WIDTH = 80
BOX.HEIGHT = 24
</pre>


<span   class="bold"><b>Reference variables</b></span>: Referencing
allows a variable to point to the same value as another variable;
both variables reference the same value as shown below:
<pre     class="programlisting">
# name reference
typeset -n FOO=BAR
FOO="Hello World"
# print "Hello World"
print ${BAR}
</pre>


<span   class="bold"><b>Desktop built-in commands</b></span>: Korn
Shell provides some standard X, Xt, Motif, POSIX
internationalization and CDE C language APIs directly built into
the shell. Direct access to these APIs from the shell provides a
significant runtime performance improvement for DtKsh shell
applications. Using the standard X and Motif APIs, with some
semantic changes to the source, makes it possible for DtKsh shell
scripts to be migrated to C and compiled.
</p><p><span   class="bold"><b>POSIX internationalization</b></span>:
Korn Shell provides the shell equivalent of the C language POSIX
internationalization APIs <span   class="bold"><b>catopen</b></span>
and <span   class="bold"><b>catgets</b></span>. The
internationalization APIs allow the shell program to change its
message catalog depending on its language. Internationalized shell
scripts enable multilingual support.</p><p><span   class="bold"><b>Character class patterns</b></span>:
Regular expressions in the shell are enhanced by predefining a set
of character class patterns. Now we can easily match certain
classes of characters by using the [[:<span   class="emphasis"><em>class</em></span>:]]
notation where <span   class="emphasis"><em>class</em></span> can be specified as alnu,
alpha, cntrl, digit, graph, lower, upper, print, punct, space and
xdigit.</p><pre     class="programlisting">
# only print files that
# begin in upper case
print  [[:upper:]]*
# old way
print [A-Z]*
</pre></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x10f8580.0x11f1840"></a>DtKsh &ldquo;Hello World&rdquo; Source</h2></div></div><p>The familiar &ldquo;Hello World&rdquo; Motif application, shown in
<a href="2643l1.html" target="_self">Listing 1</a>, is actually written in
DtKsh instead of C. Similar to C, we initialize the top-level shell
widget, then start building the GUI application. Listing 1 shows a
standard Motif message dialog using the familiar
XmCreateMessageDialog API. In DtKsh, handles to widgets can be
retrieved, widgets can be managed and unmanaged, and callbacks can
be created. Afterwards, the program enters into the Xt Intrinsic's
main loop via XtMainLoop where it processes X protocol events. In
this case, clicking on the OK button would be an event processed by
the event loop.</p><div       class="mediaobject"><img src="2643f1.jpg"><div class="caption"><p>
Figure 1. DtKsh and Motif &ldquo;Hello World&rdquo;
</p></div></div><p>The Motif &ldquo;Hello World&rdquo; DtKsh application in Listing 1 can
be easily ported to C with a few minor changes, shown in
<a href="2643l2.html" target="_self">Listing 2</a>. By adding some include
files, defining some variables, adding some commas and semi-colons,
and sprucing up some arguments, we have a C program. The result is
that DtKsh shell scripts make the same API calls as the C Motif
application.</p><p>AIX provides some extra DtKsh help through a GUI builder.
Developers can drag and drop widgets onto a canvas, then add logic
code to enable the application to do some work. Like any GUI
builder, the code is somewhat verbose; however, it is consistent
and portable. AIX is the only version of UNIX that offers this
feature.</p><div       class="mediaobject"><img src="2643f2.jpg"><div class="caption"><p>
Figure 2. AIX QtScript GUI Builder
</p></div></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x10f8580.0x15ea068"></a>User Extendable</h2></div></div><p>Developers can create their own new APIs for DtKsh by
creating glue-layer libraries. Glue-layer libraries enable DtKsh to
be extended with built-ins for functions such as system management
and networking. The performance advantage of using built-in
functions rather than calling to an external command is that
built-ins execute within the process of the shell script. Commands
that are called externally must create new resources in the
operating system and run as separate processes. DtKsh glue layer
libraries pass arguments between a normal UNIX C library and the
DtKsh shell, and they return a success or failure status. The
following list provides a few rules for creating a glue
layer:</p><div class="itemizedlist"><ul type="disc"><li><p>Name the function with a <b  >b_</b>
prefix.</p></li><li><p>Function returns a 0 integer for success, between 1
and 255 for failure.</p></li><li><p>Function should take <span   class="emphasis"><em>argc</em></span> and
<span   class="emphasis"><em>argv</em></span> as input.</p></li><li><p>Link your glue-layer libraries shared.</p></li></ul></div><p><a href="2643l3.html" target="_self">Listing 3</a> shows a DtKsh
shell script that dynamically loads the &ldquo;example&rdquo; shared
glue-layer library. Once the glue layer library is loaded and the
new built-in APIs are defined, the script can make direct calls
with arguments to the new built-in functions. In Listing 3, the
example built-in is called with the &ldquo;Hello World&rdquo; arguments.
</p><p>By providing in-line built-in functions, we can run scripts
much faster because we are not relying on outside programs running
as separate system erocesses. <a href="2643l4.html" target="_self">Listing
4</a> shows the C glue-layer for the example built-in shared
library. Following the rules outlined above, we prefix the example
function with a <b  >b_</b>, and we pass in an argument
vector and its size. After the function has done its work, we
return 0 for success and a positive integer for failure. DtKsh
built-in functions can also act as procedures that pass environment
variables in and out through its argument list. See
<span   class="emphasis"><em>Desktop KornShell Graphical Programming</em></span> by J.
Stephen Pendergrast, Jr. [Addison-Wesley, 1995] for more details on
how to pass and retrieve environment variables from built-in
procedures.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x10f8580.0x15ea7a0"></a>Conclusion</h2></div></div><p>The Desktop Graphical Korn Shell provides programmers with
the standard ksh93 baseline APIs with the addition of the X Window
System, Motif and the Common Desktop Environment. Shell programmers
can write portable shell scripts, prototype GUI shell scripts and
migrate GUI shell scripts to faster running C programs. DtKsh also
provides programmers with the ability to extend the shell language
with built-in shared libraries so that scripts can benefit from
feature-rich libraries, such as those for configuration
management.</p><p><a href="2643s1.html" target="_self">The Advantages of
DtKsh</a></p><p><a href="2643s2.html" target="_self">Acknowledgements</a></p></div></div>
<div class="authorblurb"><p>
        <div       class="mediaobject"><img src="2643aa.jpg"></div>

        George Kraft is an Advisory Software Engineer for
      IBM's Network Computer Division. He has previously worked on CDE
      V2.1 and V1.0 for IBM's RS/6000 Division and on X and Motif for
      Texas Instruments' Computer Systems Division. He has a BS in
      Computer Science and Mathematics from Purdue University. He can be
      reached via e-mail at gk4@austin.ibm.com.</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../051/toc051.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>