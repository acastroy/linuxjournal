<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
sc: the Venerable Spreadsheet Calculator
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;If you like vi, and you like the command line, you will&#10;love sc&mdash;a spreadsheet that runs in a terminal.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x1501580.0x15f8ac0"></a>
sc: the Venerable Spreadsheet Calculator
</h1></div><div><div class="author"><h3 class="author">
Serge
 
Hallyn
</h3></div><div class="issuemoyr">Issue #198, October 2010</div></div><div><p>
If you like vi, and you like the command line, you will
love sc&mdash;a spreadsheet that runs in a terminal.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1501580.0x15f9250"></a></h2></div></div><p>
Boy, there sure is a lot of software for Linux&mdash;a <span   class="emphasis"><em>lot</em></span> of
software! Why, if you want a browser, you can choose between Firefox, Opera, Chrome,
Galeon, Surf and many others. And, on the command line, wget,
curl, Lynx, ELinks and more are available. For e-mail, options include Evolution, KMail, Balsa,
and xmh; or on the command line, you can use mutt (my favorite), sup, pine, mh
and countless more. Calendaring choices include the GNOME calendar,
KDE calendar, xcal and Evolution; or, in a terminal, you can use the very
powerful Remind or ccal, not to mention command-line interfaces to
the Google calendar. And for spreadsheets, you've got OpenOffice.org's OOCalc,
Gnumeric, KSpread and Xspread; or, in a terminal, you've got perhaps the best
spreadsheet of all, sc, especially if you're a vi fan.
</p><p>
I've been using sc for years, mostly for
budgeting and project planning. The earliest version I've found was
posted to comp.sources.unix on August 18, 1987, by Robert Bond (see
Resources), but that was already version 4.1.
The post said it was previously known as vc, and that the original
version was written by James Gosling (of Java language fame) in September 1982.
Although documentation for sc can be hard to find, it does come with a decent
man page and a neat tutorial, which you can load right into sc. It also
uses the same file format as Xspread, so existing documentation on
formulas in Xspread (which is more plentiful than for sc) also can be
helpful.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1501580.0x15f94b8"></a>
Basic Usage</h2></div></div><p>
If you use Debian or Ubuntu, just type <tt  >sudo apt-get install
sc</tt>.
If your distribution doesn't have an sc package, see Resources for a link to the
source. Start the program by typing <tt  >sc</tt> in a terminal, and
you'll see a screen that looks something like Listing 1.
Because it's curses-based, you can run it over slow links, as well as inside
screen, so that you can detach and re-attach from another terminal.
There is a pretty detailed man page, which (in the Ubuntu package) points out
that you can start up sc with a tutorial by doing this:

<pre     class="programlisting">
sc /usr/share/doc/sc/tutorial.sc
</pre>
</p><p>
Actually, that isn't quite right. In Ubuntu, first you need to
uncompress the tutorial:

<pre     class="programlisting">
sudo gunzip /usr/share/doc/sc/tutorial.sc.gz
</pre>
</p><p>
Then start it.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1501580.0x15f97d0"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Listing 1. Starting Up sc</b></p><pre     class="programlisting">
sc 7.16:  Type '?' for help.

        A         B         C         D         E
  0
  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
</pre></div><p>
If you prefer to get started immediately with some real data, here are
some useful commands. Like vi, sc starts in a
command mode. The vi movement keys, hjkl, move left, down, up and right
among cells, as you would expect. To jump straight to cell D3, press
gD3. You can begin entering a numeric value or formula using =. To
interrupt a command gracefully, press Ctrl-G. See the Basic sc Usage in Command
Mode sidebar for more simple commands.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1501580.0x15f9a38"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Basic sc Usage in Command Mode</b></p><div class="itemizedlist"><ul type="disc"><li><p>
hjkl &mdash; vi keys motion (or cursor keys).
</p></li><li><p>
gB13 &mdash; go to cell B13.
</p></li><li><p>
ir, ic &mdash; insert row, insert column.
</p></li><li><p>
ma (mb, mc and so on) &mdash; &ldquo;mark&rdquo; cell as a (or b, or c and
so on).
</p></li><li><p>
ca (cb, cc and so on) &mdash; copy contents previously marked with ma.
</p></li><li><p>
Ctrl-f, Ctrl-b &mdash; page up or down (also pgup, pgdown).
</p></li><li><p>
dr, yr, pr &mdash; delete row, yank row, put row.
</p></li><li><p>
dc, yc, pc &mdash; delete column, yank, put column.
</p></li><li><p>
dd, yd, pd &mdash; delete, yank, put a cell.
</p></li><li><p>
= &mdash; enter a numeric value (25 or F13-D14) or formula (@sum(A2:A145)).
</p></li><li><p>
&lt; &mdash; insert left-justified text.
</p></li><li><p>
\ &mdash; insert centered text.
</p></li><li><p>
&gt; &mdash; insert right-justified text.
</p></li><li><p>
x &mdash; remove cell.
</p></li><li><p>
W&lt;filename.asc&gt; &mdash; write plain-text file.
</p></li><li><p>
P&lt;filename.sc&gt; &mdash; write an .sc file.
</p></li><li><p>
G&lt;filename.sc&gt; &mdash; read (&ldquo;get&rdquo;) an .sc file.
</p></li><li><p>
Zr, Zc &mdash; zap (hide) row or column.
</p></li><li><p>
sr, sc &mdash; show row or column.
</p></li><li><p>
@ &mdash; force re-calculation.
</p></li><li><p>
e &mdash; edit a numeric value.
</p></li><li><p>
E &mdash; edit a string value.
</p></li></ul></div></div><p>

To me, the three most important things about working with spreadsheets are
the ease of adding new data, moving data
and defining simple formulas that are re-calculated automatically.
sc
shines as far as the first two requirements with its vi-like command mode. It also does
quite well with formulas. Check the on-line help for a
sizable list of formulas, but the most common function in my 
experience is simple addition. This is no different in sc from any
other spreadsheet. 
</p><p>
To put the sum of the values in A3 through A10 into
A12, go to cell A12, and type <tt  >=@sum(A2:A10)</tt>. To edit the
formula, press
e for edit, and you will be in command mode in the top line, editing the
formula. Edit as you would in vi, and press Return to save the edited
formula. 
</p><p>
If you want to insert five more rows before row 5, go to cell A5,
and type <tt  >5ir</tt>, which means &ldquo;do 5 times: insert a row&rdquo;. The formula (now in A17)
will be updated automatically to read <tt  >@sum(A2:A15)</tt>. Now you can copy
that formula into cell B17 by going to A17, typing <tt  >ma</tt>, then going to B17
and typing <tt  >ca</tt>. The formula will be updated automatically to read
<tt  >@sum(B2:B15)</tt>.
</p><p>
If you want to highlight some specific data in the spreadsheet without
actually having to delete rows, you can hide the uninteresting ones.
This is called zapping in sc, and you do it by pressing Z followed by
either r for row or c for column. (If you follow it with a Z instead, 
sc will assume you meant save and exit as ZZ does in vi.) You can
un-hide by using S for show, followed again by r or c. Again, you
can type <tt  >30Zr</tt> to zap 30 rows.
</p><p>
I've already mentioned the tutorial and detailed man page, but sc also
has on-line help, which you can see by pressing ?. There, you will find
settings you can toggle, ways to move the cursor, lists of financial
functions and so on.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1501580.0x19f3338"></a>
File Saving and More</h2></div></div><p>
To save a file, press P followed by a filename, such as budget.sc. To save
a plain-text representation, press W followed by a filename, such as budget.asc.
I find these particularly useful, not only to paste into an e-mail quickly,
but also to look through a set of spreadsheets easily. 
</p><p>
You also
can output other formats. For instance, to output a LaTeX table to paste into
a paper, type <tt  >S</tt> (for set)
<tt  >tblstyle=latex</tt>, followed by <tt  >T</tt>
(for table output) <tt  >output.tex</tt>. The resulting LaTeX table,
of course, also lends itself to unending options for pretty-fication by adding
images, fonts, colors and whatnot. For me, plain text almost always is the most
useful.
</p><p>
To exchange data with other spreadsheet programs, sc exports
in a colon-delimited format. Unfortunately, this exports the results of
formulas and not the formulas themselves, but it still can be useful.
</p><p>
You can output colon-separated files in sc by typing
<tt  >S</tt> (for set) <tt  >tblstyle=0</tt>, followed by
<tt  >T</tt> (for table output) <tt  >output.cln</tt>. 
Actually, 0 is the default tblstyle, so you
need to do only the first step (S), if you selected
another format previously (like LaTeX).
</p><p>
To import this in OpenOffice.org's OOCalc, open OOCalc, go to the Insert menu,
and choose Select from file. Browse to your output.cln file
and select it. You'll get an import screen with a Separator
options section. For Separated by, choose Other, and type
in a colon. Make sure all other Separated by options are
deselected, or it won't work right.
</p><p>
Unfortunately, although sc can export other formats, it does not import
them. However, you can work around that. One way is to start by
getting CSV output. This should be an option for your on-line bank
statement, for instance. From OOCalc, choose Save as&rarr;Text CSV format, and click Edit filter setting. If the next
pop-up warns you about losing information in this format, click
keep current format. In the field options pop-up, unselect
Save cell contents as shown; otherwise, numeric values will
be placed in quotes. For field delimiter, let's use :, as that's
what sc outputs.
Let's assume that import.csv is the name of the resulting file.
</p><p>
There probably are several ways to import this
data into sc. For instance, sc offers advanced macros you
might be able to use. However, I think the simplest way is 
to convert the CSV file into a valid sc format file. This is 
easy, because the sc format itself is simple, plain-text&mdash;another reason for my
fondness of sc.

</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1501580.0x19f3968"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Listing 2. Python Script to Convert CSV Files to sc Format</b></p><pre     class="programlisting">

#!/usr/bin/python

import sys
import string

if len(sys.argv) &lt; 2:
    print "Usage: %s infile [outfile] [delimiter_char]" % sys.argv[0]
    sys.exit(1)

filename_in = sys.argv[1]

if len(sys.argv) &gt; 2:
    filename_out = sys.argv[2]
    outfile = open(filename_out, 'w')
else:
    outfile = sys.stdout

delimiter = ':'
if len(sys.argv) == 4:
    delimiter = sys.argv[3][0]
    print 'using delimiter %c' % delimiter

infile = open(filename_in, 'r')

letters = string.ascii_uppercase
text = ["# Produced by convert_csv_to_sc.py" ]
row=0
for line in infile.readlines():
    allp = line.rstrip().split(delimiter)
    if len(allp) &gt; 25:
        print "i'm too simple to handle more than 26 many columns"
        sys.exit(2)
    column = 0
    for p in allp:
        col = letters[column]
        if len(p) == 0:
                continue
        try:
            n = string.atol(p)
            text.append('let %c%d = %d' % (col, row, n))
        except:
            if p[0] == '"':
                text.append('label %c%d = %s' % (col, row, p))
            else:
                text.append('label %c%d = "%s"' % (col, row, p))
        column += 1
    row += 1

infile.close()
outfile.write("\n".join(text))
outfile.write("\n")
if outfile != sys.stdout:
    outfile.close()

</pre></div><p>
The Python script in Listing 2 simply walks over the CSV values
one by one, writing out sc commands to insert text and
numeric values. Note how easy it also would be to insert
formulas, if CSV supported them. Run this script by typing:

<pre     class="programlisting">
python c.py import.csv import.sc
</pre>
</p><p>
If your CSV file was separated by a character other than a colon,
for instance, a comma, add the delimiter as the last option:

<pre     class="programlisting">
python c.py import.csv import.sc ','
</pre>
</p><p>
Now, open the spreadsheet with:

<pre     class="programlisting">
sc import.sc
</pre>
</p><p>
<span   class="emphasis"><em>Voil&agrave;</em></span>, your on-line bank statement or simple OpenOffice.org spreadsheet
is now open in sc.
</p><p>
You can take this one step further and turn c.py into an automatic
plugin. Be warned, however, that this support isn't perfect.
To do so, place a copy into .sc/plugins/. Then, add
a line to $HOME/.scrc that reads:

<pre     class="programlisting">
plugin "cln" = "c.py"
</pre>
</p><p>
Now, any time you open a file in scn with a .cln extension using
G (for get), it will be filtered through c.py, and sc will
take its input from the plugin's standard output. Unfortunately, this
support apparently was rarely used and is not well implemented.
Specifying a .cln file on the command line (<tt  >sc r.cln</tt>) will not
invoke the plugin, so you must start sc with no files, and use the G
command to load the file. Also, if you 
save the file later, it will use r.cln as the default filename but save an sc
format file. So, if you use a plugin format, you'll need to specify a
corresponding plugout script (let's call it cout.py) as well, and add
a line to $HOME/.scrc that reads:

<pre     class="programlisting">
plugout "cln" = "cout.py"
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1501580.0x19f3ff0"></a>
Advanced Usage</h2></div></div><p>
sc has a few other neat features. For instance, it can
support automatic encryption of spreadsheet files. However, the
Ubuntu package is not compiled with that support, and when compiling a
version with it, it's clear that no one has tried it in some time, as it
required some patching. To support encryption, sc simply passes the
output files through /usr/bin/crypt, which asks for a
passphrase when you (P)ut the file. Therefore, I prefer 
using sc in a directory in an eCryptfs filesystem (and with
encrypted swap), so that all files I produce are encrypted.
</p><p>
sc also supports color cells. You can get pretty fancy and have
foreground and background colors calculated with any function
sc supports&mdash;meaning that cell value, row and column, time of day or
even external functions (see below) can determine the cell color.
Tell sc to begin using color by typing
<tt  >^T-C</tt> (Ctrl-T, for toggle, followed by C, for color). If you
save the sheet after this, the command &ldquo;set color&rdquo; will be saved, and
the sheet will be loaded with colors. There are eight color pairs, whose
foreground and background values you can define using C. For
instance, type <tt  >C</tt> followed by <tt  >color 1 =
@red;@black</tt>, which defines color 1
to be foreground red with background black. The default color
combinations are shown in the sc man page.
</p><p>
You can use these colors in a few simple ways. If you
type <tt  >^T-N</tt>, cells with negative values will have their
color value incremented by 1&mdash;for instance, if the cell would
have been color 3, it will be shown in color 4. If you
type <tt  >^T-E</tt>, cells with error values will be shown in color
3. To assign color 4 to the range A0:D5, type
<tt  >rC</tt> (range color) followed by <tt  >A0:D5
4</tt>. Finally, to see what
colors you have assigned to cells, type <tt  >rS</tt>.
</p><p>
A great number of functions are available in sc, but if
you find you need something more exotic, you can implement
them in C, Python or whatever your poison, and use them as
external functions. Type <tt  >^Te</tt> to enable external functions.
Then, write your function so as to take input from standard input
and send output to standard out. For instance, put the following
in a file called bci.sh:

<pre     class="programlisting">
#!/bin/sh
echo $* | bc -ql
</pre>
</p><p>
And, make it executable:

<pre     class="programlisting">
chmod ugo+x bci.sh
</pre>
</p><p>
Now in sc, enter values in A0 and B0, then set C0 to
<tt  >@ston(@ext("./bci.sh",A0+B0))</tt>. The @ston function will convert the
string returned by bci.sh to a number.
</p><p>
I've not run into this myself, but it is conceivable that with enough
external functions in a large enough spreadsheet, re-calculation could
start noticeably slowing things down. In that case, you can stop
automatic re-calculation by typing <tt  >^T-a</tt>. After that, the sheet will be
re-calculated only when you press @.
</p><p>
Similarly to external functions, sc also supports simple and
advanced macros. A simple macro is a text file containing regular
sc commands. You can run it by typing R, or ask for it to be
run automatically whenever you load a file by using A.
Advanced macros are executable files that communicate with sc over
a pipe. In this way, they actually can request information from sc.
You call an advanced macro by typing R and then preceding the
filename with |. The only decent documentation I've seen for this is the
SC.MACROS file included with the source code.
The following macro is a simple (and useless) example of an advanced macro.
Put the following in the file $HOME/.sc/macros/down.sh, and make it executable:

<pre     class="programlisting">
#!/bin/bash
echo down
</pre>
</p><p>
Start up sc, and type <tt  >R</tt> (run)
<tt  >|~/.sc/macros/down.sh</tt>. Note that
the | preceding the filename indicates that this is an advanced
macro. When you run this macro, the cursor will
move down a cell.
In other words, sc reads the &ldquo;down&rdquo; output by the echo command
and executes it as a command (see SC.MACROS for a list of commands you can use).
</p><p>
If you will be using a lot of macros, you might want to use the D
command to define a path under which sc should search for them.
You also could define a function key to run a frequently used macro.
For instance, add the following to your .scrc to cause F2
to call the down.sh macro:

<pre     class="programlisting">
fkey 2 = "merge \"|~/.sc/macros/down.sh\""
</pre>
</p><p>
Now, you never need to type j again!
</p><p>
There still are more features that, like the ones listed in
this section, I don't much use myself, but I could see them being
useful. You can toggle <tt  >^T-$</tt> to make all numeric values be
interpreted as cents. And, you can configure newline actions, so
that as you enter values, when you've entered the last column,
you automatically are moved to the first cell of the next row. For
me, these fall under the category of needing more thought to
figure out whether and how to use them than just using the default,
so I don't use them, although I keep meaning to try the last one.
The man page and help pages can point you
to more, and they're probably worth looking at to see which ones you
would find useful.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1501580.0x19f4c50"></a>
Conclusion</h2></div></div><p>
Linux users have many options for spreadsheets, not to mention Web-based ones, including Google Docs
spreadsheets. But, most people probably would be stumped if asked for a
spreadsheet that can be used in a terminal. sc is one of 
the oldest FOSS spreadsheets. It's been available for more than 20 years, and
it's
terminal-based, with keybindings that should be familiar to any vi user.
It supports advanced macros, plugins and external functions, and it can
export to its own format, plain text, LaTeX or CSV for easy input to
other spreadsheets.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1501580.0x19f4d58"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
comp.sources.unix Archives: <a href="http://groups.google.com/group/comp.sources.unix/about" target="_self">groups.google.com/group/comp.sources.unix/about</a>
</p><p>
sc Version 7.13 Source: <a href="http://ibiblio.org/pub/Linux/apps/financial/spreadsheet/sc-7.13.tar.gz" target="_self">ibiblio.org/pub/Linux/apps/financial/spreadsheet/sc-7.13.tar.gz</a>
</p></div></div></div>
<div class="authorblurb"><p>
Serge Hallyn is a Linux developer with Canonical. Over the years, he's
been involved with containers, SELinux and POSIX capabilities.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../198/toc198.html">Issue Table of Contents</a>
    <a class="link3" href="../198/10699.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>