<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Worms and Linux
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Some people believe that Linux as an operating system inherently is not vulnerable&#10;to viruses and worms; others believe that Linux is not vulnerable simply&#10;because of its limited use as a desktop. The debate remains open.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x1159580.0x1250ac0"></a>
Worms and Linux
</h1></div><div><div class="author"><h3 class="author">
Himanshu
 
Arora
</h3></div><div class="issuemoyr">Issue #230, June 2013</div></div><div><p>
Some people believe that Linux as an operating system inherently is not vulnerable
to viruses and worms; others believe that Linux is not vulnerable simply
because of its limited use as a desktop. The debate remains open.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1159580.0x12512a8"></a></h2></div></div><p>
Computer worms are considered to be one of the best weapons in a computer
attacker's arsenal. Through these computer worms, evil-doers intrude
into computer systems to destroy files, attack other computer systems, steal
data and so on. The concept of a computer worm is not new; attackers have been
using worms to attack computer systems for decades now. If you look back
at the history of computer worms, you'll see that the computer
worms that caused the most damage were directed toward the Microsoft Windows
OS. Is this because of the number of Windows vulnerabilities, or is it
merely due to the number of
Windows users? The question remains unanswered. Meanwhile, apart from
the Morris worm, very few worms have been directed toward Linux.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1159580.0x1251460"></a>
An Introduction to Computer Worms</h2></div></div><p>
A computer worm is a program that has malicious intent (that is, it can cause
damage to a computer system). It can replicate itself and propagate
over the network to infect other vulnerable computer systems. You 
also can think of a computer worm as a computer virus that requires no human
action to start and that has the capabilities to self-replicate and traverse over
the network.
</p><p>
A worm can arrive on a system through various means, such as an e-mail
attachment, a downloaded file from the Internet, a file over a TCP/UDP
connection from a trusted neighbor host or removable media like CDs,
pendrives and so on. Once it has arrived on a system, it has three tasks to
do:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Hide from any system-monitoring software, like antivirus software.
</p></li><li><p>
Start the actual damage for which is it is designed.
</p></li><li><p>
Send a copy of itself to other hosts on the network to infect them too.
</p></li></ul></div><p>
A worm that is able to do all these tasks effectively can be a real
threat to a host or a network. 
Developing an effective worm requires a
lot of system-/network-related knowledge, and this is the reason not
every computer worm is successful.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1159580.0x1251880"></a>
Design a Computer Worm&mdash;Wearing an Attacker's Hat</h2></div></div><p>
From an attacker's prospective, three things need
to be considered when designing a computer worm.
</p><p>
<span   class="bold"><b>1) Exploiting system vulnerabilities:</b></span>
</p><p>
The whole idea behind developing a worm is to cause maximum damage,
and this can be possible only if the worm exploits one or more system
vulnerabilities. Exploits are nothing but loopholes in the standard
utilities or in the OS kernel that worms can use to get the
required power or privileges to compromise a computer system.
</p><p>
If a worm does not exploit a system vulnerability, the only way
for a worm to compromise a system is to wait for the user to make some
mistake. But, this requires writing a lot of code; thus,
it is not considered a good design for developing a worm. Also,
this design strategy does not ensure that a worm always will be successful in
compromising and damaging the system.
</p><p>
On the other hand, if a worm exploits some vulnerability, such as a
&ldquo;zero-day&rdquo; vulnerability
(<a href="http://en.wikipedia.org/wiki/Zero-day_attack" target="_self">en.wikipedia.org/wiki/Zero-day_attack</a>), it becomes very easy
for a worm to compromise a system and cause maximum damage.
</p><p>
Note: some worms do not intend to cause any damage to
the infected host (see my next point for details).
</p><p>
<span   class="bold"><b>2) Stealth&mdash;the ability to remain
undetected:</b></span>
</p><p>
This also is one of the major aspects of worm design. Even a worm with
the deadliest intentions can't do much damage if a system administrator or
the monitoring software that runs on a host can detect it easily.
So, the ability to remain undetected on a system is yet another
important factor that worm authors consider. Countless
worms are developed each month, but only very few become
potential threats because of most worms' inferior stealth capability.
</p><p>
The best way for a worm to stay undetected is to piggyback itself onto a trusted process by compromising it. A trusted process is a process
running on a computer system that is deemed trustworthy by the system
itself, and hence, it faces minimal interference from firewalls and antivirus
software running on the system. A process can become trusted if it
follows the relevant standards that are set by the US Department of Defense.
</p><p>
Worms have other ways
of hiding on a system. For example, my article in the January 2012 issue of
<span   class="emphasis"><em>LJ</em></span> discusses
a small and not-so-destructive example of a piece of code that can
exploit ELF executables on a Linux system: 
<a href="http://www.linuxjournaldigital.com/linuxjournal/201201?pg=92#pg92" target="_self">www.linuxjournaldigital.com/linuxjournal/201201?pg=92#pg92</a>.
The design of this malicious
piece of code enables it to compromise the executables on a Linux system,
and each time a compromised executable is run, many other executables
are compromised. 
Here, the malicious code remains on the system until
all the affected executables are cleaned.
</p><p>
Some worms are designed to hide for a very long period of time on
an infected host. Such worms do not intend to cause any damage to the
host on which they reside. Rather, the sole purpose of these worms is to provide a
back door (to each host on which they reside) to the worm author, who then
controls the host remotely and activates the core of the worm at
any given point of time in the future to launch DDoS attacks to a particular
server. These types of attacks make it practically impossible to catch
the actual attackers (worm authors) and generally are used to
target government organizations and big corporations.
</p><p>
<span   class="bold"><b>3) Speed and method of propagation:</b></span>
</p><p>
Every worm has a lifetime of its own before it is nailed down. That's
the reason propagation speed is one of the top priorities for
worm authors. Propagation speed directly depends on the method
of propagation.
</p><p>
One propagation method worms use is via e-mail, where worms are transmitted
in the form of e-mail attachments. If you look at the
intricacies of this method, you'll find that propagation speed 
is not very high, because all the messages have to go
through e-mail servers. This adds an extra delay for a worm to reach
its destination.
</p><p>
Another worm propagation method is to establish TCP
connections directly. A TCP connection could be between an infected
and non-infected host, or it could be between a non-infected host
and a server where a fresh copy of a worm can be downloaded. Because
TCP is a connection-oriented protocol, the three-way-handshake
(<a href="http://en.wikipedia.org/wiki/Three_way_handshake#Connection_establishment" target="_self">en.wikipedia.org/wiki/Three_way_handshake#Connection_establishment</a>),
or
the concept of acknowledgement, can cause unnecessary delays and hamper
the worm's propagation speed. But, this propagation method is
still faster than propagation via e-mail.
</p><p>
The fastest of all the propagation methods is over UDP
connections. Because UDP is not connection-oriented and is not affected
by
network congestion, it offers speedier propagation for worms. The
only drawback of using UDP is that delivery to the destination is
not reliable, but that's not a real issue in the case of worms where more
than one copy of a worm is sent to a host.
</p><p>
You may wonder why e-mail still is used as a propagation method if it has
the slowest speed. E-mail provides
a way for worms to reach a lot of systems through contacts, while 
UDP makes sure that propagation is quick. So, 
there is no best way of impact using either e-mail or UDP. But, if
you consider a method where the worm is sent through e-mail over UDP, 
the worm can propagate to a large audience in no time.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1159580.0x1252278"></a>
Detect and Counter a Computer Worm&mdash;Wearing an Administrator's Hat</h2></div></div><p>
Here are some methods 
for detecting a worm:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Monitor trusted processes:
you all know that non-trusted processes are monitored actively by
programs like firewalls and antivirus software, and any deviation
from the allowed behavior causes those processes to be quarantined and
even interrupted. But, what about trusted processes? Although minimal, 
there are chances that a worm may attach itself to a trusted process. So,
what happens in that case? Well, trusted processes also can be
monitored to a certain extent. For example, each trusted process has
specific work to do. If it can be monitored for any deviation from its
work, worms attached to trusted processes also can be detected.
</p></li><li><p>
Monitor IP address scanning:
each process that tries to do some activity over the network tries
to connect to an IP address. Although legitimate processes know the IP
addresses (on which the connection needs to be established), worms try
to scan all the IP addresses that fall in the host's IP address space.
This means that worms would try to connect to all the IP addresses
in the IP address space of the host, and any good monitoring
software will detect these worms.
</p></li><li><p>
Install honey pots on the network:
a honey pot is a computer node on a network that is set up explicitly
as a trap for intruders and malicious programs like worms. Honey pots
let the intruder (or malicious program) do all the evil stuff while
recording all its activities. This way, an alarm can be raised to all the
nodes on a computer network, and the network administrator easily can block
such unwanted activity on other nodes.
</p></li></ul></div><p>
After detecting a worm, the first step should be to quarantine
the process and strip off its permissions to execute code on areas like
heap, stack and so on. If it continues to show the same suspicious
behavior,
affected processes also can be killed. Other than this, by keeping
your system updated (with all the latest patches to kernel and system
utilities), you can minimize the threat.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1159580.0x1252640"></a>
Linux Worms&mdash;Why Are There Only a Few Successful Ones?</h2></div></div><p>
Worms on Linux have had a limited success rate. 
As I mentioned at the beginning of this article, some people believe that
Linux as an operating system is inherently not vulnerable to worms, and
others believe that Linux hasn't been very vulnerable to worms simply
because of its limited use as a desktop.
The following are some points I'd like to add to this debate:
</p><div class="orderedlist"><ol type="1"><li><p>
Unlike Windows, most Linux users are not just end users;
they know what they are doing on their Linux boxes.
Linux users do not easily fall for traps like &ldquo;Hey, your system
has lots of viruses and trojans. Download AntiVirusFake.exe and get rid
of this malware.&rdquo; Also, most Linux users keep their OS updated
with the latest patches, which automatically keeps viruses, worms and so
forth at bay.
</p></li><li><p>
The wall of permissions is the other factor that makes Linux a
difficult place for viruses and worms. A normal Linux user account does not
have much privileges at its disposal, so a worm or virus cannot do much
except affect the files and executables that are limited to a single
account. Also, unlike Windows, you never are encouraged to log in as
administrator or root and play around all day clicking on files and
executables with root privileges. The Linux philosophy is that if you want to
do something that requires root privileges, acquire root privileges for
some amount of time, do the required work and then return to normal user mode.
</p></li><li><p>
Linux and even most of the software that is run on it is open source. A
large number of people constantly are working to improve and polish Linux and other
open-source software. This means that even if somebody is able to
develop a virus or worm by exploiting a vulnerability in the Linux kernel or
some popular piece of open-source software, it will take very little time for the
community to fix and patch it.
Bugs in the Linux kernel are fixed in no time.
</p></li><li><p>
Unlike Windows, Linux does not follow the &ldquo;brain-dead&rdquo; file extension
system. If a.out is an executable file on Linux, and if you try to run it,
it will not run just because it has a .OUT extension. The executable bit
has to be set on every executable in order to execute it. If you compare a
scenario where a Windows user receives an e-mail message with an attachment named
&ldquo;HotBritneyWallpaper.exe&rdquo;, just by clicking on the attachment, the
virus/worm is installed in the system. On the other hand, in Linux,
if an e-mail with a similar attachment is delivered, every user first has to
save the attachment, then give execution permissions to the file
in order for the file to execute. But, if the attachment boasts of just
being wallpaper, why would even a normal Linux user provide the file
with execution permissions? There you go&mdash;problem averted.
Linux provides another layer of protection that prevents accidental
execution of binary files.
</p></li><li><p>
Linux comes packaged in various distributions like Ubuntu, Red Hat,
Cent OS and so on, and each distribution has its own set of software utilities. For
example,
several e-mail
clients are used across various Linux distributions, such as
KMail, mutt, emacs, Mozilla Mail, Evolution, pine and so on. Now if
an attacker writes an exploit for one of those, it's not going to impact
all Linux users. So, unlike Microsoft, where an exploit for Outlook rings
alarm bells all over the world, because Linux has more variety, 
this adds another layer of protection.
</p></li></ol></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1159580.0x1252c18"></a>
A Case Study of Some Linux Worms</h2></div></div><p>
In this section, I focus on two popular Linux-specific worms.
Note: the Morris worm has been the most popular UNIX-based worm to date,
but I don't discuss it here, because so much has been said and written about
it already.
Read <a href="http://en.wikipedia.org/wiki/Morris_worm" target="_self">en.wikipedia.org/wiki/Morris_worm</a>
for more information on the Morris worm.
</p><p>
<span   class="bold"><b>The Linux Slapper Worm:</b></span>
</p><p>
The Linux Slapper is a worm that targeted Linux machines running an Apache
server. This worm was detected in October 2002. The Slapper worm exploits
the buffer overflow vulnerability of the OpenSSL software installed on
the server.
</p><p>
The worm starts by scanning the Internet randomly for hosts, and when it
gets one, it checks whether the host can be attacked. This is done by
sending an incorrect HTTP GET request to the target. If an Apache Web server is running
on the target, the reply from the server would provide enough
information for the worm to decide on the next step. After confirming that
an Apache
server is running on the host, the worm connects to port 443 (the SSL port)
and tries to launch a shell (/bin/ssh) by exploiting the buffer overflow
vulnerability of OpenSSL. This exploit specifically targeted Intel
x86 platforms. Once the shell is launched, the worm sends a shell script
containing an uuencoded copy of its own source code. Using the shell script,
the source code is written to a file named .bugtraq.c in the /tmp/ folder.
</p><p>
Once the /tmp/.bugtraq.c file is saved, the worm depends on the
availability of GCC on the host and Apache's permissions to execute the
GCC compiler. If these requirements are in place, it compiles the .bugtraq.c
file into an executable. This executable then is run with the IP address
of the attacking computer as a command-line argument. This way, the worm
propagates further by forming a peer-to-peer
network. It also opens up a specific UDP port to listen and accept
instructions to be carried out on/from the infected system.
</p><p>
The Linux Slapper worm had many variants. The A variant listens on UDP port
2002, while variants B and C listen on 1978 and 4156, respectively. The
B variant also acts like a virus and corrupts some other files by
overwriting them with itself. It also sends data to a yahoo.com
address. The C variant also listens to port 1052 periodically and
provides a shell to the attacker who is connecting to this port. Besides
these differences, all three variants used different names for the
files saved in the /tmp/ directory.
</p><p>
Detecting and removing this worm is not very difficult. All you need to
do is:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Log in as root.
</p></li><li><p>
Stop the Apache server.
</p></li><li><p>
Go to the /tmp/ directory.
</p></li><li><p>
Stop any process that is running with the same name as the worm executable
file present in the /tmp/ directory.
</p></li><li><p>
Remove the worm files (use <tt  >ls -la</tt> to list the
files).
</p></li></ul></div><p>
Note: there is another Linux worm called DevNull that worked pretty much
the same as the Slapper worm. DevNull also exploited the buffer overflow
vulnerability in OpenSSL. It is sometimes referred to as Slapper variant
D, but it's actually a different worm.
</p><p>
<span   class="bold"><b>The Linux Lion (L10n) Worm:</b></span>
</p><p>
The Linux L10n worm, also known as the Lion worm, was written by a Chinese
hacker named Lion. He created this worm to warn the Japanese education
department of controversial books being used in Japanese
schools. According to the worm author, these books proclaimed the war
crimes done by the Japanese against China and Korea as
&ldquo;legitimate&rdquo;.
</p><p>
The worm exploited a TSIG buffer overflow vulnerability in the BIND
(Berkeley Internet Name Domain) server software. BIND server software
is used to provide instructions to domain name servers (DNS) to convert
Web addresses into IP addresses. The Lion worm scans port 53 of the
class B network IP addresses, and if it finds a name server running on the
target, it launches its BIND exploit on the target. If the exploit
is successful, a copy of the worm is downloaded in form of a package.
This package then is extracted and the startup scripts are executed.
</p><p>
The infected machines send the root passwords to a Web site hosted in China
where the attackers tried to decrypt the password and gain administrative-level access to the infected systems. Reportedly, the worm also created
&ldquo;back doors&rdquo; for attackers to gain complete access to the infected system.
</p><p>
The Lion worm installed a rootkit in the infected systems in order to hide
itself from being detected. This made system administrators' jobs 
really difficult. The SANS (System Administration, Networking and
Security) institute created a program known as &ldquo;Lionfind&rdquo; for 
sysadmins to detect whether the Lion worm is present on a suspected
machine.
</p><p>
This worm installed the following files on a Linux system:
</p><div class="itemizedlist"><ul type="disc"><li><p>
/bin/in.telnetd
</p></li><li><p>
/bin/mjy
</p></li><li><p>
/bin/ps
</p></li><li><p>
/bin/netstat
</p></li><li><p>
/bin/ls
</p></li><li><p>
/etc/inetd.conf
</p></li><li><p>
/sbin/ifconfig
</p></li><li><p>
/usr/bin/find
</p></li><li><p>
/usr/sbin/nscd
</p></li><li><p>
/usr/sbin/in.fingerd
</p></li><li><p>
/usr/bin/top
</p></li><li><p>
/usr/bin/du
</p></li></ul></div><p>
And, to hide its footprints, the worm deleted these files:
</p><div class="itemizedlist"><ul type="disc"><li><p>
/.bash_history
</p></li><li><p>
/etc/hosts.deny
</p></li><li><p>
/root/.bash_history
</p></li><li><p>
/var/log/messages
</p></li><li><p>
/var/log/maillog
</p></li></ul></div><p>
Experts believe that this worm cannot be removed, and infected
systems have to be re-formatted in order to clean out the worm.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1159580.0x164c7d8"></a>
Antivirus, IDS and IPS Products for Linux</h2></div></div><p>
Linux is now the &ldquo;most-used OS&rdquo; on servers, and its popularity on
desktops is growing day by day. With this increasing acceptance, Linux
is gaining more attention from attackers and intruders. More and more
viruses, worms, trojans and so on are being made for Linux these days.
Although
the success rate of Linux malware is low at the moment, this is no
excuse for not protecting Linux-based systems, especially
if they are being used in sensitive and critical areas.
</p><p>
Many companies actively are working to provide quality antivirus programs for
Linux-based systems, such as Computer Associates,
Kaspersky, Trend Micro, Sophos, F-Secure
and Symantec.
</p><p>
Apart from antivirus software, some products are available that are
based on advanced technologies like intrusion detection systems
(IDSes) or intrusion prevention systems (IPSes).
</p><p>
An intrusion prevention system uses an intuitive
approach to detect and prevent system intrusion attempts directed at a
host. An IPS system scans the data flowing to and from a host, and based
on its detection system, it detects any suspicious activity taking place
on a host or on a network. Unlike firewalls, IPS systems also check the
outbound packets from the host.
</p><p>
The detection methods used are:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Signature method.
</p></li><li><p>
Profile method.
</p></li><li><p>
Stateful protocol method.
</p></li></ul></div><p>
Some free and open-source IPS products are Snort,
OSSEC and Suricata.
</p><p>
Read <a href="http://www.ibm.com/developerworks/library/se-intrusion" target="_self">www.ibm.com/developerworks/library/se-intrusion</a>
to learn more about this technology, how it works, what detection
techniques it uses and some free and open-source IPS products.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1159580.0x164ce08"></a>
Conclusion</h2></div></div><p>
Computer security, as you all know, is a process. It is not a product
you can purchase and then forget about.
Still, you can make good choices and follow best practices so that
your systems suffer the least. Today, Linux is the
best choice if you want to build a stable and secure host or network
environment. But, with the growing popularity of the Linux OS, attacks and
intrusions will increase, so be safe!
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1159580.0x164cf10"></a></h2></div></div><div class="sidebar"><p class="title"><b></b></p><p>Send comments or feedback via <a href="http://www.linuxjournal.com/contact" target="_self">www.linuxjournal.com/contact</a> or to
<a href="mailto:info@linuxjournal.com">info@linuxjournal.com</a>.
</p></div></div></div>
<div class="authorblurb"><p>
Himanshu Arora is a senior software engineer at
STMicroelectronics, India. Most of his experience is on Linux system
programming and network protocols, but his goal is to study Linux in its
entirety. In his free time, Himanshu writes articles on topics ranging
from Linux administration to Linux security. His articles have been
featured on IBM DeveloperWorks and in <span   class="emphasis"><em>Smashing
Magazine</em></span> and <span   class="emphasis"><em>Linux Journal</em></span>.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../230/toc230.html">Issue Table of Contents</a>
    <a class="link3" href="../230/11465.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>