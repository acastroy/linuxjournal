<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>What Has 1.1 Terabytes, 9,503 BogoMips and Flies?</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    What makes the ULB different from a hot PC with Linux on it?&#10;    We pick stable, well-supported hardware for a homebrew&#10;    system and end up with a terabyte of storage in an&#10;    unassuming beige box.&#10;    "><meta name="keywords" content="ultimate, Linux, box"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x1561580.0x1658ab0"></a>What Has 1.1 Terabytes, 9,503 BogoMips and Flies?</h1></div><div><div class="author"><h3 class="author">Don Marti</h3></div><div class="issuemoyr">Issue #101, September 2002</div></div><div><p>
    What makes the ULB different from a hot PC with Linux on it?
    We pick stable, well-supported hardware for a homebrew
    system and end up with a terabyte of storage in an
    unassuming beige box.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1561580.0x1659558"></a></h2></div></div><p>We've been doing &ldquo;building the Ultimate
Linux Box&rdquo; articles in <i  >LJ</i> since 1996. In that
time, we have seen Linux scale to IBM mainframes, 32-way ccNUMA
boxes and other exotic hardware. As much as we'd like to explain
how to build them, most of us aren't going to have the space, power
or budget for a 32-processor system that we can tear down whenever
we want to put in another sound card.
<div       class="mediaobject"><img src="6175f1.jpg"><div class="caption"><p>
A large tower case has plenty of space for working inside and keeps
cables out of the way. You can mount all drives on the upper level,
so plenty of air can get to the hot processors. This is before
installing drives and cards.
</p></div></div>

</p><p>So our Ultimate Linux Box is more of an ultimate Linux
workstation or an ultimate Linux small server&mdash;big enough to be
faster than you need for most uses and small enough to be practical
in an office or home environment.</p><p>The first question, of course, is whether to buy or build
your machine. On the one hand, you can do things for your
hand-built system that a mass-market PC manufacturer probably
won't:</p><div class="orderedlist"><ol type="1"><li><p>Pick the very best case for the exact hardware you
want to run, your work environment, your aesthetic sensibilities
and your desire to work inside easily.</p></li><li><p>Use a top-quality power supply and quiet,
ball-bearing fans.</p></li><li><p>For non-ultimate systems, you can put a really good
SCSI card, SCSI drives and Ethernet card on what is otherwise a
low-end desktop machine. This type of configuration will work well
for most Linux developer workstations and small server tasks, but
mass-market vendors won't usually build them because they don't
appeal to people who buy systems by comparing CPU clock speeds and
prices.</p></li><li><p>Leave off the parts that will end up gathering
dust: your keyboards and mice will last several generations of
hardware, and you probably already have a box with a CD
burner.</p></li></ol></div><p>On the other hand, there are two things that a mass-market PC
manufacturer can provide that you probably won't:
<div class="orderedlist"><ol type="1"><li><p>Professional thermal and acoustic engineering. Your
homebrew system will likely end up with more fans, a bigger case
and a bigger power supply than a mass-market system with similar
performance numbers. This doesn't necessarily have to translate
into more noise, if you're careful.</p></li><li><p>Relationships with hardware vendors who don't
respect you. One of the big differences between our box and the
Hewlett-Packard x4000 we reviewed in the <i  >LJ</i>
June 2002 issue is that we're using an ATI video card, and HP uses
NVIDIA.</p></li></ol></div>

A lot of NVIDIA-based cards are on the market right now, and many
users are reporting high performance with NVIDIA's proprietary
drivers. If you're Hewlett-Packard and have a close relationship
and nondisclosure agreements with NVIDIA, it's possible to make
this work. Customers can treat HP like any other UNIX workstation
maker&mdash;call HP and let them bug NVIDIA if the problem is NVIDIA's
fault.
</p><p>But if you're working with interesting new versions of core
software, such as the kernel and X, you might not find much help
from the traditional Linux channels for proprietary modules. At
USENIX this year, Linus Torvalds said, &ldquo;They may work, but you're
not getting the full advantage of Linux.&rdquo; The only case when you
could possibly accept a non-Linux kernel module is when you're not
doing any &ldquo;Linux-y&rdquo; stuff with the box&mdash;if you treat it like just
another PC and don't recompile the kernel or hack anything
whatsoever. Oh, and if you completely trust your hardware
vendor.</p><p>The intermediate route, which is ordering your system from a
low-volume or custom shop serving the Linux market, is worth
considering if you want to save shopping and building time, as well
as get good advice on Linux-friendly parts. Linux hardware vendors
are an informal, peer-to-peer reputation system for selecting good
parts, and this works surprisingly well. You can go to the web
sites of the good ones, see complete lists of every piece of
hardware that will go into your system and get a no-hassle warranty
on the complete box.</p><p>For this year's Ultimate Linux Box, we started with a base
configuration of the Glacier Dual Xeon workstation from Aspen
Systems Inc. in Colorado, and here's why. Think of the Ultimate
Linux Box as a Beowulf node, one with good graphics and sound and a
lot of reliable storage, in a tower case.</p><p>Companies that build Beowulf clusters are good places to look
for the fastest processors and motherboards and the most reliable
memory, because cluster users are picky about such things.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1561580.0x165a000"></a>Processors, Motherboard and Memory</h2></div></div><p>Unfortunately, our schedule for this article caught us in the
middle of Intel's much-awaited transition from RAMBUS to DDR
memory. We had to go to press before we could get our hands on a
dual Xeon motherboard with both DDR and AGP support, which should
be available soon. But if you're playing in Ultimate Linux Box
territory, dual Xeon is the way to go. So, we got the RAMBUS-based
SuperMicro P4DC6 recommended by Alan Taub at Aspen. Our box clocked
out at 9,503 BogoMips with a 2.4.18 kernel. Yow!</p><div       class="mediaobject"><img src="6175f2.jpg"><div class="caption"><p>
SCSI on the motherboard is cheaper than a separate SCSI card. Big
fans are good. CPU coolers are shiny.
</p></div></div><p>Since we're writing in the bad old days of RAMBUS for all you
happy future people in DDR-land, the best we can offer in the
motherboard department is a bunch of mindless platitudes. So do
yourself a favor and check the web sites of people who build Linux
boxes and then have to take the phone calls when customers have
problems with them.</p><p>Four features commonly found on some motherboards but not on
others are SCSI, Ethernet, sound and video. Don't rule out a
motherboard because it has something you won't use. Due to the size
of the Linux network server market, all the common Ethernet
chipsets you'll find on motherboards, such as the Intel
EtherExpress Pro100, are well supported. And if you're planning to
build a SCSI system, the price difference between a motherboard
with and without SCSI is generally less than the price of a SCSI
card.</p><p>None of the video or sound chipsets they put on motherboards
are Ultimate Linux Box-class, but if you're considering reusing the
motherboard for a server later, it doesn't hurt. If you're like
many office Linux users and rarely use sound, you might as well use
what comes with the motherboard.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1561580.0x165a3c8"></a>Graphics and Sound</h2></div></div><p>The trickiest part of building a Linux system is 3-D
graphics. We chose an ATI video card over an NVIDIA one this year.
See Frank LaMonica's Sidebar on some possible effects of this
choice. Monarch Computer Systems hooked us up with a Hercules 3-D
Prophet, which is a nice RADEON 8500-based card that will enable
you to start working with the cutting-edge, open-source clean 3-D
drivers when they come out.</p><p><a href="6175s1.html" target="_self">Which 3-D Card for
Linux?</a></p><p>The sound support front is a happier place. We used the ALSA
drivers, and with a properly set up ALSA-based system you shouldn't
need to disable the sound chipset on the motherboard to use a
high-end sound card. You can use both. We would run the
motherboard's audio in and out as a dedicated conference system to
chat with headquarters, while saving the Sound Blaster Live! for
playing Ogg Vorbis files on headphones. We still like the
now-inexpensive Sound Blaster Live! for the ubiquitous kernel
support, easy setup, good sound and, most important, the fact that
32 programs can have the audio device open at the same time.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1561580.0x165a5d8"></a>What's All This about a Terabyte?</h2></div></div><p>Until now, we've always recommended a safe, high-performance
but expensive choice for storage: two of the fastest-spinning SCSI
hard drives you can find. This is still a good conservative option.
However, when some people from 3ware showed up at a Silicon Valley
Linux Users Group meeting with an Escalade 7850 Storage Switch, we
decided to try it out.</p><p>So this is the first time we've had RAID 5 and a terabyte of
storage on a workstation, and it was surprisingly easy to get
working. We had to reboot from an MS-DOS disk to run the utility to
update the 7850's firmware, but the current version of the driver
is in the 2.4.18 kernel. Red Hat 7.3 and SuSE 8.0, the two
distributions we tried, recognized the array out of the box.</p><p>You'll be surprised to find the 3ware driver in
/usr/src/linux/drivers/scsi, not in drivers/ide. From the kernel's
point of view, the ATA RAID controller looks like a SCSI device.
You can't make a terabyte filesystem on pre-2.4.18 kernels, so be
sure you have 2.4.18 or later.</p><p>The web-based management utility, 3DM, that currently ships
with the hardware is proprietary, but 3ware assures us that some
time in July there will be a scriptable, command-line management
tool under the GPL. 3DM presents a clean, easy-to-use interface
that is simple to install. You also can rebuild an entire RAID
array from a web form.</p><p>If you want to use 3DM, you might need to reconfigure your
web browser. 3DM runs on port 1080, and Mozilla reported that,
&ldquo;Access to the port number given has been disabled for security
reasons.&rdquo; To override this, add the line:</p><pre     class="programlisting">
pref("network.security.ports.banned.override",
     "1080");
</pre><p>to Mozilla's all.js configuration file, which probably lives
in usr/lib/mozilla/defaults/pref/all.js.
</p><p>3ware claims to be able to do hot-swap if you have the
appropriate drive cage. However, we installed the drives normally
and didn't test this functionality. We did get excellent
performance numbers though. With eight Maxtor ATA drives, we got
173.1MB/s reads and 23.5MB/s writes to an ext3 filesystem on an
otherwise unloaded system. This was about the same read performance
as a single 10,000RPM SCSI drive, but almost six times as fast for
writes.</p><p>Driver author Adam Radford recommends two /proc tweaks to
speed things up, and we used them. Set /proc/sys/vm/max-readahead
to 256, and set /proc/sys/vm/min-readahead to 128.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1561580.0x165a9a0"></a>Case and Building Hints</h2></div></div><p>You don't want to make an Ultimate Linux Box your first
PC-building project because of the sheer cost of the parts. Salvage
one good box out of a desktop machine with a bad hard drive and a
server with a bad motherboard, or something like that. We assume
that you know the basics of static protection, reading the Fine
Manual for the hardware and not electrocuting yourself. If your
Linux box-building tool of choice is a web form, you can skip this
part.</p><p>Besides the basics, some tools you probably will want are a
hemostat for fetching dropped screws and moving jumpers, wire
cutters for removing cable ties, a nut driver set, a power
screwdriver cranked down to minimum torque and a label
maker.</p><p>Big tower cases are a win when you're putting together your
own box; you have the flexibility to put what you want where you
want. We still like the Lian-Li aluminum cases, one of which we
used last year.</p><p>Our least favorite color is Dumb PC Beige, no matter what you
call it. (&ldquo;Putty&rdquo; is a typical vendor name for this ugly color.
Cool, just what I'd like to have in my den, a big block of putty!)
Unfortunately, many of the cool-looking cases in other colors are
designed for gamers who run hot processors and video cards but only
one or two ATA drives. So it is with a heavy heart that we must
recommend the SuperMicro sc760 series, not only for its capacious
size but also for its excellent flexibility in drive and fan
placement.</p><p>SuperMicro cases are available with many convenient spots for
drives and fans, many of which you won't have to use. Different
models support motherboards with and without the special Xeon
mounting holes, so decide on your motherboard before selecting the
case. Working inside is easy: remove the locking front panel and
both sides open out like a book.</p><div       class="mediaobject"><img src="6175f3.jpg"><div class="caption"><p>
SuperMicro reduces cooling difficulties with vents on the side of
the case.
</p></div></div><p>Think of the case, or any well-designed full tower, as a
two-story building&mdash;the motherboard and expansion cards live on the
bottom floor, and the drives and power supply live upstairs. There
is one 12cm exhaust fan directly behind the processors on the first
floor, and you can place up to three intake fans at the front.
Upstairs, there is one exhaust fan above the power supply, and you
can mount up to four fans on the sides of the drives. We recommend
leaving off the drive carrier downstairs, if you can, and putting
your hard drives in the 5.25" bays with adapter brackets. This
gives you more usable intake space at the front of the bottom floor
and puts the drives where the side fans can blow on them.</p><p>All the ribbon cables from the 3ware card to the drives add
up to a surface area of about two and a half square feet. That much
cable, placed sloppily, would block a lot of airflow. We bundled
the cables together into a flat bunch with Velcro ties and looped
the extra length upstairs behind the drives instead of downstairs
around the motherboard. Because we have side fans, this is the
safest place for it.</p><p>It's always important to balance intake and exhaust fans. The
natural instinct is to &ldquo;blow out the hot air&rdquo;, but too many
exhaust fans will drop the pressure inside the case, canceling out
the efforts of the power supply fan and trapping hot air inside the
power supply. When the power supply goes, it generally takes
something more expensive with it. Because hot air rises, it's hard
to go wrong with low front intake fans and high rear exhaust
fans.</p><p>A nice touch you will probably want to add is thumbscrews in
place of the Philips screws for the case sides. The Lian-Li case is
already fitted with thumbscrews throughout because the aluminum is
very soft. Don't use a screwdriver, manual or power, on an aluminum
case.</p><p>All the surfaces of the SC760 are paintable, drillable and
are easily removable without unplugging a single wire. If you want
candy-apple red and a blowhole, you can easily take all the beige
stuff on a nice trip to the sheet metal shop and the spray booth
without moving drives or cards.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1561580.0x1651808"></a>Miscellany</h2></div></div><p>You'll notice that we didn't mention all the peripherals,
such as keyboards, mice and monitors. Monitors, keyboards and mice
are a matter of personal aesthetic judgment, and your ability to
pick one hands-on is probably going to be pretty good. How many
computers have your current favorite keyboard and mouse outlasted,
anyway?</p><p>What about CD burners, DVD drives and tape drives? Well, in a
recent reader survey, we saw that 95% of our readers have multiple
computers. We recommend that you set up one of your other machines
as a backup server or CD ripping/burning station.</p><p>That should be enough information to get you started on the
journey to custom Linux box building, so in the immortal words of
the SuSE installer, &ldquo;have a lot of fun&rdquo;.</p></div></div>
<div class="authorblurb"><p>
        <div       class="mediaobject"><img src="6175aa.jpg"></div>
       </p><p><span   class="bold"><b>Don
      Marti</b></span> is technical editor of <i  >Linux Journal</i>.</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../101/toc101.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>