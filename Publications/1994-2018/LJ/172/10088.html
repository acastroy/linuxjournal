<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Billix: a Sysadmin's Swiss Army Knife
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Turn that spare USB stick into a sysadmin's dream with Billix.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x25b6580.0x26adac0"></a>
Billix: a Sysadmin's Swiss Army Knife
</h1></div><div><div class="author"><h3 class="author">
Bill
 
Childers
</h3></div><div class="issuemoyr">Issue #172, August 2008</div></div><div><p>
Turn that spare USB stick into a sysadmin's dream with Billix.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x25b6580.0x26ae250"></a></h2></div></div><p>
Does anyone remember Linuxcare? Founded in 1998, Linuxcare was a
company that provided support services for Linux users in corporate
environments. I remember seeing Linuxcare at the first ever LinuxWorld
conference in San Jose, and the thing I took away from that LinuxWorld
was the Linuxcare Bootable Business Card (BBC). The BBC was a 50MB
cut-down Linux distribution that fit on a business-card-size compact
disc. I used that distribution to recover and repair quite a few machines,
until the advent of Knoppix. I always loved the portability of that little
CD though, and I missed it greatly until I stumbled across Damn Small Linux
(DSL) one day. 
</p><p>
After reading through the DSL Web site, I discovered that it
was possible to run DSL off of a bootable USB key, and that old love for
the Bootable Business Card was rekindled in a new way. It wasn't until
I had a conversation with fellow sysadmin Kyle Rankin about the PXE boot
environment he'd implemented, that I realized it might be possible to set up
a USB key to do more than merely boot a recovery environment. Before long,
I had added the CentOS and Ubuntu netinstalls to my little USB key. Not
long after that, I was mentioning this in my favorite IRC channel,
and one of the fellows in there suggested I put the code on SourceForge
and call it Billix. I'd had a couple beers by then and thought it
sounded like a great idea. In that instant, Billix was born.
</p><p>
Billix is an aggregation of many different tools that can be useful to
system administrators, all compressed down to fit within a 256MB bootable
USB thumbdrive. The 256MB size is not an arbitrary number; rather, it
was chosen because USB thumbdrives are very inexpensive at that size
(many companies now give them away as advertising gimmicks). This allows
me to have many Billix keys lying around, just waiting to be used. Because
the keys are cheap or free, I don't feel bad about leaving one in a server
for a day or two. If your USB drive is larger than 256MB, you still
can use it for its designed purpose&mdash;storing files. Billix doesn't hamper
normal use of the USB drive in any way. There also is an ISO distribution
of Billix if you want to burn a CD of it, but I feel it's not nearly as
convenient as having it on a USB key.
</p><p>
The current Billix distribution (0.21 at the time of this writing) includes the
following tools:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Damn Small Linux 4.2.5
</p></li><li><p>
Ubuntu 8.04 LTS netinstall
</p></li><li><p>
Ubuntu 7.10 netinstall
</p></li><li><p>
Ubuntu 6.06 LTS netinstall
</p></li><li><p>
Fedora 8 netinstall
</p></li><li><p>
CentOS 5.1 netinstall
</p></li><li><p>
CentOS 4.6 netinstall
</p></li><li><p>
Debian Etch netinstall
</p></li><li><p>
Debian Sarge netinstall
</p></li><li><p>
Memtest86 memory-checking utility
</p></li><li><p>
Ntpwd Windows password changing utility
</p></li><li><p>
DBAN disk wiper utility
</p></li></ul></div><p>
So, with one USB key, a system administrator can recover or repair a
machine, install one of eight different Linux distributions, test the
memory in a system, get into a Windows machine with a lost password
or wipe the disks of a machine before repurpose or disposal. In order
to install any of the netinstall-based Linux distributions, a working
Internet connection with DHCP is required, as the netinstall downloads the
installation bits for each distribution on the fly from Internet-based
mirrors.
</p><p>
Hopefully, you're excited to check out Billix. You simply can download
the ISO version and burn it to a CD to get started, but the full utility
of Billix really shines when you install it on a USB disk. Before you
install it on a USB disk, you need to meet the following prerequisites:
</p><div class="itemizedlist"><ul type="disc"><li><p>
256MB or greater USB drive with FAT- or FAT32-based filesystem.
</p></li><li><p>
Internet connection with DHCP (for netinstalls only, not required for
DSL, Windows password removal or disk wiping with DBAN).
</p></li><li><p>
install-mbr (part of the mbr package on Ubuntu or Debian, needed for
some USB drives).
</p></li><li><p>
syslinux (from the syslinux package on Ubuntu or Debian, required to
create the bootsector on the USB drive).
</p></li><li><p>
Your system must be capable of booting from USB devices (most have
this ability if they're made after 2005).
</p></li></ul></div><p>
To install the USB-based version of Billix, first check your drive.
If that drive has the U3 Windows software on it, you may want to remove
it to unlock all of the drive's capacity (see the Resources section for U3
removal utilities, which are typically Windows-based). Next, if your USB
drive has data on it, <span   class="emphasis"><em>back up the data</em></span>. I cannot stress this enough. You
will be making adjustments to the partition table of the USB drive,
so backing up any data that already is on the key is
<span   class="emphasis"><em>critical</em></span>. Download
the latest version of Billix from the Sourceforge.net project page to
your computer. Once the download is complete, untar the contents of the
tarball to the root directory of your USB drive.
</p><p>
Now that the contents of the tarball are on your USB drive, you need to
install a Master Boot Record (MBR) on the drive and set a bootsector on
the drive. The Master Boot Record needs to be set up on the USB drive
first. Issue a <tt  >install-mbr -p1 &lt;device&gt;</tt> (where
<tt  >&lt;device&gt;</tt>
is your USB drive, such as /dev/sdb). 
<span   class="emphasis"><em>Warning:</em></span> make sure
that you get the device of the USB drive correct, or you run the risk
of messing up the MBR on your system's boot device. The -p1 option
tells install-mbr to set the first partition as active (that's the one
that will contain the bootsector).
</p><p>
Next, the bootsector needs to be installed within the first
partition. Run <tt  >syslinux -s &lt;device/partition&gt;</tt> (where
<tt  >&lt;device/partition&gt;</tt> is the device and partition of the USB drive,
such as /dev/sdb1). <span   class="emphasis"><em>Warning:</em></span> much like installing the MBR,
installing the bootsector can be a dangerous operation if you run it
on the wrong device, so take care and double-check your command line before
pressing the Enter key.
</p><div       class="mediaobject"><a href="10088f1.large.jpg"><img src="10088f1.jpg"></a><div class="caption"><p>
Figure 1. The Billix Boot Menu
</p></div></div><p>
At this point, your USB drive can be unmounted safely, and you can
test it out by booting from the USB drive. Once your system successfully
boots from the USB drive, you should see a menu similar to the one shown
in Figure 1. Simply choose the number for what you want to boot, run or install,
and that distribution will spring into action. If you don't select a
number, Damn Small Linux will boot automatically after 30 seconds.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x25b6580.0x26af8a8"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Troubleshooting Billix</b></p><p>
A few things can go wrong when converting a USB key to run
Billix (or any USB-based distribution). The most common issue is for the
USB drive to fail to boot the system. This can be due to several things. Older
systems often split USB disk support into USB-Floppy emulation and
USB-HDD emulation. For Billix to work on these systems, USB-HDD needs
to be enabled. If your drive came with the U3 Windows-based software
vault, this typically needs to be disabled or removed prior to installing
Billix. 
</p><p>
If you're seeing &ldquo;MBR123&rdquo; or something similar in the
upper-left
corner, but the system is hanging, you have a misconfigured MBR. Try
<tt  >install-mbr</tt> again, and make sure to use the -p1 switch. You will need to
run syslinux again after running install-mbr. If all else fails, you 
probably need to wipe the USB drive and begin again. Back up the data on
the USB drive, then use fdisk to build a new partition table (make sure
to set it as FAT or FAT32). Use mkfs.vfat (with the -F 32 switch if it's
a FAT32 filesystem) to build a new blank filesystem, untar the tarball
again, and run install-mbr and syslinux on the newly defined filesystem.
</p></div><p>
Damn Small Linux is a miniature version of Knoppix (it actually has
much of the automatic hardware-detection routines of Knoppix in it). As
such, it makes an excellent rescue environment, or it can be used as a
quick &ldquo;trusted desktop&rdquo; in the event you need to
&ldquo;borrow&rdquo; a friend's
computer to do something. I have used DSL in the past to 
commandeer a system temporarily at a cybercaf&eacute;, so I could log in to work and fix a
sick server. I've even used DSL to boot and mount a corrupted Windows
filesystem, and I was able to save some of the data. DSL is fairly full-featured for its size, and it comes with two window managers (JWM or
Fluxbox). It can be configured to save its data back to the USB disk in
a persistent fashion, so you always can be sure you have your critical
files with you and that it's easily accessible.
</p><p>
All the Linux distribution installations have one thing in common:
they are all network-based installs. Although this is a good thing for
Billix, as they take up very little space (around 10MB for each distro),
it can be a bad thing during installation as the installation time will
vary with the speed of your Internet connection. There is one other
upside to a network-based installation. In many cases, there is no
need to update the newly installed operating system after installation,
because the OS bits that are downloaded are typically up to date. 
Note that when using the Red Hat-based installers (CentOS 4.6, CentOS 5.1
and Fedora 8), the system may appear to hang during the download
of a file called minstg2.img. The system probably isn't hanging; it's
just downloading that file, which is fairly large (around 40MB), so it
can take a while depending on the speed of the mirror and the speed of
your connection. Take care not to specify the USB disk accidentally at
the install target for the distribution you are attempting to install.
</p><p>
The memtest86 utility has been around for quite a few years, yet it's a
key tool for a sysadmin when faced with a flaky computer. It does
only one thing, but it does it very well: it tests the RAM of a system very
thoroughly. Simply boot off the USB drive, select memtest from the menu,
and press Enter, and memtest86 will load and begin
testing the RAM of the system immediately. At this point, you can remove the USB drive
from the computer. It's no longer needed as memtest86 is very small and
loads completely into memory on startup.
</p><p>
The ntpwd Windows password &ldquo;cracking&rdquo; tool can be a controversial tool,
but it is included in the Billix distribution because as a system
administrator, I've been asked countless times to get into Windows
systems (or accounts on Windows systems) where the password has been
lost or forgotten. The ntpwd utility can be a bit daunting, as the UI is
text-based and nearly nonexistent, but it does a good job of mounting
FAT32- or NTFS-based partitions, editing the SAM account database and
saving those changes. Be sure to read all the messages that ntpwd
displays, and take care to select the proper disk partition to edit. Also,
take the program's advice and nullify a password rather than trying to
change it from within the interface&mdash;zeroing the password works
much more reliably.
</p><p>
DBAN (otherwise known as Darik's Boot and Nuke) is a very good &ldquo;nuke it
from orbit&rdquo; hard disk wiper. It provides various levels of wipe, from a
basic &ldquo;overwrite the disk with zeros&rdquo; to a full DoD-certified, multipass
wipe. Like memtest86, DBAN is small and loads completely into memory, so
you can boot the utility, remove the USB drive, start a wipe and move
on to another system. I've used to this to wipe clean disks on systems
before handing them over to a recycler or before selling a system.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x25b6580.0x26a6818"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Expanding Billix</b></p><p>
It's relatively easy to expand Billix to support other Linux distributions,
such as Knoppix or the Ubuntu live CDs. Copy the contents of the Billix USB
tarball to a directory on your hard disk, and download the distro you
want. Copy the necessary kernel and initrd to the directory where you
put the contents of the USB tarball, taking care to rename any files
if there are files in that directory with the same name. Copy any
compressed filesystems that your new distro may use to the USB drive
(for example, Knoppix has the KNOPPIX directory, and Puppy Linux uses
PUP_XXX.SFS). Then, look at the boot configuration for that distro
(it should be in isolinux.cfg). Take the necessary lines out of that
file, and put them in the Billix syslinux.cfg file, changing filenames
as necessary. Optionally, you can add a menu item to the boot.msg
file. Finally, run <tt  >syslinux -s &lt;device&gt;</tt>, and reboot your system to
test out your newly expanded Billix. 
</p><p>
I have a 2GB USB drive that has a
&ldquo;Super-Billix&rdquo; installation that includes Knoppix and Ubuntu 8.04. An
added bonus of having the entire Ubuntu live CD in your pocket is that,
thanks to the speed of USB 2.0, you can install Ubuntu in less than
ten minutes, which would be really useful at an installfest. 
There is
good information on creating Ubuntu-bootable USB drives available at
the Pendrive Linux Web site. 
</p><p>
Alternatively, a really neat thing to do
(but way beyond the scope of this article) is to convert Billix into a
network-boot (via Pre-Execution Environment, or PXE) environment. I've
actually got a VMware virtual machine running Billix as a PXE boot server.
</p></div><p>
In closing, Billix may not make you coffee in the morning or eradicate
Windows from the face of the earth, but having a USB key in your pocket
that offers you the functionality to do all of those tasks quickly and
easily can make the life of a system administrator (or any Linux-oriented
person) much easier.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x25b6580.0x26a6be0"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
Billix Project Page: <a href="http://sourceforge.net/projects/billix" target="_self">sourceforge.net/projects/billix</a>
</p><p>
Damn Small Linux: <a href="http://www.damnsmalllinux.org" target="_self">www.damnsmalllinux.org</a>
</p><p>
DBAN Project Page: <a href="http://dban.sourceforge.net" target="_self">dban.sourceforge.net</a>
</p><p>
Knoppix: <a href="http://www.knoppix.net" target="_self">www.knoppix.net</a>
</p><p>
Pendrive Linux: <a href="http://www.pendrivelinux.com" target="_self">www.pendrivelinux.com</a>
</p><p>
Syslinux: <a href="http://syslinux.zytor.com/index.php" target="_self">syslinux.zytor.com/index.php</a>
</p><p>
Pxelinux: <a href="http://syslinux.zytor.com/pxe.php" target="_self">syslinux.zytor.com/pxe.php</a>
</p><p>
U3 Removal Software: <a href="http://www.u3.com/uninstall" target="_self">www.u3.com/uninstall</a>
</p></div></div></div>
<div class="authorblurb"><p>
Bill Childers is an IT Manager in Silicon Valley, where he lives with
his wife and two children. He enjoys Linux far too much, and probably
should get more sun from time to time. In his spare time, he does work
with the Gilroy Garlic Festival, but he does not smell like garlic.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../172/toc172.html">Issue Table of Contents</a>
    <a class="link3" href="../172/10088.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>