<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
The OASIS Standard for Office Documents: How All Users and Developers Can
Benefit</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;A common set of file formats has&#10;the potential to be the most meaningful advancement for&#10;free software on the desktop.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x2620580.0x2717ab0"></a>
The OASIS Standard for Office Documents: How All Users and Developers Can
Benefit</h1></div><div><div class="author"><h3 class="author">
Marco
 
Fioretti</h3></div><div class="issuemoyr">Issue #119, March 2004</div></div><div><p>
A common set of file formats has
the potential to be the most meaningful advancement for
free software on the desktop.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2620580.0x2718240"></a></h2></div></div><p>
Desktop integration begins with documents, not with any toolkit
or bundle of applications. If files can be read and written by
every application, users can communicate, work together
and become integrated. In this sense, the OASIS XML format for
office documents has the potential to be one of the most
meaningful advances in free computing.
</p><p>
OASIS stands for Organization for the Advancement of Structured
Information Standards. Formerly SGML Open, this nonprofit
consortium, which includes such companies as IBM, Sun and
Boeing, aims to create open standards for almost any kind
of structured information. The one we cover here
is an XML-based format common to all kinds of office files&mdash;text,
spreadsheets, presentations and more.
</p><p>
The significance of an effort of this caliber to promote a file
format, rather than any specific desktop, application
or the Linux kernel itself, cannot be underestimated. Free
as in free formats is even more important than free
software. Only with them and the internal structuring
that comes from XML can data be exchanged, with new or different programs without any
need for converters, or
be directly edited, indexed, analyzed and exchanged between
heterogeneous groups or servers&mdash;like Web services without the hype.
Data will start belonging exclusively to end users.
</p><div       class="mediaobject"><a href="7159f1.large.jpg"><img src="7159f1.jpg"></a><div class="caption"><p>
Figure 1. Switching to OASIS and never going back: OpenOffice.org can
convert all your closed-format documents to the new standard
with only a few clicks.
</p></div></div><p>
The OASIS Office Technical Committee had its first meeting in February
2003. The official file format should be voted on in February 2004. After
the approval, Phase 2 will start; its main goal will be to extend the
base specification to additional areas of application. The real goal is
the move to a document-centric model, independent from and available to
any given program, regardless of its license. The Technical Committee
is determined to quit with the assumption that every file spec must be
application-bound, as today.
</p><p>
Some farsighted public administrations already have started to think
in this way. The Swedish Agency for Public Management says, &ldquo;[We]
should also follow and if possible support work that takes place in
OASIS....An open file format for office software is of great
importance for increased interoperability&rdquo; (<a href="http://www.openoffice.org/servlets/ReadMsg?msgId=585772&amp;listName=discuss" target="_self">www.openoffice.org/servlets/ReadMsg?msgId=585772&amp;listName=discuss</a>). At the European Union level, IDA
(Interchange of Data between Administrations) decided in 2003 to carry
out exploratory work on open document formats and on how
public administrations could persuade software vendors to support
them.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2620580.0x2718710"></a>
What Does It Look Like?</h2></div></div><p>
The standard conforms to general W3C specifications for XML
technologies and covers every aspect of document usages. User
interaction, for example, is described in XML schema templates, which
operate like traditional API functions. Even they, however,
now are independent of any single application.
</p><p>
A text format can be much bigger and more inefficient than an equally free
but binary one. Even when the performance hit would be
noticeable, however, the benefits simply are too great to give up. In
itself, an OASIS office file (be it text, presentation or spreadsheet)
is a zip archive: the compression format chosen is a compromise
of efficiency, speed of accessing internal parts and algorithm
license. Unzipping it, we first find five XML files: styles.xml,
presentation and formatting; contents.xml, actual contents; settings.xml,
application settings such as zoom level and printer; meta.xml, language and
uncoding metadata; and manifest.xml, an explanation of
what all the other
files are and their relative paths.
</p><p>
Other components (each in a predefined folder, so that even virus
scanners have an easier time) may be macros, their dialogs and
objects, such as charts or formulas.
</p><p>
Because the standard imposes that all pieces must be present in the
zip archive, no information is lost: content, layout and everything
else always travel together. Unlike some proprietary offerings
in the same space, there is no restriction on which application must
be employed to make full use of a document. WYSIWYG results are
possible and can be specified fully or replaced in the styles.xml
file. At the same time, however, content and presentation are
decoupled; hence, content and nothing else is attainable
by any application, for any conceivable use.
kfile-plugin-ooo, for example, extracts all the metadata embedded
in the new file format. The end user then can read, search by metadata
or modify all this information straight from KOffice or Konqueror.
This plugin also is included in the latest KOffice source trees.
</p><p>
Text format and internal structure make decades of UNIX
experience in processing and generating text come back with a
vengeance to tame complex, WYSIWYG office documents of every kind. Shell
one-liners, Web spiders and so on can query and process directly,
much like a database engine, single documents or whole classes of
them. Viewing attached presentations as text in mutt or industry-level content management systems becomes easier. As a proof of
concept, I was able to get the (admittedly rough) outline of Listing 1
from a presentation simply by typing:

<pre     class="programlisting">

# tr "&lt;" "\012" &lt; content.xml | grep ^text \
| cut '-d&gt;' -f2, | uniq

</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2620580.0x2718a28"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Listing 1. Extracting the Text of an OASIS Presentation at the Command Line</b></p><pre     class="programlisting">
Problems with
a lot of the bang up to date mainstream Free SW

Requires modern HW:

plenty of RAM

fast CPUs

big Hard disk drives

Unlike SW, modern HW cannot be "free as free beer"

Doesn't this sound familiar?
</pre></div><p>
Encryption obviously is supported, and any paragraph can have an
identity attribute. Through this feature, different users can be granted
access to different parts of the same document based on their
privileges. The default text encoding is UTF-8, even if other ones can
be chosen. Suggestions to improve the standard can be posted to
<a href="mailto:office-comments@lists.oasis-open.org">office-comments@lists.oasis-open.org</a>.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2620580.0x2718ce8"></a>
What about End Users?</h2></div></div><p>
This design and implementations are all well and good, but users need some application
to use it. What is available?
Absolutely complete compatibility is possible only with software designed
from scratch or with software that has been modified thoroughly to achieve it. In general,
existing programs and their developers may have to compromise between
the standard and their current concept of the perfect
structure of
the perfect document. For example, margins are a section or page
property in some applications and a paragraph property in others.
</p><p>
This said, the users of OpenOffice.org will have the easiest time;
the OASIS standard is built on and almost will be equal to the
current OOo formats. AbiWord has both import and less-advanced
export filters, but they are not 100% complete. Contributions to improve
them are extremely welcome. This program also offers end users
the option to use OOo as the default file format. The plan for
KOffice, after improving the filters for version 1.3, is to start
the switch to OASIS as the native format of future releases. David
Faure, one of the chief KOffice developers, also is a member of the
Technical Committee, and he foresees no real obstacles to a complete
support of the standard, in spite of the frame-oriented rather than
page-oriented paradigm used in KOffice.
</p><div       class="mediaobject"><a href="7159f2.large.jpg"><img src="7159f2.jpg"></a><div class="caption"><p>
Figure 2. KOffice is ready to switch to OASIS fully. The internal
structure already is stored in XML format, including metadata, and is
searchable with external plugins.
</p></div></div><p>
SIAG offers some support for reading text and spreadsheet files
through external applications, but nothing is available for writing. Emacs
surely will come
up with its own OASIS mode sooner or later, and WordPerfect also is
officially represented in the Technical Committee. In short, things
look good. Choice already is offered, and the only things left are
to set OASIS as the default save format and to refuse to receive or send
files in proprietary formats.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2620580.0x2719058"></a>
Developer Tools</h2></div></div><p>
A lot of code already is available to study and reuse for processing the
OASIS file format. Whatever you choose, don't forget the standard
itself and the main point&mdash;format and applications shall
remain separated. If you want to improve the first, submit proposals
as explained above. If you want faster or more featureful code, do it
yourself or help the developer(s) of the corresponding application
without touching the format or inventing a new one.
</p><p>
Several standalone filters already are available to move back and
forth between OASIS/OOo files (or XML in general) and other formats. The
utilities RTF2XML, ooo2txt, SIAG, O3read, o3totxt, o3tohtml, OOo2sDbk,
Writer2LaTeX and soffice2html (see Resources) cover together RTF,
(X)HTML, LaTeX, DocBook and, of course, plain text.
</p><p>
CPAN hosts several Perl modules useful for OASIS-related
processing. OpenOffice::Parse::SXC parses OOo spreadsheets, making the
text value of each cell (but nothing else) available for the main
script. It comes with a utility to convert OOo spreadsheets to CSV
format. Another Perl module, XML::Excel can transform Excel
spreadsheets into plain XML, dumping them into an intermediate structure
for custom processing, if necessary. On the server side,
Apache::AxKit::Provider::OpenOffice extracts the content of text
(.sxw) files.
</p><p>
Tcl has linters, DOMs and XSLT interfaces, as well as an API that allows
switching to different parsers with no changes to the application code.
When nothing else is available, a native Tcl parser is used;
otherwise the developer can take advantage of both Expat and Libxml
(see below).
</p><p>
PDA developers have a dedicated project, related to OASIS quite
directly, called XMerge that currently is developed in Java for Palm
and Pocket PC. Its purpose is to allow the editing of OOo documents
(maybe previously converted to a more limited format) with PDA
native applications, in such a way that any changes can be merged back
into the original format without loss of style, formatting and so on.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2620580.0x27192c0"></a>
Parsers and Libraries</h2></div></div><p>
At a lower level, what is needed to manage OASIS files in a larger
application, where the source language usually is C or C++ and
the performance must be maximized?
First of all, the program must include the proper library to compress
and uncompress zipped files. This is not an OASIS-specific issue, so
we won't deal with it further.
</p><p>
Once the single XML files are available, they have to be loaded in a
way that understands and makes accessible the internal structure, that is, the relationships among the several elements. Once this step has been
performed, data can be converted or processed in any manner.
A lot of tools for this already exist. Several of them are
designed to support general XML rather than OASIS, but
the difference is quite a bit smaller than one
might expect. And this situation is expected to improve soon after
the standard is released.
</p><p>
Expat is a popular XML parser written in C that is basic and lacks a validation capability but
still is the fastest one around. It also has front ends for
practically every language. A more featureful library that supports
DTD validation and is designed specifically for GNOME is Libxml.
Like Expat, Libxml is written in C, is portable and can be used within
a lot of languages. The Xerces parser, in Java, also can generate and
validate XML documents.
</p><p>
In the Qt/KDE field, developers have at their disposal, besides the
OOo plugin already mentioned, the related Qt classes and DOM
implementation (QDom) to write or parse XML, as well as the KOffice DTD.
At the time of this writing, these tools still target the KOffice XML format, but
they are expected to converge on the OASIS standard.
</p><p>
For security-conscious developers, the easiest starting point is the C
XML security library (XMLsec), based on LibXML2, which supports both
signing and encryption of XML material.
SAXEcho is a (mostly) Java program that attaches itself to a
running OpenOffice.org document to show the XML tree representation of the current
document. It also validates or modifies the document operating directly on XML nodes,
plus several other nifty things.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2620580.0x2719528"></a>
Event-Driven XML Processing</h2></div></div><p>
The parsers described above build an internal tree
representation of the document. What should one do when developing
applications that must deal with large documents? Keep in mind that
large here means too big to fit into memory,
which is not so big if this
format must be usable even for low-end desktop applications.
</p><p>
The current solutions in this space follow the so-called SAX (simple
API for XML) approach: instead of building the whole
tree of a document in one fell swoop and keeping it there for further processing, go
step by step. A SAX parser reads the document and, instead of keeping
it all in memory, generates an event every time it finds something
worthwhile. The parser then passes the event to event handlers that interact with the
application. The something worthwhile can be XML document-type
definitions, errors or elements of the actual content. A good
starting point for SAX-based programming is the SAX Project. SAX2
already is supported in Java through JAXP and in Perl through the Orchard
Project, which is quite stable, not to mention fast and
lightweight, as far as SAX and XML processing are concerned.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2620580.0x2719688"></a>
Conclusion</h2></div></div><p>
All the research done for this article confirmed one of
my first impressions: so far, the free software/open-source
software approach to guarantee information interchange has been
to develop cross-platform applications, which are difficult
to maintain and optimize for each target environment. Now it
looks like we are starting to do the right thing, which is to
define truly Free, standard, toolkit-independent, cross-platform
formats that leave everyone free to create any possible front
end to read and write them. </p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2620580.0x2719790"></a>Acknowledgements</h2></div></div><p>
Thanks above all to Gary Edwards and David Faure for all the
material and explanations. Pierre Souchay (kfile-plugin-ooo) and the AbiWord
developers also were very helpful.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2620580.0x2719898"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
AbiWord: <a href="http://www.abisource.com" target="_self">www.abisource.com</a>
</p><p>
CPAN: <a href="http://www.cpan.org" target="_self">www.cpan.org</a>
</p><p>
EU-IDA: <a href="http://europa.eu.int/ISPO/ida" target="_self">europa.eu.int/ISPO/ida</a>
</p><p>
Expat: <a href="http://expat.sourceforge.net" target="_self">expat.sourceforge.net</a>
</p><p>
kfile-plugin-ooo: <a href="http://bad.sheep.free.fr/kfile-plugin-ooo.html" target="_self">bad.sheep.free.fr/kfile-plugin-ooo.html</a>
</p><p>
KOffice: <a href="http://koffice.kde.org" target="_self">koffice.kde.org</a>
</p><p>
KOffice DTD: <a href="http://www.koffice.org/DTD/kword-1.2.dtd" target="_self">www.koffice.org/DTD/kword-1.2.dtd</a>
</p><p>
Libxml: <a href="http://xmlsoft.org" target="_self">xmlsoft.org</a>
</p><p>
OASIS Office File Format TC: <a href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=office" target="_self">www.oasis-open.org/committees/tc_home.php?wg_abbrev=office</a>
</p><p>
OASIS Web Site: <a href="http://www.oasis-open.org" target="_self">www.oasis-open.org</a>
</p><p>
OOo2sDbk: <a href="http://www.chez.com/ebellot/ooo2sdbk" target="_self">www.chez.com/ebellot/ooo2sdbk</a>
</p><p>
ooo2txt: <a href="http://ooo2txt.free.fr" target="_self">ooo2txt.free.fr</a>
</p><p>
OpenOffice.org: <a href="http://www.openoffice.org" target="_self">www.openoffice.org</a>
</p><p>
Orchard: <a href="http://orchard.sourceforge.net" target="_self">orchard.sourceforge.net</a>
</p><p>
QDom: <a href="http://doc.trolltech.com/3.1/xml-tools.html" target="_self">doc.trolltech.com/3.1/xml-tools.html</a>
</p><p>
RTF2XML: <a href="http://www.xmeta.com/omlette/rtf2xml" target="_self">www.xmeta.com/omlette/rtf2xml</a>
</p><p>
SAXEcho: <a href="http://xml.openoffice.org/saxecho" target="_self">xml.openoffice.org/saxecho</a>
</p><p>
SAX Project: <a href="http://www.saxproject.org" target="_self">www.saxproject.org</a>
</p><p>
SIAG, O3read, o3totxt, o3tohtml: <a href="http://siag.nu" target="_self">siag.nu</a>
</p><p>
soffice2html: <a href="http://hoopajoo.net/projects/soffice2html.html" target="_self">hoopajoo.net/projects/soffice2html.html</a>
</p><p>
Stop Word Attachments: <a href="http://www.gnu.org/philosophy/no-word-attachments.html" target="_self">www.gnu.org/philosophy/no-word-attachments.html</a>
</p><p>
TclXML: <a href="http://tclxml.sourceforge.net" target="_self">tclxml.sourceforge.net</a>
</p><p>
Writer2LaTeX: <a href="http://www.hj-gym.dk/~hj/writer2latex" target="_self">www.hj-gym.dk/~hj/writer2latex</a>
</p><p>
Xerces: <a href="http://xml.apache.org/xerces-j" target="_self">xml.apache.org/xerces-j</a>
</p><p>
XMerge: <a href="http://xml.openoffice.org/xmerge" target="_self">xml.openoffice.org/xmerge</a>
</p><p>
XMLsec: <a href="http://www.aleksey.com/xmlsec" target="_self">www.aleksey.com/xmlsec</a>
</p></div></div></div>
<div class="authorblurb"><p>
Marco Fioretti is a hardware systems engineer interested in free software
both as an EDA platform and, as the current leader of the RULE Project, as
an efficient desktop. Marco lives with his family in Rome, Italy.

</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../119/toc119.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>