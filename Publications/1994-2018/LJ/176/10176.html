<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
The BlackBerry in a World without Windows
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Using the RIM BlackBerry Curve with&#10;Linux.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x19df580.0x1ad6ac0"></a>
The BlackBerry in a World without Windows
</h1></div><div><div class="author"><h3 class="author">
Carl
 
Fink
</h3></div><div class="issuemoyr">Issue #176, December 2008</div></div><div><p>
Using the RIM BlackBerry Curve with
Linux.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ad72a8"></a></h2></div></div><p>
What's black, red, gold or silver all over? It's a music and video player,
e-mail client, personal organizer, Web browser and high-speed modem. Oh,
and it's a telephone.
</p><p>
Yes, you guessed it, it's the RIM BlackBerry Curve. Like a lot of
<span   class="emphasis"><em>LJ</em></span>
readers, I'm addicted to gadgets. At one point, I carried a cellular
phone, an MP3 player and a PDA everywhere. That's a lot of devices
to stick in your pocket though, and a year or so ago, I decided it
was time to consolidate. After a lot of research, I settled on the
BlackBerry Curve. It has almost everything I need in a very small,
attractive package. The few things not included with the phone, like an
SSH client, are available from third parties. As a longtime Linux user,
I would have liked a Linux-based alternative (I once owned a Sharp Zaurus),
but I couldn't locate any current Linux phones that had all the features
I wanted and was easily available in the US.
</p><p>
Despite my willingness to use a non-Linux phone, I am not willing to
give up my Linux-based computers. Research In Motion supports
only Windows, so using the phone with my computers required some research
and tinkering.
</p><p>
This article covers the following:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Charging your phone over USB.
</p></li><li><p>
Backing up the phone's applications and data to a Linux computer and
restoring if necessary.
</p></li><li><p>
Transcoding video and audio files to use on the Curve.
</p></li><li><p>
Syncing a BlackBerry with Evolution.
</p></li></ul></div><p>
The test system for this article is my HP Pavilion DV6458 laptop running
Debian GNU/Linux's Lenny distribution. By the time this article is
published, Lenny either will be the stable release of Debian, or it will be just
short of that status. My phone is the BlackBerry Curve 8320, running on
the T-Mobile network.
</p><p>
For it to be useful as anything but a pure telephone, you must install
a microSD Flash memory card in your Curve. I use a 6GB card, which can
hold 20 albums of music plus 20 podcasts at a time and still leave a
couple gigs for photos and video. Installing your microSD card will
expose you to one of RIM's puzzling decisions: the SD card is under
the battery. Yes, that's right. You have to power-cycle the phone to
change cards. As booting after a power cycle is notoriously slow for
BlackBerries, this is a major annoyance. Because of this, I strongly
recommend getting the highest-capacity card or cards you can afford to
minimize the need to swap.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ad7988"></a>
Connecting the Phone to the PC</h2></div></div><p>
Another thing that puzzles and irritates Research In Motion's
customers: RIM includes Bluetooth in its phones, but it's crippled. If you'd like to transfer data to and from
your BlackBerry Curve, you must use a USB cable. The upside is, it's
incredibly simple. Just plug a standard USB cable in to the phone and
computer, and your system should detect the phone automatically. If
you are using a disk manager, such as gnome-volume-manager, the microSD
card in the BlackBerry should appear automatically as a removable disk
drive. Transferring anything to or from the card is as simple as a cp
command or dragging and dropping in any file manager.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ad7a90"></a>
Backup and Restore</h2></div></div><p>
First, you obviously can back up and restore the contents of
the microSD card like any other mounted drive. However, the phone's
own databases are not part of the filesystem, so special software is
required. Luckily for me, there's a package already designed for this
purpose, Barry, a project hosted and supported by NetDirect, a Canadian
computer consultancy specializing in open-source solutions (<a href="http://www.netdirect.ca/software/packages/barry" target="_self">www.netdirect.ca/software/packages/barry</a>). Barry currently
is alpha software, but it's quite usable. Unfortunately, it is not officially
packaged for Debian. There are unofficial packages at that site for
Debian Stable (Etch), but they are for the i386 architecture only, and
they were problematic to install on my AMD64 system, so I was forced to compile
my own. (In testing on my tower system, which runs the i386 distribution
of Debian Lenny, the pre-created packages worked perfectly.) There is
a special set of downloads and instructions on how to create Debian
packages available at the Barry site, but unfortunately, they did
not work on my system. (This may have been fixed by the time you read
this.) However, the traditional <tt  >make ; sudo make
install</tt> combination
worked perfectly. You can use stow to manage unpackaged applications.
</p><p>
Doing <tt  >make install</tt> puts the libbarry* libraries into /usr/local/bin, but
the actual executables expect them to be in /lib/tls. Rather than try to
reconfigure the program, I simply copied the libraries to that location.
</p><p>
RPMs and instructions for creating RPMs are supplied for distributions
that use that packaging system.
</p><p>
After installing Barry, you immediately can back up the BlackBerry
databases, including contacts, appointments, settings, memos and so
on. First,
run the bcharge program. bcharge does two things:
</p><div class="orderedlist"><ol type="1"><li><p>
You may have noticed that when you plug your BlackBerry in to a
PC running Linux, you are warned that the &ldquo;charging current is not
sufficient&rdquo;. bcharge increases charging current to 500mA and eliminates
this message, plus it allows your phone to charge much faster.
</p></li><li><p>
It takes control of the device away from the usb_storage kernel module,
so that access to the database and other functions is available. Despite
this, the microSD card still can be mounted and files copied back
and forth.
</p></li></ol></div><p>
Note: bcharge is not compatible with the kernel module berry_charge. If
lsmod reveals that berry_charge is present, use <tt  >sudo modprobe -r
berry_charge</tt> to remove it before running bcharge. If you plan to
use bcharge routinely, blacklist berry_charge (<tt  >sudo echo "blacklist
berry_charge" &gt;&gt; /etc/modprobe.d/blacklist</tt>).
</p><p>
Apparently, bcharge works differently on different computers, depending on
the exact device configuration and system. Try running <tt  >sudo
bcharge -o</tt>
first. If this fails, try <tt  >sudo bcharge</tt> (no flag). If even that fails,
try <tt  >sudo bcharge ; sudo bcharge -o</tt>. You can check whether the device
has been detected using <tt  >sudo btool -l</tt>. On my computer, when the device
is detected I see this output:

<pre     class="programlisting">
Blackberry devices found:
Device ID: 0xFFFFFF. PIN: FFFFFFF, Description: RIM 8300 
 Series Colour GPRS Handheld
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ad8328"></a></h2></div></div><p>
(I have obscured my device and pin numbers in the above output.)
</p><p>
Barry's btool offers a lot of functionality, and I encourage you to
do a <tt  >man btool</tt> to learn more.
</p><p>
To back up my phone's databases, I used the barrybackup application. The
installer did not set the program to setuid root, which is required. I
had to <tt  >sudo chmod +s /usr/local/bin/barrybackup</tt> before the program
would work correctly.
</p><div       class="mediaobject"><img src="10176f1.jpg"><div class="caption"><p>
Figure 1. BarryBackup
</p></div></div><p>
Simply click the Backup button, and all databases are backed up. You
can configure which databases are backed up and also choose to restore
only certain databases, by clicking Edit&rarr;Config. Backups are stored
as tar.gz files in ~/.barry/backup/FFFFFFFF, where that last hex number
is your device PIN.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ad87a0"></a>
Audio and Video on the Curve</h2></div></div><p>
I got this phone specifically to replace my MP3 player. It has excellent
sound and video quality (given the tiny screen's limitations), and a
high-capacity microSD card can hold a lot of music. Of course, given that
the card must hold music, video, photos taken with the built-in camera,
ebooks and everything else, you will want to use the most efficient
file formats.
</p><p>
First, let's discuss music. The Curve supports MP3, AAC, MIDI and WMA files for
audio. Because I'm trying to use free tools as much as possible, WMA and
AAC formats are problematic, leaving me with MP3. (MIDI is a specialized
format not usable for recorded music.) MP3 files also are supported in
fapg (see below).
</p><p>
For CD audio, I use A Better CD Encoder (abcde) to rip the CD, with the
command:

<pre     class="programlisting">
abcde -o mp3
</pre>
</p><p>
This rips the CD into MP3 files in the current directory. As
abcde uses lame for MP3 encoding, you can control the details of the
files created to the finest detail, but the default settings actually
are more than good enough for me.
</p><p>
The video screen on the Curve has a resolution of 320x240. It accepts
video in MP4, 3GP and WMV formats. Obviously, we free-software types
prefer to use MP4 (even if it's a patented format) over WMV. I'm not
aware of any good free tools to create 3GP (Third-Generation Phone) files.
</p><p>
The Swiss Army knife of free software
video encoders is FFmpeg. For Debian distributions, you can
obtain it by adding the repository at <a href="http://debian-multimedia.org" target="_self">debian-multimedia.org</a> to your
/etc/apt/sources.list, then running <tt  >sudo apt-get update
&amp;&amp; sudo apt-get
install ffmpeg</tt>. Starting with any supported video, converting is as
simple as this command:


<pre     class="programlisting">
ffmpeg -i myvideo.avi -s 320x240 -b 64k --ab 64k myvideo.mp4
</pre>
</p><p>
This sets the dimensions to 320x240, and the audio and video bitrates
to 64kbps. You can adjust these settings to taste. Note that the Curve
can play back video compressed using only the MPEG 4 Part Two Advanced
Simple Protocol (ASP). H.264, or MPEG 4 Advanced Video Codec, is
<span   class="emphasis"><em>not</em></span> supported.
</p><p>
Transferring audio and video files to the handset can be done with
cp or a file manager like Krusader. Audio files should be stored in
/Blackberry/music, and video in /Blackberry/videos. You can create
subfolders within these for your own convenience, but the handset will
ignore them and catalog the media based only on metadata (also known as
ID3 tags) embedded in the files. Music can be viewed by Artist, Album,
Genre or Playlists. The Media application works with M3U playlists,
which can be created using fapg (the FAst Playlist Generator, see
Resources). M3U playlists are simple text files and can be modified
using any editor.
</p><p>
When the Curve is disconnected from your computer, the Media application
scans the music and video directories and generates lists of available
audio and video files. This takes a few minutes, depending on
how much is stored on the microSD card. Your songs may not be available
until the scan is complete.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ed0fc8"></a>
Synchronizing with Evolution</h2></div></div><p>
NetDirect has an excellent document explaining how to sync your
BlackBerry Contacts and Appointments with Evolution using Barry here:
<a href="http://www.netdirect.ca/software/packages/barry/sync.php" target="_self">www.netdirect.ca/software/packages/barry/sync.php</a>. To do so
requires that you install the Debian packages multisync-tools and
libopensync0.
</p><p>
Before synchronizing, you must create a sync group that includes
Evolution and the Barry opensync plugin (Listing 1).

</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ed11d8"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Listing 1. Setting Up msynctool to Work with
Evolution and the BlackBerry</b></p><pre     class="programlisting">
msynctool --addgroup evo-barry             # Create the sync group
msynctool --addmember evo-barry evo2-sync  # dd Evolution's OpenSync 
                                           # plugin
msynctool --addmember evo-barry barry-sync # Add Barry's OpenSync 
                                           # plugin
msynctool --configure evo-barry 1          # Opens an editor for the
                                           # evo2-sync config file
msynctool --configure evo-barry 2          # Opens an editor for the
                                           # barry-sync config file
</pre></div><p>
Unless you have changed the default locations of the Evolution data
files, you shouldn't need to change anything in the configuration file
for evo2-sync. The barry-sync default configuration file looks like Listing
2.

</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ed1498"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Listing 2. The barry-sync Configuration File</b></p><pre     class="programlisting">
# This is the default configuration file 
# for the barry-sync opensync plugin.
# Comments are preceded by a '#' mark at the 
# beginning of a line.
# The config format is a set of lines of .
#
# Keywords available:
#
# DebugMode - If present, verbose USB debug 
# output will be enabled
#
# Device - If present, it is followed by the following values:
# PIN number - PIN number of the device to sync with (in hex)
# sync calendar - 1 to sync calendar, 0 to skip
# sync contacts - 1 to sync contacts, 0 to skip
#
# Password secret - If present, specifies the device's 
# password in plain text
#

#DebugMode

Device 3009efe3 1 1

#Password secret
</pre></div><p>
Unless you have assigned a password for your Curve, the only change
needed here is to replace 3009efe3 with the correct PIN, which you can
find using <tt  >btool -l</tt>. If you have trouble with sync, you can uncomment
DebugMode. Before syncing, Evolution and its back-end servers should be
shut down:

<pre     class="programlisting">
evolution --force-shutdown
</pre>
</p><p>
Then, syncing is as easy as:

<pre     class="programlisting">
msynctool --sync evo-barry
</pre>
</p><p>
Note: on my Debian system, msynctool could not connect to the BlackBerry
unless it was able to run with elevated privileges:

<pre     class="programlisting">
sudo chmod +s /usr/bin/msynctool
</pre>
</p><p>
You also could change the permissions on the USB device to correct
this problem.
</p><p>
Sync still is very much in alpha, and it can destroy your data! Be sure
you have backups of both the Curve and Evolution databases before
you sync.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ed19c0"></a>
Wrapping Up: Alternatives and the Future</h2></div></div><p>
My BlackBerry does not connect to a BES (BlackBerry Enterprise Server), so
I have not tested any interactions between Barry and enterprise systems.
</p><p>
There is another free software project with the goal of making BlackBerry
functionality available to Linux users. XmBlackBerry is a single GUI
program, as opposed to Barry's suite of several mostly command-line
tools. I went with Barry for myself and for this article, because
XmBlackBerry hasn't had a release in more than a year, and I am comfortable
on the command line. If you have a BlackBerry, keep an eye on
XmBlackBerry, which is being actively developed and looks very promising.
</p><p>
Both Barry and XmBlackBerry support using the phone as a tethered modem
to connect your computer to a cellular data network. However, at
this time, neither works correctly with the 8320. I have reported this
to the Barry developers, and by the time you read this article, the problem may
have been fixed. I hope so, because using the Curve as a modem is almost
the only reason I ever boot my laptop into Windows.
</p><p>
When I started using Linux in the early 1990s, there was a real
feeling of adventure. Every time you installed a program, you were
likely to have to solve some sort of problem or invent a workaround. I
don't regret the fact that Linux and free software are so polished and
generally easy to use. Still, it's exciting to be working with software
on the cutting edge again. BlackBerry support in Linux still is a work
in progress, but it's just the sort of fun challenge that got a lot
of us into this in the first place. I'm looking forward to seeing how
things progress.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ed1c28"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
Barry: <a href="http://www.netdirect.ca/software/packages/barry" target="_self">www.netdirect.ca/software/packages/barry</a>
</p><p>
XmBlackBerry: <a href="http://xmblackberry.sourceforge.net" target="_self">xmblackberry.sourceforge.net</a>
</p><p>
Syncing Your Blackberry: <a href="http://www.linux.com/feature/123251" target="_self">www.linux.com/feature/123251</a>
</p><p>
A Better CD Encoder (abcde): <a href="http://code.google.com/p/abcde" target="_self">code.google.com/p/abcde</a>
</p><p>
Evolution: <a href="http://freshmeat.net/redir/evolution/2452/url_homepage/evolution" target="_self">freshmeat.net/redir/evolution/2452/url_homepage/evolution</a>
</p><p>
Fast Audio Playlist Generator (fapg): <a href="http://royale.zerezo.com/fapg" target="_self">royale.zerezo.com/fapg</a>
</p><p>
FFmpeg: <a href="http://ffmpeg.mplayerhq.hu" target="_self">ffmpeg.mplayerhq.hu</a>
</p></div></div></div>
<div class="authorblurb"><p>
Carl Fink has, in his career, been a museum guide, schoolteacher,
system administrator, programmer and corporate trainer. These days, he
makes his living as a writer and spends much of his spare time helping to
put on I-CON, an annual science-fiction convention on Long Island. He blogs
at <a href="http://nitpicking.com" target="_self">nitpicking.com</a>.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../176/toc176.html">Issue Table of Contents</a>
    <a class="link3" href="../176/10176.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>