<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>At the Forge</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Mozilla's Sunbird calendar combines the advantages of&#10;centralized, cooperative Web applications with the&#10;speed and usability of a cross-platform desktop tool.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x2626580.0x271dab0"></a>At the Forge</h1></div><div><h3 class="subtitle"><i>
Sunbird and iCalendar</i></h3></div><div><div class="author"><h3 class="author">
Reuven
 M. 
Lerner
</h3></div><div class="issuemoyr">Issue #133, May 2005</div></div><div><p>
Mozilla's Sunbird calendar combines the advantages of
centralized, cooperative Web applications with the
speed and usability of a cross-platform desktop tool.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2626580.0x271e3f8"></a></h2></div></div><p>
When I first started to write server-side software, I laughed at the
thought that I was writing applications. After all, I was writing only
small bits of code; nothing I did could hold a candle to
what a real program, running on the desktop of someone's computer,
could do.
</p><p>
Of course, things have changed quite a bit in the computer industry
since those early days. Today, Web-based applications are not only an
established fact of life, but they seem to be playing an increasingly
prominent role in our daily lives. Recently, I began to look
into software that I could use to prepare my US income taxes. I
shouldn't have been surprised to discover that many companies now are
offering Web-based tax calculation programs. The term ASP, or
application service provider, was hot several years ago, when it
seemed as if all software would work over the Web. Although there
have been some obvious success stories, there also were many failures, for
technical and business reasons alike.
</p><p>
It's easy to understand why Web-based applications are attractive to a
business: you no longer have to test your software on every
platform but instead only on a handful of browsers. You no longer need to
support many different versions of the software, because only
one version is accessible at any given time. Bug fixes and software updates can be
integrated into the system almost continuously. The software is
available from anywhere with an Internet connection, instead of only on the
computer on which it was installed. The list goes on and on. From many
perspectives, this approach makes more sense than stamping out thousands of
CDs, testing the software on hundreds of configurations and staffing
a large call center to support all of those configurations.
</p><p>
But for all of the hoopla, Web applications still are limited
compared to their desktop counterparts. Because all serious
processing is done on the server, including writing to and reading
from databases and files, instantaneous feedback from the interface
is almost impossible. Even with the fastest servers and a lot
of clever magic, such programs still can seem somewhat
tedious. Google's new maps system (see the on-line Resources), for example,
demonstrates that it is possible, albeit difficult, to create Web
applications that feel much like their desktop counterparts.
</p><p>
Those of us without Google's resources increasingly are turning to
another solution, namely using hybrid software&mdash;desktop applications
that rely heavily on Web technologies. It used to be that Web
technology could be described, with a fair degree of precision, as
HTML-formatted documents retrieved by way of HTTP using a URL. Web browsers
were, for a long time, the only programs that made serious use of
these standards.
</p><p>
Today, however, a growing number of desktop programs make use
of HTML, HTTP and URLs, even though they aren't Web browsers. They
use URLs to locate remote resources, HTML for its simple, universally
understood method of creating hyperlinked documents and HTTP because
it is reliable, simple, universal and cacheable. There aren't too
many examples of word processors and spreadsheets using these
protocols&mdash;at least, not that I'm aware of&mdash;but one hybrid program
has been playing an increasingly prominent role in my life, Mozilla
Sunbird.
</p><p>
Sunbird (Figure 1) is the standalone version of the calendar extension that
can be installed along with either Firefox or Thunderbird.
Integration with these two programs is far from perfect, and I
sometimes want to run or restart one without the other. So I
installed Sunbird over the summer and have been pleased with each new
release as it is made available.
</p><div       class="mediaobject"><a href="8091f1.large.jpg"><img src="8091f1.jpg"></a><div class="caption"><p>
Figure 1. The main Sunbird window, in multiweek mode. Two of my three
calendars (Hebcal 2005 and Northwestern grad school) are color-coded,
both in the definition pane and the main window. Also notice how items
in my to-do list are color-coded, indicating whether they are on time,
late, in need of attention or ongoing.
</p></div></div><p>
Now, you might think there is nothing inherently useful about
having a calendar use Web technologies. But in the case of Sunbird
and the iCalendar standard, there is a major benefit&mdash;namely, the
ability to create calendars for public consumption. This month, we
begin a several-month journey through the
creation, distribution and sharing of calendars based on the
iCalendar standard. Along the way, we'll see not only how to work
with iCalendar, but how the hybrid applications can provide a powerful
combination of features and an enhanced user experience.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2626580.0x271e920"></a>
iCalendar and Sunbird</h2></div></div><p>
iCalendar is an Internet standard for sharing calendar
information across different computers. The basic
idea is simple: if everyone at my office keeps track
of their schedules on their own computers, it
makes things efficient for those individuals but no
better for the group than if everyone were using
a pocket diary. Scheduling meetings still would be
a hassle. Moreover, group events would have to be
entered once on each person's calendar&mdash;meaning
that when a meeting moves from Monday to Wednesday,
each of the people on the team needs to adjust their
individual calendars accordingly.
</p><p>
iCalendar was designed to solve this problem by standardizing the
calendar files themselves such that those files can be
transferred from one program to another. The original vision, as far
as I can tell, pictured everyone using programs that implement
iCalendar on their computers and sharing that information with
others by way of the network and Internet. The reality has taken some time
to catch up with this theory, but a variety of programs now are
available that do implement parts of the iCalendar suite.
</p><p>
I should note that the entire iCalendar Project has been the victim of
some bad and unlucky naming problems. The file in which data is
stored and that can be used to interchange information is called
vCalendar, just as the electronic business-card format is known as
vCard. But many people and applications, including Sunbird, refer to the file format as iCalendar, even though the file
identifies itself as vCalendar. As you can imagine, the term iCalendar
has been shortened to iCal, which is especially unfortunate, given
that Apple's Mac OS X operating system comes with a program called iCal
that uses the vCalendar file format. Because the use of vCalendar
to describe these files seems to have gone the way of the dodo, I simply
use the word iCalendar to refer to both the file format and
the overall standard.
</p><p>
Download and install the appropriate version of the Sunbird standalone
calendar program; see Resources for the URL. If you're a bit more
daring, you can install one of the nightly builds; I actually am
using Sunbird as my primary calendaring application, so I have been using
the official builds. If you prefer to have your calendar integrated into
either Firefox or Thunderbird, go to the main download page and choose
the appropriate extension and version that you would like to install.
If you install an extension to Firefox or Thunderbird, you need to
restart the host program before continuing.
</p><p>
Sunbird allows you to create two types of items, events and tasks.
Events normally appear on the calendar itself and can include
holidays and meetings. Tasks normally appear on the left side of the
screen and indicate things that you should get done, with an optional
starting and ending date. Sunbird changes the color of tasks
according to how soon they need to be done; overdue tasks are in red,
current ones are in blue and future ones are in green. Gray tasks
are in the far-off future, and crossed-out ones&mdash;if you choose to
display them&mdash;are completed tasks.
</p><p>
Both events and tasks can be repeating, meaning we can schedule a
meeting for every Wednesday at 4 pm over the next ten weeks rather
than entering ten individual events in the calendar. We can enter
exceptions to such recurring events as needed, and we can set them to recur every
few days, months or years, with &ldquo;every few&rdquo; being user-definable.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2626580.0x271ec38"></a>
iCalendar Files</h2></div></div><p>
The way in which Sunbird structures these events and tasks strongly
mirrors the vCalendar files in which they are stored. Although you
might expect a modern Internet standard to use XML, iCalendar's file
format consists of name-value pairs separated by a colon (:). Each
event or task has its own begin or end line, and the entire
calendar file similarly is nested between overall begin and end
lines. Normally, each name-value pair in an iCalendar file sits on a
single line. However, indenting a line with any whitespace means that
it continues the data from the previous line, as in:

<pre     class="programlisting">
name:value
name2:
 value2
name3
 :value3
</pre>
</p><p>
The above example defines three name-value pairs, each making slightly
different use of whitespace. Sunbird normally uses the third option,
such that each name is on a line by itself with its associated value
indented on a subsequent line. Sunbird, as with other Mozilla products,
puts all of its data files in a profile directory whose name is
created randomly when you first start the program. The iCalendar
files themselves are placed in the Calendar subdirectory within the
profile directory.
</p><p>
The beauty of iCalendar is you aren't expected to have all of the
calendar data in one file or even on one computer. An
iCalendar-compliant program displays the union of all calendar data
from all of the data files it has been instructed to read. You
thus can have several different calendar files on your own computer,
each of which reflects a different aspect of your life, for example,
personal vs. professional. You also can retrieve calendar data files from
other sources, including over HTTP, meaning that group calendars can
be stored on a public server but displayed on your own computer.
</p><p>
When you first start Sunbird or when you first create a calendar with
it, the program creates a CalendarDataFile.ics file. If you have more
than one calendar, you end up with a number of such files on your
system. Each file has the name CalendarDataFileN.ics, where
N represents the number of the calendar you have created.
</p><p>
The structure of the file itself is pretty simple. For example, here
is an iCalendar file with a single event, namely this month's <i  >Linux Journal</i> deadline:

<pre     class="programlisting">
BEGIN:VCALENDAR
VERSION
 :2.0
PRODID
 :-//Mozilla.org/NONSGML Mozilla Calendar V1.0//EN
BEGIN:VEVENT
UID
 :05e55cc2-1dd2-11b2-8818-f578cbb4b77d
SUMMARY
 :LJ deadline
STATUS
 :TENTATIVE
CLASS
 :PRIVATE
X-MOZILLA-ALARM-DEFAULT-LENGTH
 :0
DTSTART
 :20050211T140000
DTEND
 :20050211T150000
DTSTAMP
 :20050209T132231Z
END:VEVENT
END:VCALENDAR
</pre>
</p><p>
As you can see, the file begins and ends with VCALENDAR declarations.
Each event is surrounded by BEGIN:VEVENT and END:VEVENT. Each event
then has a unique ID; a summary, which normally is displayed in the
calendar; a status; a class, which indicates whether you want to share this
calendar information with others; and then the starting and ending
times. It also has a timestamp showing when the event was
last modified.
</p><p>
Timestamps in iCalendar files adhere to a slightly strange format of
YYYYMMDD representing the date and then a T followed by the 24-hour clock
time, followed by an optional time zone and a Z. Because I currently am
living in Chicago, the timestamp represents not the time at
which I made the entry, but the time it is in the time zone six
hours ahead of me, one hour later than GMT (1Z).
</p><p>
What happens if I have a monthly deadline, and I want to include that in
this calendar event? In Sunbird, I can go into the recurrence tab
in the event editor by double-clicking on the event. There, I indicate
that I want this event to repeat once every month, which changes the
interface such that I'm now asked if it should be on the 11th of every
month&mdash;that is, on the same date&mdash;or on the second Friday of
every month, relative to the month. If I choose the first, my iCalendar
file looks like this:

<pre     class="programlisting">
BEGIN:VCALENDAR
VERSION
 :2.0
PRODID
 :-//Mozilla.org/NONSGML Mozilla Calendar V1.0//EN
BEGIN:VEVENT
UID
 :05e55cc2-1dd2-11b2-8818-f578cbb4b77d
SUMMARY
 :LJ deadline
STATUS
 :TENTATIVE
CLASS
 :PRIVATE
X-MOZILLA-ALARM-DEFAULT-LENGTH
 :0
X-MOZILLA-RECUR-DEFAULT-UNITS
 :months
RRULE
 :FREQ=MONTHLY;INTERVAL=1
DTSTART
 :20050211T140000
DTEND
 :20050211T150000
DTSTAMP
 :20050211T132231Z
LAST-MODIFIED
 :20050211T153505Z
END:VEVENT
END:VCALENDAR
</pre>
</p><p>
Notice how a RRULE property has been added, with values of
FREQ=MONTHLY and INTERVAL=1. You might imagine that if I were to change
this deadline to be every two weeks, it would be FREQ=WEEKLY and
INTERVAL=2. This is true, except that it also adds a BYDAY=FR field,
indicating that the event happens on Fridays.
</p><p>
If I choose to make this event occur on the second Friday of each
month, the iCalendar file looks like this:

<pre     class="programlisting">
BEGIN:VCALENDAR
VERSION
 :2.0
PRODID
 :-//Mozilla.org/NONSGML Mozilla Calendar V1.0//EN
BEGIN:VEVENT
UID
 :05e55cc2-1dd2-11b2-8818-f578cbb4b77d
SUMMARY
 :LJ deadline
STATUS
 :TENTATIVE
CLASS
 :PRIVATE
X-MOZILLA-ALARM-DEFAULT-LENGTH
 :0
X-MOZILLA-RECUR-DEFAULT-UNITS
 :months
RRULE
 :FREQ=MONTHLY;INTERVAL=1;BYDAY=2FR
DTSTART
 :20050211T140000
DTEND
 :20050211T150000
DTSTAMP
 :20050211T132231Z
LAST-MODIFIED
 :20050211T153824Z
END:VEVENT
END:VCALENDAR
</pre>
</p><p>
Notice how our RRULE property now is FREQ=MONTHLY, because this happens
every month, with an INTERVAL=1. Also notice that BYDAY=2FR has been
added, meaning that the event takes place on the second Friday of each month.
</p><p>
Finally, let's take advantage of Sunbird's ability to have remote
calendars by moving this file out of our directory and onto another
system. I move the CalendarDataFile7.ics file, which was so named
because it was the seventh calendar I created, to /tmp. I
then copy it to my Web site so it can be available at the URL
http://reuven.lerner.co.il/CalendarDataFile7.ics. I double-check
that the file is available from this URL by trying to download it
using wget. When I see that it works fine, I know I can put
this information into Sunbird.
</p><p>
Now I go into Sunbird and delete the ATF calendar; Sunbird won't
let you remove the filename of an existing local calendar. I then
choose subscribe to remote calendar from the File menu, and enter
the URL at which I have placed my .ics file. Once the calendar has
been downloaded, I see the <i  >LJ</i> deadline event on my calendar each
month, exactly as if it were on my local machine. And in fact, if you
look in the Calendar directory, you can see that the file
<span   class="emphasis"><em>is</em></span> on
your local machine. It has been downloaded and installed into that
directory, and it can be refreshed whenever you request. Simply right-click
on the calendar name and select reload remote calendar).
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2626580.0x271f3c8"></a>
Conclusion</h2></div></div><p>
Our investigation of hybrid desktop-Web applications has begun with
an examination of the iCalendar/vCalendar file format, using the
Mozilla standalone Sunbird application. We were able to create
different types of events and then move the resulting iCalendar file
from our local machine to a remote server.
</p><p>
However, our calendar is static, meaning that someone has to
modify it by hand or by uploading a calendar file each time it
changes. In my next column, we will learn how to create iCalendar files
dynamically, using a Web/database application. We then will look at
different ways in which calendars created on one computer can be
written to a server and shared with other people.
</p><p><span   class="bold"><b>Resources for this article:</b></span>
<a href="../133/8128.html" target="_self">/article/8128</a>.
</p></div></div>
<div class="authorblurb"><p>
Reuven M. Lerner, a longtime Web/database consultant and developer,
now is a graduate student in the Learning Sciences program at
Northwestern University. His Weblog is at <a href="http://altneuland.lerner.co.il" target="_self">altneuland.lerner.co.il</a>, and you can reach him at
<a href="mailto:reuven@lerner.co.il">reuven@lerner.co.il</a>.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../133/toc133.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>