<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Cooking with Linux&mdash;The French Connection</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    Mr. Gagn&eacute; provides us with several recipes from his famed&#10;    French restaurant.&#10;    "><meta name="keywords" content="administration"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x20a9580.0x21a0ab0"></a>Cooking with Linux&mdash;The French Connection</h1></div><div><div class="author"><h3 class="author">Marcel Gagn&eacute;</h3></div><div class="issuemoyr">Issue #65, September 1999</div></div><div><p>
    Mr. Gagn&eacute; provides us with several recipes from his famed
    French restaurant.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20a9580.0x21a12f0"></a></h2></div></div><p>Allo, and welcome to <span   class="emphasis"><em>Chez
Marcel</em></span>, home of fine French Linux cooking.
</p><p>Please take a seat. If you have not already done so, I would
like you to read this article with a somewhat exaggerated French
accent since that is the way I wrote it. Even the README files are
heavily accented. For those of you who, like myself, are French,
you may translate as you read, thus adding another level of
authenticity to the excellent menu that awaits you.</p><p>It is an honour and a privilege to welcome you to my kitchen.
Tonight, I have a special treat for you. The recipes I have
prepared are made from common Linux distribution ingredients so
that you can recreate these delicacies when you return to your own
kitchen CPU. Tonight's menu:</p><div class="itemizedlist"><ul type="disc"><li><p>Mail notification for Windows clients</p></li><li><p>What's my IP?</p></li><li><p>diald Control</p></li><li><p>Waiter! More disk.</p></li><li><p>Waiter! There's a fly in my system.</p></li><li><p>Is it That Time Already?</p></li></ul></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20a9580.0x21a1978"></a>A Little Wine with Dinner?</h2></div></div><p>I must tell you right now that I am thrilled you have decided
to join me in my kitchen. Much of what I have in store for you is
designed to make Windows 9<span   class="emphasis"><em>x</em></span> more productive
with a little help from Linux. If you have already cast away your
Windows PC but you miss some forgotten piece of software (provided
that software is not too demanding), you could check out
http://www.winehq.com/ for the latest version of the Windows
non-emulator for Linux.</p><p>For many users out there, the Windows workstation is still on
the desktop, while the Linux machine performs such noble tasks for
the Windows user as connecting to the Internet, providing firewall
services, delivering mail, sharing disk space and printers, among
other services.</p><p>What we have in store for you here today are Linux scripts
that can make your Windows experience more enjoyable.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20a9580.0x21a1b88"></a>Talking to Windows</h2></div></div><p>In the next few examples, we will have our Linux system talk
back to Windows. While that is a good idea, we must first set up
Windows to listen; otherwise, all our talk will disappear into the
proverbial ether. When our Linux system needs to contact a Windows
user, it will do so using Samba's
<span   class="bold"><b>smbclient</b></span> messaging functionality.
Obviously, that requires a system running Samba. On the Windows
side, it requires Winpopup.</p><p>To set up Winpopup to start each time you boot Windows,
create a shortcut in the Windows Startup folder. Click on the Start
button, then Settings, then Taskbar. Choose the tab that says
&ldquo;Start Menu Programs&rdquo;, then click the Advanced button. This will
open a Windows Explorer window. Open the Startup folder under
Programs and add a shortcut to winpopup.exe. Accept the default
name, and you will wind up with a cute little Jack-in-the-box icon.
Right-click on it to access the properties tab. Now, set the Run:
option to <span   class="emphasis"><em>Minimized</em></span>. Winpopup starts up out of
the way, and pops up only when it gets a message. Double-click the
icon to start it right away.</p><p>One more thing: you should now see Winpopup sitting minimized
on your taskbar. Click on it to bring it up. Now click on Messages,
and choose Options from the drop-down menu. Click the box for &ldquo;Pop
up dialog on message receipt&rdquo;. Click OK and re-minimize Winpopup.
Windows is now ready to receive messages from your Linux system,
which brings us to the next item on the menu.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20a9580.0x21a1df0"></a>Why Didn't Somebody Tell Me I Have Mail?</h2></div></div><p>This is a frequent question we get from users. You are the
administrator of a small- to medium-size office; you've set up an
Internet gateway that picks up the mail on a regular basis using
<span   class="bold"><b>fetchmail</b></span>, which then stores it on
your Linux server. The problem is that your users are still running
Windows with some sort of stand-alone POP3 e-mail package like
David Harris' Pegasus Mail. While many packages can be set up to
retrieve mail automatically, keeping them open and running taxes
their already taxed Windows system. This means users tend to point
out how slowly their systems are running. You suggest they close a
few applications. &ldquo;How about e-mail?&rdquo; you suggest. To which they
reply, &ldquo;What if I miss an important message?&rdquo; The solution is the
checkusermail script shown in Listing 1.</p><p><a href="3489l1.html" target="_self">Listing 1.</a></p><p>In /usr/local/etc, create a small text file called
mail_notify with the names of users who receive mail on your
system. If the Windows clients are named differently (in the
network configurator of the Windows control panel) than the user ID
for mail, create an /etc/lmhosts file with IP addresses matching
your mail user IDs, and the results should be the same. The script
can be run from <span   class="bold"><b>cron</b></span> at whatever
time interval suits your environment. Since it runs as root, it can
spy into everyone's mailbox with the
<span   class="bold"><b>frm</b></span> command. It will tell each
user they have mail and how many messages. If there is no mail,
there is no message and no need to waste time and energy checking
every few minutes.</p><p>Another happy soul you'll discover after you deploy this
script is the boss who had been complaining about either the amount
of time users spent checking mail, or the user who did not check it
often enough and missed an important message.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20a9580.0x21a2160"></a>Hey There, What's Your IP?</h2></div></div><p>In the last example, I talked about the beleaguered
administrator (is there any other kind?) and suggested this might
be a useful tool for them as well. What if you are administering
that system from far away? Worse yet, this Internet gateway runs on
a budget&mdash;it's a simple dial-up connection to an ISP running diald
and IP masquerading. When trouble strikes, they call you.
<span   class="emphasis"><em>Trouble</em></span> means you use TELNET to log in, check
things out and fix the problems remotely. Trouble is, the IP is
dynamic and changes with each connection to the ISP. The solution
this time is the showppp.pl script shown in Listing 2. The script
is simple and lives in cgi-bin. Depending on your web server setup,
you might want to rename this one showppp.pl.</p><p><a href="3489l2.html" target="_self">Listing 2.</a></p><p>Setting up a simple Intranet for your users is a breeze. A
nice corporate home page with some popular links to the Internet
makes it easier on your resources than having each user start up
their browser with http://www.cnn.com/ or http://www.excite.com/ as
their start page. If your dial-up connection gives you only a fixed
number of hours per month, that time can get chewed up very
quickly.</p><p>Why not use that same page and give your users a link to a
script that will display the IP address of your dial-up IP
connection without requiring them to log in to your Linux server?
Figure 1 shows just such a page.</p><p><a href="3489f1.jpg" target="_self"><span   class="bold"><b>Figure 1. Show
IP Page</b></span></a></p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20a9580.0x21a2528"></a>Speaking of diald...</h2></div></div><p>Every once in a while, the
<span   class="bold"><b>diald</b></span> process may get hung up.
Sometimes the modem has gotten hung up and diald can't seem to drop
it. In either case, the easiest way to get life back to normal is
to stop diald and restart the process. Since you are operating
remotely and want to make this as painless as possible, you can
either do the work yourself or talk one of your remote users
through the process. It would be so much easier if they could just
type one command, rather than doing a
<b  >ps&nbsp;ax&nbsp;|&nbsp;grep&nbsp;diald</b> while
hoping they kill the right PID and not bring your system down.
Listing 3 is a little script to do just that. The user simply
types:</p><pre     class="programlisting">
diald.control restart
</pre><p>to get things moving again. You can also use the script to
stop diald, start it, or shut it down and start a single instance
of mgetty in order to pick up a fax (but that's for another time).
</p><p><a href="3489l3.html" target="_self">Listing 3.</a></p><p>You can use this example as a template to create any number
of start, stop or restart scripts. When necessary, you can have
trusted users log in to your server and run simple administration
scripts like this one without risking damage to your system or the
equally ominous possibility of killing an important process like
<span   class="bold"><b>init</b></span>. After all,
<b  >kill&nbsp;--1</b> looks very similar to
<b  >kill&nbsp;1</b>, doesn't it?</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20a9580.0x21a29a0"></a>Waiter! More disk!</h2></div></div><p>Remember those great little messages for letting your users
know they have mail? How about using that same technique to let
you, the administrator, know that some important system event needs
your attention? For example, suppose you are constantly battling
disk space. Wouldn't it be nice if the system let you know that
resources are low? With the next little Perl script (see Listing
4), you can have your Linux system send a pop-up message to your
Windows workstation alerting you that system resources are low.
This script scans disk partitions and reports to client
<span   class="bold"><b>speedy</b></span> that disk space usage is
over 90%. (See Figure 2.)</p><p><a href="3489l4.html" target="_self">Listing 4.</a></p><div       class="mediaobject"><img src="3489f2.jpg"><div class="caption"><p>
Figure 2. Disk Space Usage Screen
</p></div></div><p>The Windows <span   class="bold"><b>winpopup</b></span> utility
is a great tool for the user who still runs a Windows client but
needs to get information sent to him from their Linux servers. This
script and the earlier mail notification script highlight this
flexibility.</p><p>By the way, the next item on the menu, the fly&mdash;that's just
to get you thinking about other possibilities.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20a9580.0x259b0c0"></a>Where Does the Time Go and What Time Is It
Anyway?</h2></div></div><p>In my business, I've set up a number of Linux internet
gateways. To make these installations as inexpensive as possible,
we set the machines to dial every half hour or so to pick up mail.
That half-hour mark is also our cue to log in using TELNET if we
need to do some administration work on the machines. Unfortunately,
the time on each machine can vary. How about a way to check the
time against some reliable source and adjust the Linux
server?</p><p>The script in Listing 5 is a bit of Perl magic. It opens a
socket on a secondary time server, picks up the time, and closes
the socket. This is a nice alternative to NTP in that it does not
tax the NTP time server's resources. For that very reason, the NTP
rules ask that you do not use primary servers if you don't need to.
A link to the &ldquo;Public NTP Time Servers&rdquo; page is provided in
Resources.</p><p><a href="3489l5.html" target="_self">Listing 5.</a></p><p>Notice the line in Listing 5 that says
<b  >remote_host="chime.utoronto.ca";</b>. The host
specified here is chime.utoronto.ca, but it could be one of any
number of machines which offer primary or secondary time services.
Consider the rules, though, and visit the NTP time server page for
a system in your area and time zone.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20a9580.0x259b380"></a>Sorry Folks, it's Closing Time</h2></div></div><p>Well, that last script on time was my way of getting all of
you out of the restaurant. I hope you'll pay another visit to
<span   class="emphasis"><em>Chez Marcel</em></span>. We hope we've succeeded in
whetting your appetite for some of the wonderful and fun things you
can do with a Linux system. Bon App&eacute;tit!</p><p><a href="3489s1.html" target="_self">Resources</a></p><p>
<div       class="mediaobject"><img src="3489f3.jpg"></div>
</p></div></div>
<div class="authorblurb"><p>
      <span   class="bold"><b>Marcel Gagn&eacute;</b></span>
            (mggagne@salmar.com) lives in the mythical city of Mississauga,
      Ontario. Besides being a space alien, adventurer, pilot, magician
      and international man of mystery, he is president of Salmar
      Consulting Inc., a systems integration and network consulting firm.
      He also writes science fiction and fantasy, and edits
      TransVersions, a science fiction, fantasy and horror
      magazine.</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../065/toc065.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>