<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Fixing Web Sites with GreaseMonkey</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Who says View Source on a Web page has to be a read-only&#10;proposition? Re-mix your favorite Web sites by changing styles, adding and&#10;removing elements, and more.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x17a6580.0x189dab0"></a>
Fixing Web Sites with GreaseMonkey</h1></div><div><div class="author"><h3 class="author">
Nigel
 
McFarlane
</h3></div><div class="issuemoyr">Issue #138, October 2005</div></div><div><p>
Who says &ldquo;View Source&rdquo; on a Web page has to be a read-only
proposition? Re-mix your favorite Web sites by changing styles, adding and
removing elements, and more.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17a6580.0x189e348"></a></h2></div></div><p>
Here's a strange thing: hacking open source
isn't done only at midnight, in the spare room,
hunched over the protocol analyser, the breadboard,
source code control and some helpless device. No,
sometimes it's done inside a different crucible
entirely: a public world of shameless posturing and
self-promotion. A lurid and neon habitation of
signs, shops, styles and stuff populated by the
babble of conversations both informed and banal.
It's a place of great joy and great angst; a place
of towering conservatism and the last bastion of
the radical voice. Within it, a good hairdo or a
radically cut legline can get you as far as a
symbolic debugger, possibly even further. Devices
they may be, but of a different cut entirely from
those of hardware. Its denizens slip hyperactively
in and out of view like character actors with
coffee addictions and inspired agents. Of course, I
refer to the World Wide Web.
</p><p>
In this article, you learn how to code in a new
way, a way that's about changing media, not about
changing programs. To enter this nightclub and
experience the beat, you need the right gear, and
the right gear is Mozilla Firefox and GreaseMonkey.
Alfred Bester and William Gibson are waiting, so
ready your Mojo and prepare for cyberspace
insertion. But first, a bit of background.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17a6580.0x189e4a8"></a>
Web Pages as Open Source</h2></div></div><p>
We tend to forget that the Web is open source, in a way.
Some of the Web's infrastructure, browsers and servers, is
traditional open-source software, but the idea
also applies to Web page content.
Appropriation of code is an everyday occurrence.
Everyday, Web developers and designers use the View
Source browser feature to appropriate (industry
term: steal) code and design from other people's
pages. It was ever thus, and it remains so.
Ideas and code are shared freely and often; it's
an art design sensibility.
</p><p>
Most technical people have dabbled with Web
development, and dabbling is an easy way to have a
bad experience. The big three technologies&mdash;HTML,
CSS and JavaScript&mdash;were riddled with bugs for many
years after their inception. That's the experience
that probably looms large for early adopters who
first tried it out in the 1990s and walked away in
disgust. Cross-browser code? No, thank you.
</p><p>
Fortunately, matters have improved tremendously
as of late, and the Web is reviving as a technology
platform. Better standards support, more standards
support and the decline of hoary old misgivings, such as
Netscape Communication 4.x and Internet Explorer 5.0,
have left Web developers with a nearly clear shot
at real portability, a shot frustrated only by the
once shiny but now fairly rusty Internet Explorer.
In 2005, the buzz is about Modern DHTML, Layout
without Tables, Semantic Markup and Asynchronous
JavaScript and XML (AJAX). Client-side Web development
is coming back, and these are the things of which it's
made. This time, the Web is backed by professionals
with formal Web training and veterans with ten years
of experience. These people have their acts together,
and it's possible to say things about Web technology
that are no longer drowned out by the static of
incompatibility issues.
</p><p>
Supporting and colonizing this trend is the Mozilla
Firefox Web browser, and Mozilla technology in
general. Of course, Mozilla is fully open source,
as open as a religious movement can be, and so
there's plenty of room for experimentation. The
critical bit of Mozilla and Firefox is its
interpreted nature. On top of a big, bad, networked
C++ rendering engine is a thin skin of JavaScript
scripts and XUL, an XML dialect. This makes
Mozilla a distant cousin to Emacs or Tcl/Tk, as it
provides the whole Firefox user interface by way of
interpreted code. By writing an extension, you can
enhance this user interface and drop it in to
thousands of willing people's daily experience. Go
to <a href="http://update.mozilla.org" target="_self">update.mozilla.org</a> to see the endless
possibilities made real by this system. Every
variant hardware device requires Linux kernel driver
support; every variant human expectation about user
interfaces requires a Firefox extension. That's
a lot of extensions.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17a6580.0x189e710"></a>
Grabbing GreaseMonkey</h2></div></div><p>
GreaseMonkey is a Firefox extension (see the on-line Resources).
You have to click on the link twice, once to trust
www.mozdev.org and once afterward to install
the extension. GreaseMonkey differs from
the other extensions because it provides no
specific user-interface enhancements of its own
other than a configuration dialog box. Instead, it
creates a macro-like scripting environment into
which you put JavaScript scripts. Those scripts
operate on Web pages that you specify. When such a
page loads, your script goes to work on the page
content, no matter who provided it. You're
intercepting a content provider's content and
modifying it before it hits you. No wonder
GreaseMonkey's been called &ldquo;TiVo for the Web&rdquo;. I
wrote about page modification tactics in <span   class="emphasis"><em>Rapid
Application Development with Mozilla</em></span> (Prentice
Hall, 2004), but GreaseMonkey has moved that idea
into the mainstream by supporting traditional Web-scripting techniques and by packaging it all
up into a digestible product.
</p><p>
For all Firefox extensions, you must restart Firefox
completely to finish the install. Use File&rarr;Exit
to do that safely.
</p><p>
Bucket-loads of pre-existing GreaseMonkey scripts are available (see Resources).
Before you get too excited though, note that such
scripts are tied to one Firefox installation and
have no effect on any server. On a Linux or UNIX box, such
scripts might affect a large user population, but
they're primarily a personal thing. For those
readers switched on to people problems, the broader
implications should be obvious.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17a6580.0x189e978"></a>
Spotlight on LinuxJournal.com</h2></div></div><p>
To see all this at work, in this article I hack
the <i  >Linux Journal</i> Web site with GreaseMonkey. My
esteemed editor, Don Marti, even asked me to do this. A
brave man indeed. [<span   class="emphasis"><em>Maybe next time they'll invite
me to the Web site meeting.  &mdash;Ed.</em></span>]
</p><p>
Give me a hill and I'll climb it. First up is a bit
of scrutiny of the site due for surgery. Recall
it's <a href="http://www.linuxjournal.com" target="_self">www.linuxjournal.com</a>, if you're reading this
in print. This is also the fun part; personal
tastes differ, and for user-side drivers&mdash;which
effectively is what GreaseMonkey scripts are&mdash;it's
entirely valid and professional to be picky and
subjective. In Mozilla-land, dogfood means
testing your fixed bugs for technical correctness,
and catfood means testing your inventions
against unreliable and subjective people who might
spring in any direction. It's all catfood here, and
there's no right or wrong. After reading this
article, <i  >LJ</i>'s long-suffering site maintainer will
likely glare at me venomously or perhaps change
the site before this sees print. Design
sensibilities, you see. Sorry mate, they made me
do it. Hard-core engineers should look away; you
might find this analysis distressing. On to the
site.
</p><p>
Here's a handful of observations.
</p><div class="itemizedlist"><ul type="disc"><li><p>
The site icon, which appears in the location
bar and on the current tab if you use tabbed
browsing is dinky and uninspired. Oh well.
</p></li><li><p>
There's advertising everywhere.
</p></li><li><p>
<i  >Linux Journal</i>'s supposed to be the granddaddy
of technical journals in open source, excluding
academia and professional bodies. Where's that
indicated?
</p></li><li><p>
The headings are red. What's with red? I'm
not in a hurry.
</p></li></ul></div><p>
On the plus side&mdash;my survival as a critic is at
stake&mdash;the site has a robust three-column layout and is clean overall. Someone
knows their stuff. Viewing the source, the layout
is all done with CSS, so that's relatively modern;
many industry sites still pump out the worst HTML
you can imagine. The excessive use of &lt;DIV&gt; tags
shows that <i  >LJ</i> is halfway through modernisation;
there's still some Semantic Markup work to go, where
meaningful tags are used as content descriptors
instead of the meaningless &lt;DIV&gt;. That update might
improve the site's search engine performance or so
it's claimed.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17a6580.0x189f0b0"></a>
The Right Tool for the Right Job</h2></div></div><p>
Now, of the above personal observations, some are
simple to rectify and do not require GreaseMonkey.
If you dislike advertising, then the AdBlock
extension is for you; there's nothing, or at least
little, to code.
Similarly, for a long time, all browsers have
supported user-specified stylesheets. If you
install the ChromEdit extension, you can get at
that stylesheet without having to grovel through
the filesystem looking for it. Bring it up via
Tools&rarr;Edit User Files, click the
userContent.css tab and start typing. To make
headings blue, you might add:

<pre     class="programlisting">
h1.title a { color : blue !important; }

@-moz-document domain(linuxjournal.com) {
 h1.title a { color : blue !important; }
}
</pre>
</p><p>
The first rule applies to all Web sites;
the second is a Mozilla special that applies
only to the Web site specified. Browser-specific
is okay here, because we're working purely on and in
the client side.
</p><p>
You can get a lot done in these stylesheets,
especially if you know CSS well. You can hack the
page's layout to bits by reordering, hiding or
floating columns and other content. All of these options are
possible via GreaseMonkey as well, but GreaseMonkey
is better suited to bigger stuff. In other words, don't go
to GreaseMonkey if page changes are easily
solved with a stylesheet; it's overkill.
</p><p>
For this article, we'll make one simple
change. We'll bring some gravitas to the
site by replacing some content with fancy
calligraphy drawn from another site.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17a6580.0x189f318"></a>
Illuminated Drop-Caps for Paragraphs</h2></div></div><p>
The CSS :first-letter pseudo-selector lets you take
an ordinary paragraph of text and make the first
letter big, so that several lines of text flow
around it. It's a self-important feature and what
we're looking for. We simply could apply that
feature, but most computers don't have fancy
Medieval fonts installed. And, a big Times Roman letter
F isn't that exciting. It would be better if
we could get the LinuxJournal.com Web site properly
illuminated, like the <span   class="emphasis"><em>Book of Kells</em></span>,
with extra fancy calligraphy.
</p><p>
Here are a couple of screenshots showing the before
and after looks, taken on Windows XP Professional. This is a
timely reminder that the user experience is what's important
here. It also emphasizes that
open source means cross-platform when stated in
Mozilla terms. Everything described in this
article works identically on Windows, Macintosh,
Linux and various obscure Mozilla platforms, such as
Solaris.
</p><div       class="mediaobject"><a href="8215f1.large.jpg"><img src="8215f1.jpg"></a><div class="caption"><p>
Figure 1. A Regular Linux Site
</p></div></div><div       class="mediaobject"><a href="8215f2.large.jpg"><img src="8215f2.jpg"></a><div class="caption"><p>
Figure 2. That's better. We didn't need
monks to illuminate this manuscript, simply a GreaseMonkey script.
</p></div></div><p>
In the second screenshot, you can see that the
first letter of each paragraph has been replaced with
a fancy illuminated letter. Because I don't have
access to the back end of the <i  >LJ</i> Web site, that's
something of a feat. In fact, these images come
from the Australian National University's Medieval
Studies image server.
</p><p>
I've used the thumbnail images only. It's a bit
naughty to serve up some other Web site's images,
and these images aren't perfectly cropped,
registered scans, but for the purposes of, well,
illustrating a technique, they'll do. Let's hope
some parsiminous old sod doesn't take them down by
the time you read this.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17a6580.0x189f948"></a>
Spinning up the Script</h2></div></div><p>
To make this embellishment work, you need a
GreaseMonkey JavaScript script. To make such a
script, proceed as though this was any other Web page project.
I saved to local disk the <i  >LJ</i> home page and
then added this to the end of the &lt;head&gt; section:

<pre     class="programlisting">

&lt;script src="illuminate.js&gt;&lt;/script&gt;

</pre>
</p><p>
Now I'm free to develop that script in pure
Mozilla JavaScript, with no cross-browser
constraints, because GreaseMonkey works only on
Firefox. Let me tell you, it's real 200%-proof
pleasure to charge forward in JavaScript
without once having to trip over document.all
or other MSIE abberations. More than that, there's
a bit of now-established rigor we can bring to
the code. Here's a skeleton of the job
at hand, in the shape of a JS object signature,
which is the bit of syntactic dogma that I like
to propagate:

<pre     class="programlisting">
var illuminate = {
  caps : { ... },
  load : function () { ... },
  image : function (text) { ... },
  mask : function () { ... },
  insert : function () { ... },
  getElements : function (node) { ... },
  getElementsRecursive : function (l, n) { ... },
};
</pre>
</p><p>
There's no static typing and barely any forward
declarations in JavaScript, so there's nowhere to
declare an object. Instead, we work with an object
literal. This approach creates a packaged set of
functionalities that expose only the illuminate option to the
page's namespace. So it's both a reuse strategy and
a namespace non-pollution strategy. All the methods
of the object are expressed as anonymous functions,
and caps is a sub-object in which we put data.
Anonymous functions also save you from forcing a
function name into the page's namespace. That's
a vast improvement on early scripting techniques.
</p><p>
Once defined, this object does nothing. You need
a line such as this to make it go:

<pre     class="programlisting">
window.onload = function () { illuminate.load(); }
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17a6580.0x189fcb8"></a></h2></div></div><p>
That causes the load() method to run when the page
is finished loading. The anonymous function that
wraps it provides an extra scope that makes
illuminate the current object. Done that way, the
reference points to the illuminate object,
which means this can be exploited from inside
the methods of the object. That saves the object
from ever having to use the illuminate variable
name&mdash;more namespace non-pollution.
</p><p>
Listing 1 shows this object fully implemented, so
let's go through it. You also can grab the complete
script from the <i  >Linux Journal</i> FTP site.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17a6580.0x1c980c0"></a></h2></div></div><div class="sidebar"><p class="title"><b>Listing 1. Illuminating the Current Object
</b></p><pre     class="programlisting">

var illuminate = {
    caps : {
    		"a" : "102.PNG", "b" : "103.PNG",
    		"c" : "104.PNG", "d" : "105.PNG",
    		"e" : "106.PNG", "f" : "107.PNG",
    		"g" : "108.PNG", "h" : "109.PNG",
    		"i" : "110.PNG", "j" : null,
    		"k" : "111.PNG", "l" : "112.PNG",
    		"m" : "113.PNG", "n" : "114.PNG",
    		"o" : "115.PNG", "p" : "116.PNG",
    		"q" : "117.PNG", "r" : "118.PNG",
    		"s" : "119.PNG", "t" : "120.PNG",
    		"u" : null,
    		"v" : "121.PNG",
    		"w" : null,
    		"x" : "122.PNG",
    		"y" : null,
    		"z" : "123.PNG"
    },

    load : function () {
      this.mask();
      this.insert();
    },

    image : function(text) {
      var a = text.substring(0,1).toLowerCase();
      var link = "";
      if (a &amp;&amp; this.caps[a]) {
        link = 'http://rubens.anu.edu.au/htdocs/' +
	       'bytype/prints/ornament/0001/' +
      	        this.caps[a];
      }
      return link;
    },

    mask : function () {
      var head = document.getElementsByTagName(
      			'head')[0];
      var rules = document.createElement('style');
      var text = document.createTextNode(
      	'div.node &gt; div.content &gt; img[ill] : ' +
	'{ display: inline; float:left; }\n' +

      	'div.node &gt; div.links : ' +
	'{ clear : left; }\n' +

      	'img[ill] : { display : none; }\n'
      );
      rules.appendChild(text);
      head.appendChild(rules);
    },

    insert : function () {
      var list = this.getElements(window.document);
      var img;
      var text;
      for (var i=0; i&lt;list.length; i++) {
	text = list[i].firstChild;
	if (text.nodeType == 3 ) {
	  img = document.createElement('img');
	  img.setAttribute('ill','true');
	  img.setAttribute('width','64px');
	  img.setAttribute('height','64px');
	  img.setAttribute('src',
		this.image(text.nodeValue));
	  text.nodeValue =
	  	text.nodeValue.substring(1);
	  list[i].insertBefore(img, text);
	}
      }
    },

    getElements : function (node) {
      var rv = [];
      this.getElementsRecursive(rv, node);
      return rv;
    },

    getElementsRecursive : function (list, node) {
      for (var i=node.childNodes.length-1;i&gt;=0;i--)
      {
        var child = node.childNodes.item(i);
        var klass = null;
        if ( child.nodeType == 1) {
          klass = child.getAttribute("class");
          if ( klass &amp;&amp; klass == "content") {
            list.push(child);
          }
          this.getElementsRecursive(list, child);
      }
    }
  }
}

</pre></div><p>
The caps associative array points to the
individual letters available at the ANU Web site.
Because they're from Medieval times, new-fangled
letters such as J, U, W and Y are nowhere in sight.
We simply have to do without those for now and
also resist the urge to use I for J biblically.
The alphabet's constantly changing, albeit slowly,
anyway. The way I hear it, if radio is a true
reflection of the street argot, Double-u is next to
undergo change. Evidently it's being replaced with
an identical letter named Dub, as in: &ldquo;Go to Dub
Dub Dub dot sell you something dot com&rdquo;. Think what
you will of that despicable trend. But I digress.
</p><p>
The load() method does all the work. It calls
mask(), which inserts a &lt;style&gt; tag as the last
thing in the head of the current page. Careful
study of the neatly designed <i  >LJ</i> home page lets one
create styles that fit like extra jigsaw pieces
in the existing layout regime. This first style
acts on the new illuminated letters, allowing text
to flow around them:

<pre     class="programlisting">
div.node &gt; div.content &gt; img[ill]
	{ display : inline; float : left; }
</pre>
</p><p>
This next style stops the float effect so that
the next news item doesn't flow around it as well:

<pre     class="programlisting">
div.node &gt; div.links { clear : left; }
</pre>
</p><p>
That's all standard CSS2 stuff. Finally, the rest
of the JavaScript code is a bit over-enthusiastic
in its page hacks, as you will see. So, here's a style
to shut up the accidental extras:

<pre     class="programlisting">
img[ill] : { display : none; }
</pre>
</p><p>
In all cases, the ill bit is simply a custom tag
attribute added to identify the images specific to
this script, so that they can be picked out easily
with a style rule.
</p><p>
The second thing that the load() method does is
call the insert() method, which adds &lt;img&gt; tags to
the main content of the page. To those who
dabble only in client-side scripting, perhaps an onclick
handler or two, this looks fairly formidable, but
it's pretty routine stuff for quality client-side
scripting.
</p><p>
The insert() method acquires a list of important
nodes in the page using the now robustly supported
DOM APIs. It then uses a loop to run through that
list, adding an &lt;img&gt; tag of this kind:

<pre     class="programlisting">

&lt;img ill="true" width="64px" height="64px" src=""&gt;

</pre>
</p><p>
This is added to every node found that has a Text
node as its first child. That amounts to adding a
new child node to any &lt;div class=&ldquo;content&rdquo;&gt; tag
that's immediately inside a &lt;div class=&ldquo;node&rdquo;&gt; tag.
That's a big assumption about the page's structure.
Also, there are many unwanted examples of that
combination, for instance, in the advertising column
on the right and in miscellaneous content outside
the list of articles. That's why I had to shut up
some images with an extra style&mdash;too many are
inserted. It keeps the code simple to use a broad
brush, though.
</p><p>
While developing this, I also noticed that on one
instance of the home page, someone had added extra
&lt;p&gt; tags to the deck of one article. The deck is
the lead-in remarks that draw the reader to the
full article content. That's a simple typo or
random act of innovation on some editor's part. For
that one article, displayed in a layout marginally
different to the rest, the script failed to do
anything. At least that's better than generating an
error or an exception and halting. It does go
to show, though, how fragile GreaseMonkey scripts can be if
one's not circumspect enough and has ignored the
matter of graceful degradation, in which scripts
melt away to NO-OPs if things go pear-shaped.
Any assumptions made about the page's
expected structure should be as general and as
flexible as possible. Tread lightly.
</p><p>
Back in the code, insert() also uses standard
JavaScript string operations to chop the first
character off the deck's text. So that's one plain
textual character gone, one image of a character
added. Between the Web and Unicode, saying the word
character without caution is to flush out in a
trice all the lexicographical pedants lurking in
the woodwork. Let them come, I say.
</p><p>
The rest of the object is some routine processing
leveraged by the insert() method. The image()
function is the easier utility: it merely performs
a dictionary look-up on the caps object, which is
effectively an associative array. JavaScript allows
literal strings to be used as array indices and
object member names. The retrieved file name is
concatenated into a full URL and returned. It's
simple data-driven programming.
</p><p>
The other utility is the remaining two methods,
getElements() and getElementsRecursive(). They
implement a standard prefix tree-walking algorithm
that acts on the whole DOM of the page and that is
wrapped up in the neater facade of getElements().
They are page-scanning routines and not overly
general as there are logic tests inside specific to
<i  >Linux Journal</i> content. Someone should
write a set of qsort(3)-like navigation routines so
one simply can plug in a comparator functor or two.
Probably that's already been done, but I haven't
tracked down such a thing for this article.
</p><p>
As the DOM tree is walked, any &lt;div
class=&ldquo;content&rdquo;&gt; nodes are appended to the list of
discovered nodes. There's no copying at work; it's
all nodes by reference. Walking a whole DOM tree
is a bit ambitious. For more focused
GreaseMonkey hacks, it's more efficient to go
straight to the page element at issue, perhaps with
a document.getElementById() call. When you're not
sure about the exact structure of the page, though,
it's better to grope blindly through all the
content with a minimum of assumptions. How
directly you proceed simply depends on what kind of
leverage you're looking for.
</p><p>
Now that the script is developed, all that needs
to be done is to configure it into the GreaseMonkey
extension. Recall that so far it has been developed
on a static and locally held test page. That
configuration task is, to be frank, a bit weird,
at least at GreaseMonkey 0.3.3.
</p><p>
To get it in place, make sure the script is
named illuminate.user.js. Next, using Firefox
with GreaseMonkey installed, navigate to the local
directory where the script is. On Linux that
is something like:

<pre     class="programlisting">
file:///home/nrm/
</pre>
</p><p>
On Windows it may start with:

<pre     class="programlisting">
file:///C|/Documents%20and%20Settings/nrm/Desktop/
</pre>
</p><p>
Notice the three forward slashes. The file
URI scheme is similar to NFS or SMB and, in theory,
can retrieve files located anywhere, for example:

<pre     class="programlisting">
file://www.example.com/something.txt
</pre>
</p><p>
Omit a domain and the default is localhost,
which generally is what you want.
</p><p>
Once that directory listing appears, you should see
a link for the illuminate.user.js file. Right-click
on it (context-click on Mac OS X), and the magic
option is revealed: &ldquo;Install User Script ...&rdquo;. Pick
that, because no amount of fiddling with the
GreaseMonkey options on the Tools menu can bring
you equal joy. The GreaseMonkey configuration
dialog box appears next, with the new script lodged
on the left. Click Add on the right, and type in the
<i  >Linux Journal</i> URL, like so:

<pre     class="programlisting">
http://www.linuxjournal.com/*
</pre>
</p><p>
Click OK and the script's installed. Now it can be
reached via the Tools menu for subsequent
administration. Reload the <i  >LJ</i> page and everything
should work, with illuminated capitals in place.
If not, it's time to open the JavaScript Console and
go back to script debugging, testing with 1.0.4
and GreaseMonkey 0.3.3.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17a6580.0x1c98e28"></a>
Illumination Post Mortem</h2></div></div><p>
The tale of illuminated capitals thus is told, and
it's a tale of content aggregation. Of course,
this is but a trivial example. You're not
restricted to patching-in a single, grubby &lt;img&gt;
tag, nor must you be so sanguine about the existing
page content. GreaseMonkey scripts can hack the
page content to bits, and you can stick any amount
of extra content into the page, from any source.
The redoubtable XMLHttpRequest object is available
to such scripts, and it can be used to load any
content in the world that's accessible by HTTP&mdash;
content that then can be put in the current page.
You also can send bits of the current page
elsewhere with this object, but that's another
article. Here I've attempted a graceful addition
to the page.
</p><p>
Now you might say, &ldquo;this is an exercise in folly, no
one will see my work but me.&rdquo; That, however, simply is
a distribution problem, one solvable by many
different IT deployment techniques, not the least
of which is hypertext links.
</p><p>
Such enhancements are not so silly either. Imagine
the Web interface to your favourite network device,
perhaps a router. Wouldn't it be nice if the host
status lights from the open-source and Web-enabled
Big Brother LAN-monitoring application appeared
next to the IP addresses of the matching hosts in
the filtering rules in the Web pages served up by
that router? At least then you wouldn't be trying
to fix a route for a box that's not even running in
the first place. You'd see a big red light next to
the entry in the router's configuration pages.
GreaseMonkey is exactly the right tool for such problems,
especially since no one has access to the source
pages generated by the router's embedded Web
server.
</p><p>
Furthermore, many Web pages are busy places,
full of navigation widgets and data entry fields.
GreaseMonkey scripts can hack all that to bits,
removing or adding elements to the page that
streamline the user's individual surfing
behaviour. Don't like that menu bar at the top?
Hide it. Can't remember how to fill in that form?
Add some reminder text that floats above it.
You get the idea.
</p><p>
Finally, because GreaseMonkey is content-based,
analogies with other content media are worth
considering. If there are hit records and hit movies,
then a hit GreaseMonkey script no doubt will
emerge in time. What political orientation it has
with respect to the Web site it hacks will set a
very interesting precedent. Will it be a script
that protests, deconstructs, graffitis, supports
or censures the site in question? Only time will
tell. In the meantime, GreaseMonkey is a handy
tool for Web content that's otherwise difficult
to change.
</p><p><span   class="bold"><b>Resources for this article:</b></span>
<a href="../138/8458.html" target="_self">/article/8458</a>.
</p></div></div>
<div class="authorblurb"><p>
Nigel McFarlane (<a href="http://www.nigelmcfarlane.com" target="_self">www.nigelmcfarlane.com</a>) is
the Mozilla community's regular and irregular technical commentator
focused on education, analysis and a few narrowly scoped bugs. Nigel
is the author of <span   class="emphasis"><em>Firefox Hacks</em></span> (O'Reilly Media)
and <span   class="emphasis"><em>Rapid Application Development With Mozilla</em></span>
(Prentice Hall PTR).
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../138/toc138.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>