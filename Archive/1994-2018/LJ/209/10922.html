<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Qt4 Designer and Eclipse
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;You don't have to be a code guru to develop GUIs.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x26c7580.0x27beac0"></a>
Qt4 Designer and Eclipse
</h1></div><div><div class="author"><h3 class="author">
PJ
 
Radcliffe
</h3></div><div class="issuemoyr">Issue #209, September 2011</div></div><div><p>
You don't have to be a code guru to develop GUIs.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x27bf250"></a></h2></div></div><p>
Qt4 Designer is one of the most powerful GUI builders on the market.
If you look at the many Qt4 Designer tutorials, they are all very
code-heavy, which really puts off new programmers. After some searching, I
put together a few simple methods that make GUI development easy,
even for novice C++ programmers, and for experts, it will speed up
development.
</p><p>
This article shows how to use a GUI builder based on Qt4 Designer
and Eclipse. Unlike other tutorials, this one is not code-heavy; instead,
it describes several simple methods that will enable you to develop a
GUI in a visual manner with a minimum of C++ code. If you are new to C++
and GUI building, this tutorial will make it possible for you to
build a GUI. If you are an expert, these methods at least will help
speed your development. The development tools must run under the KDE
desktop, although the final program can be run on a GNOME desktop as well.
</p><p>
GUI interfaces are a key part of most operating systems, and with Linux,
we are spoiled for choice. So many good tools are available;
see the Wikipedia IDE comparison in the Resources section of this article
for an excellent summary. I teach some 300 first- and second-year engineers about
Linux programming including GUI programming. They need to use C++, and
the options tend to be narrow. The two IDEs that look most applicable
are Code Blocks and the combination of Eclipse CDT and Qt4 Designer.
Qt4 Designer clearly is the most powerful GUI builder with the best
documentation, and it's free if you are creating GPL or LGPL code.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x27bf510"></a>
Installing the Software</h2></div></div><p>
The simplest option is to obtain a live DVD with all the necessary
tools installed. See <a href="http://interestingbytes.wordpress.com" target="_self">interestingbytes.wordpress.com</a> for a Mint-based live DVD with these tools plus many other development tools.
</p><p>
To install the software yourself, work through the following steps:
</p><p>
First, ensure you have the gcc compiler toolchain
installed. From a command line, type <tt  >g++ --version</tt>.
If this fails,
use your package manager to install gcc, g++ and libstdc.
</p><p>
Next, you need the GUI builder Qt4 Designer and the documentation
system Qt4 Assistant. You can find them in your Linux repository and
install them with your package manager. In the unlikely event that Qt4 is
not available, try the Nokia Qt download site (see Resources).
</p><p>
You also need Eclipse with CDT (C/C++ Development Tools) installed. There
are several options here:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Install Eclipse CDT from your package manager (easiest option).
</p></li><li><p>
If you already have Eclipse installed but not the C/C++ development
tools, start Eclipse and select the menu option Help&rarr;Install New
software. Select your main repository site and filter on
&ldquo;CDT&rdquo;.
Select the CDT package and install.
</p></li><li><p>
The latest version of Eclipse at the time of this writing is Helios, which may not be in your
distribution's repository. It has a nice all-in-one package of Linux
Tools that includes code coverage and profiling. The Eclipse Helios
site has a download and installation instructions (see Resources).
Note the wiki
link from that page, which has some very useful tutorials.
</p></li></ul></div><p>
Finally, you need the Qt4 integration plugins for Eclipse. The
Nokia Web site has instructions and the download (see Resources).
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x27bfb40"></a>
Creating a GUI Project</h2></div></div><p>
Most Qt4 tutorials show how to write code to build a form.
The combination of Qt4 Designer and Eclipse means you can do this in
a purely visual manner, which is faster and easier. To build your own
GUI, work through the following steps:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Start Eclipse using the Linux Menu option
Development&rarr;Eclipse. If any projects are open, select the Project
Explorer in the left-hand panel, right-click on the project
folder, then select Close Project.
</p></li><li><p>
From the Eclipse menu, select File&rarr;New&rarr;Project.
</p></li><li><p>
Find the Qt option, select the sub-option Qt GUI project, and then
click Next.
</p></li><li><p>
On the next panel, provide a project name (let's use demo_1 for this
example), and click
Next (not Finish).
</p></li><li><p>
The next panel will set up the class and filenames. You can
change the name of the class where you place your code. The bottom
list box labeled UI Type is the most important field. It
determines the type of GUI you will create. A Widget is a basic panel
with no special functions; a Qdialog provides simple interaction with a
user, and a QmainWindow is a panel with menus and other features. For this
example, select QmainWindow, then click Next.
</p></li><li><p>
This panel allows you to include extra Qt modules&mdash;for example, a
network interface or SQL interface. For this example, the extra modules
aren't needed, so just click Finish.
</p></li><li><p>
You will be asked to accept Qt perspectives; click yes.
</p></li></ul></div><p>
You now should have a GUI project ready to add visual components.
To see the appropriate files, as shown in Figure 1, expand the project in the
Project Explorer panel to the left and double-click on demo_1.ui.
</p><div       class="mediaobject"><a href="10922f1.large.jpg"><img src="10922f1.jpg"></a><div class="caption"><p>
Figure 1. Empty Main Page
</p></div></div><p>
The compile and execution of the GUI you have just created may have a hiccup,
especially the first time you run it. You should be able to select
from the Eclipse menu File&rarr;Save All, Project&rarr;Build All, and then
Run&rarr;Run.
If Run&rarr;Run is grayed-out, try the following:
</p><div class="itemizedlist"><ul type="disc"><li><p>
If demo_1.cpp is not already in the editor window, then in the Project
Explorer panel on the left, double-click demo_1.cpp to get the code in
the editor window.
</p></li><li><p>
Add a space anywhere, and then from the Eclipse menu, select File&rarr;Save
All.
</p></li><li><p>
Select Project&rarr;Build All, then Run&rarr;Run. If you are asked for a
debugger configuration, choose gdb/mi.
</p></li><li><p>
Your GUI now should appear. Close it by clicking the close icon on the
top right.
</p></li></ul></div><p>
Now, it's time to add visual components to your bare form. On the
left-hand panel, select the Qt tab to see the visual components. Click and
drag across two Push Buttons, an LCD Number, a Text Edit box, a Horizontal
Slider and a Progress Bar to get a form similar to Figure 2.
</p><div       class="mediaobject"><a href="10922f2.large.jpg"><img src="10922f2.jpg"></a><div class="caption"><p>
Figure 2. Visual Components
</p></div></div><p>
You can see the properties of any visual component by clicking on a
component and then examining the property editor in the right-hand
panel. The properties are shown as a hierarchy with the parent class
first and then the child classes. You may need to scroll down to find the
property you want to change. In Figure 2, a button has been selected and
the property editor shows its properties. The property called
&ldquo;text&rdquo;
has been changed to MyButton, which is not the name of the button,
just the message displayed. It's worth spending some time looking at all
the properties you can alter. Try also right-clicking on visual
components to see what you can change. For example, right-click on the
text edit box and select Change HTML. Type in some text, click OK,
and that text is now displayed in the text edit box.
</p><p>
To create a menu for your form, click at the top left where it says &ldquo;Type
Here&rdquo;, and type &ldquo;File&rdquo;. Your form now has a menu option
&ldquo;File&rdquo;.
</p><p>
Click on this again, and add a sub-option &ldquo;Save&rdquo;. After finishing
this tutorial, it's worth starting a new project and playing with a
range of visual components, right-clicking on each and changing the
properties.
</p><p>
Qt Designer has the concept of signals and slots. A class can emit a signal
when it has done something&mdash;for example, when a button is clicked. A
class can accept a signal in a slot&mdash;for example, the LCD display has a
slot to accept a new value. You can connect visual components directly
together using signals. From the Eclipse menu, select Qt Designer&rarr;Editor
Mode&rarr;Signals and Slots. Click on the slider, drag the resulting red
line to the progress bar, and release the mouse. In the panel that pops
up, select sliderMoved in the left box and setValue in the right box,
then click OK. It's important to know this edit mode, because it's a quick
way to discover all the signals and slots a visual component can support.
To see what signals a button can generate, drag the mouse from the button
to the form and release the mouse. A window now pops up that names all
the signals a push button can emit. Close this window by pressing cancel
to delete the link. Now, try dragging from the form to the button to
see all the slots the button can support. Try doing the same to the
LCD display (see Resources for more details on slots and signals).
</p><div       class="mediaobject"><img src="10922f3.jpg"><div class="caption"><p>
Figure 3. Wired Signal
</p></div></div><p>
To run your GUI, first change the editor mode back to the normal widget
view with Qt Designer&rarr;Editor Mode&rarr;Widgets. Then, compile and run using
the Eclipse menu options File&rarr;Save All, Project&rarr;Build Project and
Run&rarr;Run. If all goes well, you should get a result like what's shown
in Figure 4.
Try moving the slider, clicking on the buttons (which do nothing),
and then close the window.
</p><div       class="mediaobject"><img src="10922f4.jpg"><div class="caption"><p>
Figure 4. First Run
</p></div></div><p>
I don't have space to cover layout tools and spacers, which ensure that your layout
expands and contracts as a user resizes the GUI window. See the large
e-book from Blanchette and Summerfield, the short Layout Tutorial and the
Qt Overview listed in the Resources section for more information. Qt
Assistant, discussed later in this article, also has an
excellent tutorial.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x2bb92e0"></a>
Adding Your Own Code</h2></div></div><p>
Other Qt4 tutorials become code-heavy at this point and lose people who
are not experienced C++ programmers. Here, I explain how to link
your code to the GUI interface in a simple and pain-free manner with
minimal C++.
</p><p>
Adding code to a GUI project is not like writing
code for a command-line program. Your code must be placed in the class created for you,
in the example demo_1.cpp, not a main() routine. You should alter
only demo_1.cpp, demo_1.h or demo_1.ui. The other files are generated
automatically and will be overwritten on the next build.
</p><p>
Your code can be started only when a GUI event happens and it is linked
to your code, or when a timer you have created times out. Furthermore,
your code must do its job quickly and return. If your code delays, 
the entire application freezes and stops responding to user stimuli.
These factors require you to design your code differently from how you
would design a command-line program. When you write a GUI program, plan
for all of your code to respond to GUI events and timers. The GUI package
handles the rest for you.
</p><p>
Most GUI systems have a library of useful classes, and it's very much worth
learning how to use those classes, as they can save you a lot of time and
provide features you could not implement otherwise. The library with Qt
Designer is particularly powerful and worth mastering (more on that later).
</p><p>
Now, let's add the links between your own code and the visual components.
Click the demo_1.h tab, and add the single #include line at the top of
Listing 1. Next, add the declaration for timer, the public slots section
and functions that are called when signals are generated. These slots are
all of the form <tt  >on_objectName_action()</tt>. The available
&ldquo;action&rdquo; can
be discovered from what you did to create Figure 3. The first two slots
are called when the buttons are clicked, the next when the form's menu
item Save is selected, and the final one when your own timer based on
Qtimer ticks. In total, you must add seven lines of code to the existing file.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x2bb9650"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Listing 1. Adding Slots to demo_1.h</b></p><pre     class="programlisting">

#include &lt;QtGui&gt;
public:
    demo_1(QWidget *parent = 0);
    ~demo_1();

private:
    Ui::demo_1Class ui;

//--- add the following lines.
    QTimer timer ; 

public slots:                   
 void on_pushButton_clicked();     
 void on_pushButton_2_clicked();   
 void on_actionSave_triggered() ;  
 void timer_tick() ;             
};

</pre></div><p>
Now, you can link the timer to the LCD display. In the demo_1.cpp file,
modify the constructor to add the three lines of timer setup, as shown in Listing 2.
First, the timer is created, and then the timer tick signal is
connected to your own routine <tt  >timer_tick()</tt>. Finally, the timer is set up
to tick at 1,000 milliseconds (one second).

</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x2bb9968"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Listing 2. Constructor with Timer Start</b></p><pre     class="programlisting">
demo_1::demo_1(QWidget *parent)
    : QMainWindow(parent)
{  ui.setupUi(this);
 //--- add the following lines.
   timer = new QTimer(this);
   connect(timer, SIGNAL(timeout()), this, SLOT(timer_tick()));
   timer-&gt;start(1000);
}
</pre></div><p>
Listing 3 shows the code to react to the first push button.
You need to add all the lines, as this member function is new. The
first two lines of code change the text in the button and the font type.
The next few lines change the color. This is well beyond what a simple
application will need to do, but it shows a little more of what is possible.

</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x2bb9c28"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Listing 3. First Push Button Code</b></p><pre     class="programlisting">
void demo_1::on_pushButton_clicked()
{ //--- comment out or remove whatever is not needed.
	ui.pushButton-&gt;setText("New Name") ;
	ui.pushButton-&gt;setFont(QFont("Courier",10,QFont::Bold));
	QPalette palette;
	palette.setColor(ui.pushButton-&gt;backgroundRole(), Qt::red);
	palette.setColor(ui.pushButton-&gt;foregroundRole(),Qt::blue);
	ui.pushButton-&gt;setPalette(palette);
}
</pre></div><p>
Note that the properties of any visual component can be changed using
the format <tt  >ui.ComponentName-&gt;member_function()</tt>. As you begin to write
more complex applications, you will need to find these member functions.
The simplest way is to start a separate application called Qt Assistant,
by going to Development&rarr;Qt4 Assistant from the Linux menu. As shown in
Figure 5, click the Index tab and enter the name of the visual element.
A detailed description of the element will be displayed, including all
useful member functions. If you are serious about mastering Qt Designer,
it's worth spending some time working through the Qt Assistant
documents. In particular, click the Contents tab, and open the Qt
Designer Manual, which includes a wealth of useful tutorials
and examples.
</p><div       class="mediaobject"><a href="10922f5.large.jpg"><img src="10922f5.jpg"></a><div class="caption"><p>
Figure 5. Qt Assistant
</p></div></div><p>
The second push button also must have its member function created 
(Listing 4). Again, the code shown here is more complex
than a simple application needs to be, but it shows a very useful feature:
calling a command-line program.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x2bba0f8"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Listing 4. Second Push Button</b></p><pre     class="programlisting">
void demo_1::on_pushButton_2_clicked()
{  ui.textEdit-&gt;clear() ;
   QByteArray command_line, work_dir("/tmp"), result ;
   command_line = "ls /home" ;
   result="Nothing happened." ;
   QProcess shell(this) ;
   shell.setWorkingDirectory( work_dir) ;
   shell.start(command_line) ;
   if ( shell.waitForFinished(300)) //ms timeout
      result =  shell.readAllStandardOutput() ;
   ui.textEdit-&gt;append(result) ;
}
</pre></div><p>
Let's work through the code. Note how the text box on-screen is cleared.
The <tt  >ui.textEdit</tt> gives you access to the visual component,
and the member
function <tt  >clear()</tt> is called.
<tt  >QbyteArray</tt> is an advanced C++ string type
object. The <tt  >QProcess</tt> object enables you to run a
command-line program.
First, the working directory is set, and then the command started. If it
returns within 300 milliseconds, the result is written into the textEdit
box; otherwise, the command is terminated, and the default error message
is printed. Note that the returned text from the command line may have
nonprinting characters, such as line feeds. To solve this problem, look
up the QbyteArray member function simplified() in Qt Assistant.
</p><p>
To respond to the menu on the window, add:


<pre     class="programlisting">
void demo_1::on_actionSave_triggered()
{ ui.textEdit-&gt;clear() ;
  ui.textEdit-&gt;append("Menu item Save just triggered.") ;
}
</pre>
</p><p>
To increment the LCD display every second, add:


<pre     class="programlisting">
void demo_1::timer_tick()
{ ui.lcdNumber-&gt;display( ui.lcdNumber-&gt;intValue() + 1) ;
}
</pre>
</p><p>
Now, let's run your program. From the Eclipse menu, go to File&rarr;Save All,
Project&rarr;Build Project and, finally, Run&rarr;Run. The LCD timer should be
incrementing every second. Try clicking on the buttons and the form menu to make sure they
perform as expected. 
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x2bba728"></a>
What Next?</h2></div></div><p>
What happens next is up to you. If you have trouble creating the example
described here,
you can download all of it from <a href="http://www.pjradcliffe.wordpress.com" target="_self">www.pjradcliffe.wordpress.com</a>, then click on
the &ldquo;Other Useful Resources&rdquo; page. Place the new directory inside
the workspace directory (/home/user/workspace), then start Eclipse.
</p><p>
Browsing through Qt Assistant is a good way to discover the useful
member functions of visual components and the other powerful classes,
such as QbyteArray. Qt Assistant has many tutorials and examples, and
the Web is a great source of information, as Qt has a vibrant
user community. It won't take you long
to make those visual components perform just as you wish.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x2bba938"></a>
Conclusion</h2></div></div><p>
After reading this article, you should be able to create a GUI using
Eclipse and Qt4 Designer, mostly by visual manipulation of visual
components plus a little C++ code. The example given here shows how
to call your own code when visual components are activated (as with a
button click), how to start your own code with a timer tick, and how to
call command-line programs and read back their responses. You can do a lot
with just those functions.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x26c7580.0x2bbaa40"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
Wikipedia Article on IDE Comparison:
<a href="http://en.wikipedia.org/wiki/Comparison_of_integrated_development_environments" target="_self">en.wikipedia.org/wiki/Comparison_of_integrated_development_environments</a>.
</p><p>
Qt4 download site from Nokia: <a href="http://qt.nokia.com/downloads" target="_self">qt.nokia.com/downloads</a>.
</p><p>
Helios Eclipse Linux tools download and install instructions:
<a href="http://www.eclipse.org/linuxtools" target="_self">www.eclipse.org/linuxtools</a>.
</p><p>
Qt4 integration for Eclipse:
<a href="http://qt.nokia.com/developer/eclipse-integration" target="_self">qt.nokia.com/developer/eclipse-integration</a>.
</p><p>
Good designer information (see the &ldquo;signals and slots&rdquo; link in
particular): <a href="http://doc.qt.nokia.com/4.6/designer-manual.html" target="_self">doc.qt.nokia.com/4.6/designer-manual.html</a>.
</p><p>
A 700-page reference for Qt Designer from Blanchette and Summerfield
(definitely worth obtaining although many examples take a code-heavy
approach): search for
&ldquo;c-gui-programming-with-qt-4-2ndedition.pdf&rdquo; to find a convenient upload source.
</p><p>
Layout basics: <a href="http://thelins.se/learnqt/2009/05/qt-layouts-the-basics" target="_self">thelins.se/learnqt/2009/05/qt-layouts-the-basics</a>.
</p><p>
Good overview of key Qt4 visual design features:
<a href="http://web.mit.edu/qt-dynamic/www/qt4-designer.html" target="_self">web.mit.edu/qt-dynamic/www/qt4-designer.html</a>.
</p></div></div></div>
<div class="authorblurb"><p>
Dr PJ Radcliffe is a senior lecturer at RMIT University in Australia. He
once was an ardent Windows programmer, but then he discovered Linux, which
he now teaches along with the control of hardware using Linux. If you
are interested in these topics, see <a href="http://www.pjradcliffe.wordpress.com" target="_self">www.pjradcliffe.wordpress.com</a>.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../209/toc209.html">Issue Table of Contents</a>
    <a class="link3" href="../209/10922.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>