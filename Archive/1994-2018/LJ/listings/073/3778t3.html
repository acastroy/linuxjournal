<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>LJ 73: The Network Block Device
</title>
</head>
<body bgcolor="#FFFFFF" text="000000">
<!-- yahoo bar begins -->
<font size="2" face="verdana, arial, helvetica, sans-serif" color="#000000">
<A HREF"=/index.html" target=_top>Home</A> &nbsp;&gt;&nbsp; 
<A HREF="../index.html">Magazine</A> &nbsp;&gt;&nbsp; 
<A HREF="index.html">#73 May 2000</A> &nbsp;&gt;&nbsp; 
<A HREF="3778.html">The Network Block Device</A> &nbsp;&gt;&nbsp;
<b>
Table 3: NBD Data Protocol Per Thread, Per Type of Data Request
</b>
<BR><b>Monday, March 20, 2000 | Last Updated 04:56:07 PM</b>
</font><p>
<!-- yahoo bar ends -->
<!-- BEGIN banner ad -->
<CENTER><BR>
<img alt="&nbsp;&nbsp;" src="/images/redblock.gif" width="9" height="60" border="0"><!--#include virtual="/cgi-bin/banner-random.pl?dimensions=Large&width=468&height=60" -->
</CENTER><BR CLEAR=all>
<!-- THIS ASSUMES THE SIZE OF THE AD ITSELF IS width="468" height="60" border="0" !!! -->
<!-- END banner ad -->
<h4>Table 3: NBD Data Protocol Per Thread, Per Type of Data Request</h4>
<table border="1">
<tr>
<td>type</td>
<td> caller thread</td>
<td> function</td>
<td> data on the wire</td>
<td> (detail)</td>
</tr>
<tr>
<td></td>
<td> </td>
<td> </td>
<td> </td>
<td> u32 magic</td>
</tr>
<tr>
<td></td>
<td> </td>
<td> </td>
<td> </td>
<td> u32 1</td>
</tr>
<tr>
<td>write</td>
<td> nbd_request</td>
<td> nbd_send_request</td>
<td> (--></tt> struct</td>
<td> u64 unique ID</td>
</tr>
<tr>
<td></td>
<td> (kernel)</td>
<td> </td>
<td>     nbd_request</td>
<td> u32 request offset</td>
</tr>
<tr>
<td></td>
<td> </td>
<td> </td>
<td>     </td>
<td> u32 request length</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td> (--></tt>) char[]</td>
<td> data</td>
</tr>
<tr>
<td></td>
<td> </td>
<td></td>
<td> (<--</tt>) struct</td>
<td> u32magic</td>
</tr>
<tr>
<td></td>
<td> nbd_do_it</td>
<td> nbd_read_stat</td>
<td>    nbd_reply    </td>
<td> u32 error</td>
</tr>
<tr>
<td></td>
<td> (client)</td>
<td> </td>
<td>     </td>
<td> u64 unique ID</td>
</tr>
<tr>
<td></td>
<td> </td>
<td> </td>
<td> </td>
<td> u32 magic</td>
</tr>
<tr>
<td></td>
<td> </td>
<td> </td>
<td> </td>
<td> u32 0</td>
</tr>
<tr>
<td>read</td>
<td> nbd_request</td>
<td> nbd_send_request</td>
<td> (--></tt> struct</td>
<td> u64 unique ID</td>
</tr>
<tr>
<td></td>
<td> (kernel)</td>
<td> </td>
<td>     nbd_request</td>
<td> u32 request offset</td>
</tr>
<tr>
<td></td>
<td> </td>
<td> </td>
<td>     </td>
<td> u32 request length</td>
</tr>
<tr>
<td></td>
<td> </td>
<td></td>
<td> (<--</tt>) struct</td>
<td> u32magic</td>
</tr>
<tr>
<td></td>
<td> nbd_do_it</td>
<td> nbd_read_stat</td>
<td>    nbd_reply    </td>
<td> u32 error</td>
</tr>
<tr>
<td></td>
<td> (client)</td>
<td> </td>
<td>     </td>
<td> u64 unique ID</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td> (--></tt>) char[]</td>
<td> data</td>
</tr>
</table>
<p>
</body>
</html>
