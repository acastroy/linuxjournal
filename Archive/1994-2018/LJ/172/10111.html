<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Build a MythTV Box without Breaking the Bank
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;How to turn your old PC from a dust magnet into a state-of-the-art media&#10;center.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x22b9580.0x23b0ac0"></a>
Build a MythTV Box without Breaking the Bank
</h1></div><div><div class="author"><h3 class="author">
P. Surdas
 
Mohit
</h3></div><div class="issuemoyr">Issue #172, August 2008</div></div><div><p>
How to turn your old PC from a dust magnet into a state-of-the-art media
center.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x22b9580.0x23b1250"></a></h2></div></div><p>
At my wedding, I received an important piece of advice from a couple
whose wedding we had attended a couple years earlier: get a second
TV. The idea is that while she's watching <span   class="emphasis"><em>America's Next Top
Model</em></span>, I
can watch hockey or mud wrestling or something. However, a much
better solution to that age-old problem (and many others) is to set up a
DVR system using Isaac Richards' open-source MythTV software. That way,
we can watch whatever shows we want at any time.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x22b9580.0x23b1460"></a>
The Basics</h2></div></div><p>
This article shows how to build a MythTV box on a budget and how to
avoid some common pitfalls. The following is the hardware 
you'll need:
</p><div class="itemizedlist"><ul type="disc"><li><p>
A computer: the first step is to get your hands on an old computer.
You already may have one gathering dust in the basement. I bought one
for $70 on Craigslist. I was cautious and chose one with a 1.6GHz AMD
Athlon processor. You should be able to get by on much less by
minimizing the load on your processor. Price: $0&ndash;$70.
</p></li><li><p>
Tuner card: you need a tuner card to take the digital
or
analog television signal and turn it into something your computer
understands. The best ones for use with Linux are the Hauppauge
WinTV-PVR series; the PVR-150 is a single tuner with a built-in MPEG encoder,
the PVR-350 is a single tuner with built-in MPEG encoder and decoder, and
the PVR-500 has two tuners with an MPEG encoder only. I bought my first PVR-150
for $85 (in Canada), including a remote and IR blaster (I'll explain
what that is later). Regular prices in the US range to as low as $60. I
bought my second one on sale for $25. I recommend starting with one
PVR-150, and then buying another later if you feel the need. Price:
$25&ndash;$85.
</p></li><li><p>
Hard drive: your computer likely already has a hard drive, but it's
probably not larger than 8GB, and you'll need a bigger one. The size 
depends on how much of a library you plan to build. I bought a 250GB
hard drive at first, then picked up a 500GB external drive later on.
Price: $60&ndash;$80 for 250GB; $90&ndash;$150 for 500GB.
</p></li><li><p>
Video card: the choice of video card is very important,
particularly
if it's an older model. You may need to buy a new video card if your
existing one doesn't have a TV-out connection. NVIDIA has the best Linux
support, and you can run into a lot of problems with an older ATI card,
as they haven't released proprietary drivers for them. Price: $0&ndash;$60.
</p></li><li><p>
DVD drive: if you want to watch DVDs or burn recorded programs to
DVD, you need a DVD-ROM or DVD-RW drive. I definitely recommend
this, as they are not too expensive these days. Price: $35.
</p></li></ul></div><div       class="mediaobject"><a href="10111f1.large.jpg"><img src="10111f1.jpg"></a><div class="caption"><p>
Figure 1. My MythTV Setup
</p></div></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x22b9580.0x23b1ae8"></a>
Installation</h2></div></div><p>
I like Ubuntu and use it on my other computers as well, so I
decided to install Mythbuntu&mdash;a MythTV-centered distribution based on
Ubuntu. Unfortunately, I had trouble installing both Mythbuntu and
Ubuntu itself&mdash;probably because of my RAM limitations&mdash;so I
installed
Xubuntu (a lightweight Ubuntu running the Xfce desktop manager)
instead. The install was quite easy; however, one unexpected (but easily
fixed) problem emerged. I couldn't boot after successfully installing
the operating system. The GRUB bootloader would spit out &ldquo;Error
18&rdquo;. The problem turned out to be that on older computers, the BIOS
can't handle partitions larger than 8GB. So, you have to partition the
disk and create a boot partition (or root partition) that is smaller
than 8GB. 
</p><p>
A word on filesystems: I used the ext3 filesystem in the
initial install, but used XFS (which is better at deleting large files) on an
external drive that I bought later. I wouldn't recommend doing this
unless you're familiar with XFS. I've had some issues with it&mdash;for
example, it tends to become unmounted pretty frequently, requiring me to
remount it, which is pretty annoying when you're trying to watch TV.
The ext3 filesystem works just fine, but you should enable slow delete in the
back-end settings (under General).
</p><p>
The next issue is connecting your MythTV box to the TV.
If you have a new TV (particularly an LCD TV), you may have a VGA port
in the back. If so, great&mdash;simply connect it as you would a monitor. If
not, you'll need to connect the TV-out port on your video card (or
PVR-350 tuner card) to the TV using an S-cable. You also need to add
an entry to the /etc/X11/xorg.conf file. You may become very familiar
with this file, particularly if you get a new TV or video card.
Following the install, I added the following Monitor entry:

<pre     class="programlisting">
Section "Monitor"

Identifier "Samsung"

DisplaySize 400 300

HorizSync 35 - 50

VertRefresh 60 - 60

Option "DPMS"

EndSection
</pre>
</p><p>
Your entry will depend on the make of TV you have. When I got an LCD TV,
I changed it to the following:

<pre     class="programlisting">
Section "Monitor"

Identifier "LG 32LC7D"

UseModes "Modes[0]"

DisplaySize 1360 768

HorizSync 31.0 - 60.0

VertRefresh 60.0

Option "DPMS"

EndSection
</pre>
</p><p>
I also had to add a new section:


<pre     class="programlisting">
Section "Modes"

Identifier "Modes[0]"

ModeLine "1360x768" 85.5 1360 1424 1536 1792 768 771 777 795 
 &#8618;+hsync +vsync

ModeLine "1216x684" 74.2 1216 1356 1396 1650 684 704 709 750 
 &#8618;+hsync +vsync

EndSection
</pre>
</p><p>
If you installed Mythbuntu, you should be ready to go at this point. If
not, use the Synaptic package manager to install MythTV and
any plugins you want. Configuring MythTV the first
time can be a daunting task, due to the large number of available options.
You gradually will become familiar with many of them, but I'll walk you
through the basic initial setup next.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x22b9580.0x23b1f08"></a>
Setup</h2></div></div><p>
MythTV is made up of a front end and a back end. The back end does most of
the work: it records programs, resolves conflicts and controls access
to the database. It always is running in the background. If you have a
Hauppauge WinTV-PVR tuner card, recording programs takes very little
effort by the processor, just a small percent. The front end is the
interface for the back end. You use it to schedule and watch programs,
watch and burn DVDs, play music and so on.
</p><div       class="mediaobject"><a href="10111f2.large.jpg"><img src="10111f2.jpg"></a><div class="caption"><p>
Figure 2. The Watch Recordings Screen of the MythTV Front End
</p></div></div><p>
When you install MythTV, you automatically are sent to the back-end
setup. You can access it at any time by running
<tt  >mythtv-setup</tt>
from a terminal. The first screen of the General setup menu allows you
to set IP addresses for the back end. I recommend starting with one
combined back-end/front-end machine, so just leave these as is (both local
and Master should be set to 127.0.0.1 or localhost). You can skip the
next screen unless you have high-definition cable. You also can skip the
remaining screens for now. 
</p><p>
Next, you need to set up your capture card.
If you have a Hauppauge card, simply select the card type that
mentions PVR-x50, and it should recognize the card automatically. Under
Video Sources, indicate from where it should download
television listings. The main one for open-source uses is Schedules
Direct. Visit the Web site to create an account and set up
your channel lineup. 
</p><p>
Next, under Input connections, associate each
tuner card with a listings source. Under Storage Directories, you can
indicate where you want to store recordings. The latest
version of MythTV allows you to specify multiple directories, which can
be useful if you have multiple hard drives (and do not use a logical
volume manager).
</p><div       class="mediaobject"><a href="10111f3.large.jpg"><img src="10111f3.jpg"></a><div class="caption"><p>
Figure 3. The Tuner Card Setup Screen
</p></div></div><p>
Now you should be ready to start watching and recording TV. There are
two options for interfacing with your new MythTV box: using a
keyboard and/or mouse (presumably Bluetooth) or using a remote
control to navigate the MythTV interface and log in remotely with SSH to
perform system administration tasks, such as installing and updating
software. I recommend the latter. If you don't have an HDTV, you will
find it difficult to read any text or menus on the screen. Setting up
the remote is easy to do if you follow one of the many how-tos
available on-line. In order to allow remote login to your system via SSH,
you need to install the SSH server. In Ubuntu, this is the package
called openssh-server. Start it with the following:

<pre     class="programlisting">
/usr/sbin/sshd
</pre>
</p><p>
Before doing this, make sure you are using a secure password
(especially for the mythtv user that is created automatically).
</p><p>
If you have digital cable, as I do, you'll run into some additional
complications. In order to change the channel, you need to change the
channel on the cable box. You can do this with an IR blaster, which
should come with your Hauppauge remote. There is an excellent on-line
guide on how to set this up (see Resources). Keep in mind that you need to use the lirc_pvr150
module and <span   class="emphasis"><em>not</em></span> the lirc_i2c module; the reverse is true if you have no
blaster. You need to set up the blaster right in front of the IR
receiver on the cable box; I just taped mine on. When
I upgraded Ubuntu on my MythTV box, the remote and blaster support
broke, so you may want to set aside some time for upgrades in case this
happens to you too.
</p><div       class="mediaobject"><a href="10111f4.large.jpg"><img src="10111f4.jpg"></a><div class="caption"><p>
Figure 4. My IR Blaster Setup
</p></div></div><p>
MythTV isn't only a DVR. Through the plugins, it has the capability to
be an all-in-one entertainment system. The plugins I use
on a daily basis are MythMusic, MythVideo, MythArchive and MythWeb. The
first two allow you to play music and videos in various formats
(including DVD). MythArchive lets you burn recordings and videos to DVD,
and MythWeb allows you to control your system remotely with an
easy-to-use Web interface. 
</p><p>
I dumped my music collection onto
my MythTV box, and as I have a good set of speakers, I use it as
my main stereo system. Watching and backing up DVDs are also a snap
using MythVideo. If you have an HDTV, try downloading the HD video of the
moon from the Japanese <span   class="emphasis"><em>Kaguya</em></span> spacecraft and watching it in your living
room. MythArchive and MythWeb are helpful when you're not at home,
because you can burn your favorite programs or movies and take
them with you or download them remotely. MythWeb requires a little
setup, but it's fairly easy. Make sure you enable authentication
before opening it up to the outside world.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x22b9580.0x23b2958"></a>
Performance</h2></div></div><p>
You may run into a few problems on your low-end system.
The two main ones involve high CPU usage and
insufficient RAM. You can operate MythTV with 256MB of RAM; however, I
experienced frequent freeze-ups, so I upgraded to 512MB. You should
keep an eye on how well it's performing and consider upgrading if
necessary. Another problem I experienced early on was that playing
recordings or DVDs consumed such a large fraction of CPU time
(70%&ndash;80%),
that running other processes tended to cause the playback to become
jerky. In particular, commercial flagging and database accesses at the
beginning and end of recording a program produced annoying jerkiness.
I resolved this problem entirely by replacing my ATI
video card, which does not have a proprietary Linux driver, with an
NVIDIA card. The skipping stopped almost completely when I replaced the
video card, as did the seemingly unrelated problem of slow menu
scrolling. CPU usage dropped to around 40%&ndash;50%.
</p><p>
Another benefit of NVIDIA's superior Linux support is that part of the
MPEG decoding work can be delegated to the video card using XvMC
(X-Video Motion Compensation), reducing the load on the CPU. To
enable XvMC, go to Utilities/Setup&rarr;Setup&rarr;TV Settings&rarr;Playback. On the third screen, change the Playback Profile to CPU--.
XvMC didn't kick in on mine until I deleted the top line of the profile
(referring to ivtv). You can tell if it's operating because the
on-screen display changes to grayscale. You also can tell because
the CPU usage will go way down. The Xorg process dropped to less than 10% during
playback; the sum of Xorg and mythfrontend is always less than 30%. As a
result, additional processes (including creating and burning DVDs) no
longer affected playback.
</p><div       class="mediaobject"><a href="10111f5.large.jpg"><img src="10111f5.jpg"></a><div class="caption"><p>
Figure 5. Enabling XvMC under TV Settings
</p></div></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x22b9580.0x23b2c70"></a>
Satisfaction</h2></div></div><p>
For a pretty small sum&mdash;$85 if you get a tuner card
on sale and already have a computer and up to around $500 for a multicard,
multidrive system built from scratch&mdash;you can build a
fully functional MythTV box. TV watching will never be the same.
</p><p>
Be warned: MythTV is an amazing piece of software, but it is
free software that is constantly under development. Be prepared to get
your hands dirty and tinker under the hood if something goes wrong or
everything isn't working as you'd like. Have fun with it&mdash;test-drive
different themes, tweak the settings and try the various plugins. After
all, that's what Linux is all about.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x22b9580.0x27ab020"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
MythTV: <a href="http://www.mythtv.org" target="_self">www.mythtv.org</a>
</p><p>
Hauppauge WinTV-PVR Tuner Cards: <a href="http://www.hauppauge.com/site/products/prods_pvr.html" target="_self">www.hauppauge.com/site/products/prods_pvr.html</a>
</p><p>
Mythbuntu: <a href="http://www.mythbuntu.org" target="_self">www.mythbuntu.org</a>
</p><p>
How to Install an IR Blaster: <a href="http://www.blushingpenguin.com/mark/blog/?p=24" target="_self">www.blushingpenguin.com/mark/blog/?p=24</a>
</p></div></div></div>
<div class="authorblurb"><p>
P. Surdas Mohit is a postdoctoral fellow at the Institute of Geophysics
and Planetary Physics at Scripps Institute of Oceanography.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../172/toc172.html">Issue Table of Contents</a>
    <a class="link3" href="../172/10111.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>