<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
At the Forge</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Keep track of what's happening on your Web site with alerts&#10;for key events.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x2307580.0x23feab0"></a>
At the Forge</h1></div><div><h3 class="subtitle"><i>
Bricolage Alerts</i></h3></div><div><div class="author"><h3 class="author">Reuven M. Lerner</h3></div><div class="issuemoyr">Issue #114, October 2003</div></div><div><p>
Keep track of what's happening on your Web site with alerts
for key events.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x23ff348"></a></h2></div></div><p>
Last month, we started to look into the powerful open-source Bricolage
content management system (CMS) written by David Wheeler and based on
mod_perl, HTML::Mason and PostgreSQL. Content management software is
a relatively new type of Web application, designed to make it possible
to manage large Web sites. Bricolage has been widely hailed as a new
open-source success story, demonstrating that proprietary software is
not necessarily more flexible or more powerful than its free software
counterparts.
</p><p>
It's important to remember that although a CMS is a Web-based
application that depends on dynamically generated server-side
programs, the output from a CMS typically is a static site. So even though
Bricolage is a large Web/database program and customizing Bricolage
requires server-side programming skills, it actually is an application
meant to be used on a day-to-day basis by nonprogrammers.
Indeed, organizations from Salon.com to <span   class="emphasis"><em>MacWorld</em></span> on-line currently
use Bricolage. And thousands of other Web sites, from CNet to
LinuxJournal.com, use content management solutions ranging
from Vignette (complex, proprietary and expensive) to PHPNuke
(simple, open source and free of charge).
</p><p>
This month, we look at one of my favorite Bricolage features,
alerts, which allow users to keep track of different activities on
a Bricolage system. Not only do alerts keep us informed of what
is happening, they also provide a good way to see how the system
works&mdash;by looking at the list of objects, by the actions that can be
taken on each of those objects and by knowing when the alerts actually are
triggered.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x23ff558"></a>
Alerts</h2></div></div><p>
Bricolage, like most CMS software, moves articles through stations in
a pipeline. In Bricolage, these stations are known as desks,
reflecting the software's origins in the world of journalism. Stories
thus begin at the edit desk, move to the copy desk, then to
the legal desk and finally to the publish desk, from which
they actually can be published on the Web.
</p><p>
On a small Web site being managed by only a handful of people,
it is easy to keep track of which articles are kept where. But once you
get beyond a small number of people or a small number of articles, it
becomes difficult to keep track of what is happening with each article.
</p><p>
One way to handle this work flow is to look at the various desks, one at a time,
to see what stories are on each one and then take appropriate action.
But this looking can get tedious, and you might want to track stories in
the news category or those by a particular author, rather than all
of them. Moreover, it would be nice to receive notification of work-flow
events via e-mail.
</p><p>
This functionality exists in Bricolage, and in true open-source
fashion, it is customizable to an amazing degree. To create or modify
alerts, click on the alert types menu item under the system
menu in the lower right-hand side of the screen. This is one of the
admin menus, meaning it's accessible only to users with
administrative privileges. The resulting screen, like most other
administrative screens in Bricolage, allows you to search for an alert
by name or view all alerts that begin with a particular letter.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x23ff7c0"></a>
Creating Alerts</h2></div></div><p>
You can create a new alert type by clicking on the create new alert
type link. This brings up a short HTML form that asks you to
identify the Bricolage object on which you want to put an alert. So
if you want to be alerted when something happens to stories,
ask for alerts on stories. And if you want to be alerted when a new
user is added to the system, ask for alerts on
users. In short, almost any object in Bricolage can be placed
under an alert.
</p><p>
As an example, let's create an alert to tell us when any story
with &ldquo;Linux&rdquo; in the headline is moved from one desk to another. Once
again, Bricolage makes it easy for us to monitor any object. This,
however, is undoubtedly one of the more common types of alert that
take place.
</p><p>
We now choose create new alert type from the admin menu, then
create a new alert on Story objects. We then are presented with a
list of actions that Bricolage can watch for us, ranging from
category added to story to story published to
element deleted
from story. For this example, we choose Story moved to desk and
name it Linux story moved.
</p><p>
Each alert type must have an owner; in this particular case, the owner
is me, because I'm logged in as myself. The only user initially created
by Bricolage, whose login is admin, is known as Bricolage
Administrator. This admin user should be treated the same as the UNIX root
user. It certainly can
own alerts, but you are better off creating additional
users (with the admin/user menu in the bottom left-hand corner),
giving yourself administrative permissions and then logging in as
yourself rather than as the administrator.
</p><p>
In any event, clicking on the next button at the bottom of this page
brings you to the main alert type editing screen, which is used to
create new alert types and modify existing ones. Each alert has four parts:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Properties: the name and owner of the alert type, which we entered
on the previous page.
</p></li><li><p>
Rules: a description of when the alert should fire. Each rule
consists of a variable (selected from a pull-down menu, thus
avoiding the potential for misspellings), a comparison test and a
text field into which you can enter the comparison value.
</p></li><li><p>
Content: the e-mail message sent to alert recipients. This
can include a number of different variables, from the story's
headline to its publication date.
</p></li><li><p>
Recipients: the users and groups who should receive the alert, if and
when it fires. You can send an alert to all editors, to all
authors or to George and Frank but not Deborah and Mary.
</p></li></ul></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x23ffdf0"></a>
Alert Rules</h2></div></div><p>
The rules are perhaps the most interesting part of the Bricolage alert
system because of the relative ease with which nonprogrammers can
create and edit them. However, there is the potential for danger with
the =~ and !~ operators, which Perl programmers should recognize as
indicators of regular expressions. This clearly is a
double-edged sword, because regular expressions can be enormously
powerful to the enlightened and extremely dangerous (and frustrating)
to the ignorant.
</p><p>
So, we can create our alert by choosing Story title from the
attribute list on the left side, =~ from the comparison operator
list and entering Linux as the value in the text field, giving us:

<pre     class="screen">
Story title =~ Linux
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x23fffa8"></a></h2></div></div><p>
We have to use =~ and not =, because we want to look for Linux in any
part of the title rather than match the entire title. If we were
interested in either Linux or Perl, we would search for:

<pre     class="screen">
Story title =~ Linux|Perl
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x2400108"></a></h2></div></div><p>
Experienced Perl hackers might be pleasantly surprised to learn that =~
and !~ are case-insensitive here.
</p><p>
The subject and text of the alert can contain any text you wish,
including interpolated Perl variables that Bricolage has defined for
us. In a nice use of JavaScript, Bricolage lets you choose variables
from a selection list, avoiding the possibility of typos and other
errors. Also, this is a handy reference so you don't need to
remember all of the variable names available when working with
stories. In this manner, we can set the subject of the alert to be:

<pre     class="screen">
The story $title was just moved to $desk
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x24002c0"></a></h2></div></div><p>
The body of the alert message then contains a different message, but
it also can contain variables. For example, you can set the alert to
read:

<pre     class="screen">
You asked to be notified when Linux-related articles
are moved to a new desk. Well, $trig_full_name
just moved "$title" to the $desk
desk. I hope you're happy now.
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x2400420"></a>
Receiving Alerts</h2></div></div><p>
When an alert fires, its message is sent to all of the designated
recipients in two different ways. An e-mail message is sent to
each of the registered users, informing them, with the message we
defined above, that the change has taken place. But Bricolage also
keeps track of these items within its database, making it easy to
keep track of alerts over the Web. For example, if an alert is fired from the Linux-related item we
described above, we receive an indication by e-mail. But we also can
see a summary of all the alerts we have received on the my
alerts page, which you can get to by clicking on the my
alerts
button located at the top of each screen.
</p><p>
Alerts stay on this screen until they are acknowledged. The
alert screen is not meant to be a long-term storage system; rather, it is
a simple messaging agent that allows an editor to look at all of the
relevant things that have happened to the site in the recent past.
</p><p>
You can acknowledge, and thus remove, an alert from the my
alerts
page by clicking in one or more check boxes and then selecting the
acknowledge checked button at the bottom of the list. You also
can acknowledge all of them at once, without having to use check boxes, by
clicking on the acknowledge all button.
</p><p>
If I were the editor of a medium-sized Web site, I would spend a great
deal of time defining alerts that would let me know when important
events had occurred, such as when writers sent items to my desk.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x2400630"></a>
Learning from Alerts</h2></div></div><p>
Alerts are an excellent and practical way for Bricolage to bring
relevant information to the appropriate user, rather than forcing
users to go and seek out the information. But a side benefit of these
alerts is they help new Bricolage administrators and programmers
understand the different actions that can occur on different
objects in the system. A simple example is the user object: we can create an alert that
notifies us whenever users are created or deactivated, change their
settings or change their password. This sort of alert is clearly
uninteresting for editors but can be of supreme importance to
system administrators.
</p><p>
A more complex example is the template object, which will be discussed next
month. Templates define the ways in which stories are displayed,
so it's important to keep track of them and any modifications made
to them. Therefore, more items are associated with templates than with
users&mdash;you can keep track of when a template is deployed, when it is
edited and even when it is moved to its desk. Indeed, if you
didn't previously understand that templates have their own desk,
just like stories, the alert system would have made that clear to
you.
</p><p>
I personally have learned quite a bit about Bricolage from poking
through the system from different angles, including alert definitions.
If you are new to Bricolage and haven't quite figured out how
everything works, even after reading the documentation and expanding
all of the menus (which is vital if you are to see where the different
parts of a Bricolage site are defined and who has permission to set
them), looking through the alert definitions makes things
clearer. Moreover, if you are unsure of how a particular object is
handled in the system, you always can create and register for an alert
on that object, disabling it once you learn how it works.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x24007e8"></a>
Conclusion</h2></div></div><p>
As we saw last month, Bricolage is a large and complex system.
Alerts make it possible for relevant information to pursue you,
freeing you from having to hunt it down on a number of different screens. Although
alerts are only a small part of the Bricolage system, they
offer an intriguing view of its depth and breadth and of the options
available with different objects.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2307580.0x24008f0"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
The main source of information about Bricolage is the project's Web
site, at <a href="http://bricolage.cc" target="_self">bricolage.cc</a>. That site has pointers to
downloadable source code (hosted at SourceForge), documentation and
an instance of Bugzilla (<a href="http://bugzilla.bricolage.cc" target="_self">bugzilla.bricolage.cc</a>) for bug
reports and feature requests.
</p><p>
There are several Bricolage mailing lists, hosted by SourceForge, in
which the developers participate actively. If you have questions or
want to learn about new releases, you can subscribe from the
SourceForge page (<a href="http://sourceforge.net/projects/bricolage" target="_self">sourceforge.net/projects/bricolage</a>).
</p><p>
The Bricolage documentation generally is quite good, though technical. A
more user-level introduction to the system was published by O'Reilly
and Associates as an appendix to the recently published book about
Mason. You can read that appendix on-line at <a href="http://www.masonbook.com/book/appendix-d.mhtml" target="_self">www.masonbook.com/book/appendix-d.mhtml</a>.
</p><p>
For more information about PostgreSQL, see the project's main site at
<a href="http://www.postgresql.org" target="_self">www.postgresql.org</a>. For more information about
Apache, see <a href="http://httpd.apache.org" target="_self">httpd.apache.org</a>. To learn more about mod_perl,
look at <a href="http://perl.apache.org" target="_self">perl.apache.org</a>. Remember that Apache 2.x and
mod_perl 2.x both are unsuitable for Bricolage, although that may
change by the time you read this. You can learn more about
Mason from the Mason book site (<a href="http://www.masonbook.com" target="_self">www.masonbook.com</a>) and
from the Mason home page (<a href="http://www.masonhq.com" target="_self">www.masonhq.com</a>).
</p><p>
Finally, you can learn more about David Wheeler (the primary author
and maintainer of Bricolage) at <a href="http://david.wheeler.net" target="_self">david.wheeler.net</a> and about
his company Kineticode at <a href="http://www.kineticode.com" target="_self">www.kineticode.com</a>.
</p></div></div></div>
<div class="authorblurb"><p>
Reuven M. Lerner (<a href="mailto:reuven@lerner.co.il">reuven@lerner.co.il</a>) is a consultant
specializing in open-source Web/database technologies. He and his wife,
Shira, recently celebrated the birth of their second daughter, Shikma
Bruria. Reuven's book <span   class="emphasis"><em>Core Perl</em></span> was published by
Prentice
Hall in early 2002, and a second book about open-source Web technologies
will be published by Apress in 2003.

</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../114/toc114.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>