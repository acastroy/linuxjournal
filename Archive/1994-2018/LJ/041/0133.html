<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Linux for Embedded Systems</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    A company in Japan is using Linux for embedded systems in vertical&#10;    transportation equipment such as elevators.&#10;    "><meta name="keywords" content="embedded, systems, elevator"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0xee1580.0xfd8ab0"></a>Linux for Embedded Systems</h1></div><div><div class="authorgroup"><div class="author"><h3 class="author">Sandor Markon</h3></div><div class="author"><h3 class="author">Kenji Sasaki</h3></div><div class="issuemoyr">Issue #41, September 1997</div></div></div><div><p>
    A company in Japan is using Linux for embedded systems in vertical
    transportation equipment such as elevators.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xee1580.0xfd96b8"></a></h2></div></div><p>Fujitec is a global manufacturer and
provider of a complete range of elevators, escalators and other
vertical transportation equipment. Nearly all of our products use
embedded computers in one form or other. To see the implications, a
few features of the elevator business to note are:
<div class="itemizedlist"><ul type="disc"><li><p>The lifetime of the product is very long, on the
order of 20 years or more.</p></li><li><p>Safety and availability of elevator service is a
deciding factor for the users, especially for medium to high-rise
buildings.</p></li><li><p>Continuous service and maintenance during the full
life cycle is vital; usually, it is even required by law.</p></li><li><p>To meet the requirements of long term,
disruption-free service and maintainability for embedded computers,
we have recently started to investigate the possibility of using
the freely available Linux OS and the GNU utilities.</p></li></ul></div>

</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xee1580.0xfd9ad8"></a>The Target: Elevator Monitoring
Equipment</h2></div></div><p>We have in the past shipped several products using Linux. We
will describe here only one of them&mdash;a monitoring display for group
controllers (see Figure 1).</p><p><a href="0133f1.jpg" target="_self"><span   class="bold"><b>Figure 1.
Controller Monitoring Display</b></span></a></p><p>Another application, a user-interface system for editing
scrolling messages in elevator cars, is shown in Figure 2, but we
do not have space to introduce it in detail. (Notice the Japanese
characters&mdash;Linux works fine in Japan, too.)</p><p><a href="0133f2.jpg" target="_self"><span   class="bold"><b>Figure 2.
Elevator User Interface</b></span></a></p><p>To put things into perspective, we need a few facts about
elevators. If a building has more than 2 or 3 elevators, they are
usually working in groups sharing the passenger traffic. A group of
elevators is connected to a &ldquo;Supervisory Group Controller&rdquo;, which
shares the service of each elevator among users while attempting to
give each user the illusion that he/she has a personal
elevator.</p><p>The modern elevator group controller is rather sophisticated;
it has to run difficult, optimal-scheduling algorithms in real
time. The latest Fujitec models use neural networks for on-line
learning and optimization. Without proper tools, the support
personnel who perform installation and testing tasks wouldn't
understand what is happening with the elevator group.</p><p>For maintenance checks, upgrades and occasional
troubleshooting, the GSP (Group Supervisory Panel) has a graphical
display showing the status of the elevators. This monitoring
display was the target of our first Linux application.</p><p>Figure 1 shows the graphic screen of the monitor display.
Information for each elevator, such as the present floor, traveling
direction, door status, registered calls, etc. is indicated by
graphic symbols. This screen design has evolved over several years,
and it is now familiar to our technical and maintenance
personnel.</p><p>We built most of the original monitoring display system with
custom-designed components:</p><div class="itemizedlist"><ul type="disc"><li><p>A custom graphic board with custom graphics
software</p></li><li><p>Control software common with our
sequence-controller, CPU board</p></li><li><p>Serial interface with our proprietary protocol to
communicate with the group controller</p></li><li><p>A multiscan VGA display (the only commercial
part)</p></li></ul></div><p>These components were chosen to give us the following
advantages:</p><div class="itemizedlist"><ul type="disc"><li><p>Stand-alone operation in the elevator, machine-room
environment</p></li><li><p>Real-time response</p></li><li><p>Long-term supply and maintenance</p></li><li><p>Low cost</p></li></ul></div><p>Even though we saw several problems with our custom-designed
approach and wanted to move to an established, popular platform,
until recently it was not feasible.</p><p>For the hardware, our first choice would have been the IBM-
compatible PC, perhaps in the form of PC/104 cards. However, the
dominant commercial OS (first DOS, then Windows), was unsuitable
for many reasons. It is neither real-time capable nor reliable, and
there is no chance that a particular release could have long-term
support from its vendors.</p><p>Although there were many alternatives, such as the excellent
Lynx OS, none of them satisfied all of our requirements, especially
the long-term stability and availability criteria.</p><p>With the appearance of Linux, all this has changed.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xee1580.0xfda7e8"></a>Advantages and Problems of Using Linux for
Embedded Systems</h2></div></div><p>Over the past few years, several engineers at Fujitec became
familiar with Linux. Although we started it as a hobby, gradually
the wider applicability of Linux became clear to us.</p><p>Our motivation for embracing Linux for product development
has several roots:</p><div class="itemizedlist"><ul type="disc"><li><p>The availability of the complete source tree of the
system, without any restrictions on use, distribution or revisions,
is vitally important to us. It can ensure that we will have some
way of maintaining our systems at a site 5, 10, 15, ... years from
now. If we wanted to guarantee the same with a commercial system,
it could easily become a nightmare. We could imagine the vendor in
2010 (if still in business) just staring at us with mouth agape,
when we ask them about bug fixes for their 1997 system. However,
when we have the source, maintenance becomes &ldquo;difficult&rdquo; instead
of &ldquo;impossible&rdquo;, just as with in-house, custom-made
systems.</p></li><li><p>An added bonus is the freedom from administration
of a royalty-based, license system for some proprietary OS; not to
mention the savings on the license fee.</p></li><li><p>We have been using Unix for system development for
many years. After some rather frustrating experiences with other
systems on the PC platform, our developers were quite eager to get
back to a Unix-like environment.</p></li><li><p>Even among Unix systems, Linux feels unique: it is
light, fast, runs on almost any platform, contains the latest
version of all free software and is now so visible that even
non-computer people are starting to talk about it. It is a good
feeling to be back in the mainstream again.</p></li></ul></div><p>However, not everything is rosy. Since Linux is essentially
Unix, a few things had to be fixed before we could deploy it in an
embedded controller.</p><div class="itemizedlist"><ul type="disc"><li><p>Ideally, we would like to use a ROM-based system,
such as the one described in the article &ldquo;Booting Linux from
EPROM&rdquo; by D. Bennett, <i  >Linux Journal</i>, January,
1997. In our case, however, we needed X11, Tcl/Tk, libraries,
fonts, etc., so we were forced to use a hard disk-based system.
This means that we have to think about disk-buffer flushing,
cleanup and recovery after messy shutdowns, etc.</p></li><li><p>Linux is not a &ldquo;hard&rdquo; real-time system as it
stands, although people are already working on real-time patches.
(See &ldquo;Introducing Real-Time Linux&rdquo;, M. Barabanov and V. Yodaiken,
<i  >Linux Journal</i>, February 1997.) For our current
application, this was not directly a problem, but we would need
guaranteed response time if we wanted Linux to control an elevator
car.</p></li><li><p>Installation must be made foolproof, especially for
re-installation or upgrades. We have found that our customized
procedure works, but it still needs to be improved.</p></li></ul></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xee1580.0xfd1860"></a>The Linux Monitoring System</h2></div></div><p><a href="0133f3.jpg" target="_self"><span   class="bold"><b>Figure 3.
Monitoring System Block Diagram</b></span></a></p><p>Figure 3 shows the top-level block diagram of the monitoring
system. We are using the Slackware 3.0 distribution with XFree86
for graphics. The application programs are compiled with the GNU C
compiler (version 2.7.2). In some parts of a different application,
we also use Tcl/Tk for our graphical user interface (GUI).</p><p>Many parts of the software, especially the X11 graphics, were
ported without any problems from our existing Unix applications
(under SunOS 4.1). A large part of our labor was spent on file
system issues, in order to make the system installable and
robust.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xee1580.0xfd1ac8"></a>File System, Installation, Recovery</h2></div></div><p>Our design is based on the UMSDOS file system, which resides
over an MS-DOS-compatible host file system, e.g., Microsoft
Windows. The decision to use UMSDOS took into account the reality
of the proliferation of pre-installed Windows systems. Although
Windows will not normally be used after Linux is up and running, we
prefer not to remove it completely or to give Linux its own disk
partitions.</p><p>With UMSDOS, the whole Linux system looks like a single MS-
DOS directory tree from the Windows side. This fact gives us the
option of doing installation and some restricted file maintenance
from Windows, using CD-ROM or floppies. However, we have found it
faster and easier to boot Linux from floppy and stream the system
to the hard disk through an Ethernet link. Network installation
worked flawlessly both for desktop PCs, using a D-Link pocket
adapter DL620, and for notebook PCs, using a Megahertz (US
Robotics) PCMCIA network card.</p><p>The <a href="0133l1.html" target="_self">code</a> we used to make the
installation floppies, one each for the server (host) and the
client (target) machines, is available by anonymous ftp at
ftp://ftp.linuxjournal.com/pub/lj/listings/issue41/0133.tgz. Installation is
almost completely automatic by starting the two networked PCs from
floppy and answering a couple of questions about the X11 driver,
display size etc. Because we have these floppies, the Linux file
system with our applications can be &ldquo;cloned&rdquo; again and again from
one Windows PC to the next.</p><p>Apart from installation, a major problem for our system is
the crash recovery of the hard disk. Since we cannot guarantee
orderly shutdowns, we have to deal with the cleanup after a &ldquo;power
failure&rdquo;--like shutdown. We use the following techniques:</p><div class="itemizedlist"><ul type="disc"><li><p>Writing to the disk is restricted; most parts are
made read only, and there is no swap file.</p></li><li><p>At startup, the rc.local script runs the
<b  >umssync</b> program on the writable directories to
repair possible inconsistencies.</p></li><li><p>Possible garbage from a previous run is removed
automatically.</p></li><li><p>For emergency re-installation, a second clean copy
of the full Linux system is maintained on the hard disk, and it is
used to manually replace a damaged system.</p></li></ul></div><p>In the future, we will use a RAM disk for the temporary
files, and we hope to eventually fit the system into EPROMs.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xee1580.0xfd20f8"></a>Performance and Further Developments</h2></div></div><p>We have installed the system both on notebook machines and on
desktop computers. In case of the notebooks, the DSTN color display
had a relatively narrow viewing angle, but it was usable.</p><p>The system was built into the group controller panel, and it
has been tested under field conditions. We have also tested it at
the research laboratory by connecting it to an elevator simulator
that simulates a heavy load: 8 cars, 32 floors, all elevator cars
moving constantly. All of this has proved to be a rather easy task
for our system. There was no problem with either the serial
interface, the graphics or the logging of the monitored data. Under
the heaviest load conditions, we could log into the system and run
other programs, even recompile the application, without any effect
on performance. Response was instantaneous, and it was evident that
this platform can handle much more demanding applications.</p><p>We have tested the power failure and recovery capabilities
and checked that the system can withstand almost any abuse.</p><p>As a future development, we are considering a system with a
boot/root file system in ROM and a read-only, mounted hard disk for
the large applications and libraries. Since we want to put a normal
Linux file system on the hard disk, we need to develop kernel
patches that let the system boot from a small root file system, and
switch parts of it (/bin, /lib, etc.) during initialization.</p><p>Eventually, we would like to extend our tests to industrial
grade PC systems and check the usability of Linux for continuous
operation under strict environmental conditions. This would open
the way for moving more critical monitoring, security and control
tasks to the Linux/PC platform.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0xee1580.0xfd2360"></a>Conclusions</h2></div></div><p>Linux is a viable and attractive platform for manufacturers
who need a stable system that is &ldquo;theirs to keep&rdquo; for many years
to come. Instead of developing in-house, custom-made systems at
large cost or buying proprietary systems and leaving themselves at
the mercy of the vendor, they can now choose Linux.</p><p>Linux, with the support of the Internet developer community
and with guaranteed and affordable support from more and more
commercial ventures, is seen by many as an ideal, software
development platform. In our experience, it can also become an
excellent deployment platform for computer-controlled hardware
systems.</p><p>We are looking forward to the further expansion of our Linux
business, and we hope the experience we gather will enable us to
pay back a small part of our debt to the Linux community.</p></div></div>
<div class="authorblurb"><p>
          <span   class="bold"><b>Sandor Markon</b></span> graduated from the Technical
          University of Budapest and received a PhD in Electrical Engineering
          from Kyoto University. He has worked for Fujitec of Osaka, Japan
          since 1979 doing computer applications for elevator control.
          Present interests include neural networks, reinforcement learning,
          Internet programming with Java and industrial applications of free
          software. He can be reached via e-mail at <a href="mailto:markon@rd.fujitec.co.jp">markon@rd.fujitec.co.jp</a>.
        </p><p>
          <span   class="bold"><b>Kenji Sasaki</b></span> graduated from Kyoto University,
          Faculty of Engineering. With Fujitec since 1976, he has been
          working mostly in control, systems development and communications.
          Present interests include Java, Linux and the Internet. He can be
          reached via e-mail at <a href="mailto:kjsasaki@rd.fujitec.co.jp">kjsasaki@rd.fujitec.co.jp</a>.
        </p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../041/toc041.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>