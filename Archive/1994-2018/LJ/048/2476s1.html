<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">

<html>
<head>
  <title>Kernel Korner: Writing a Linux Driver</title>
<link rel="stylesheet" href="../../css/archive.css" type="text/css" />
</head>

<body>
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <h3>Guidelines for Implementing I/O Function Calls</h3>

  <h3>For mrv4_open():</h3>

  <ul>
    <li>Control the number of simultaneous times that the users attempt to open the device. This is useful if you want to grant access to device only to one program user at a time.</li>

    <li>Initialise ports to a convenient status.</li>

    <li>Install interrupt handlers.</li>

    <li>Disable hardware interrupts.</li>

    <li>Ask for a free irq number.</li>

    <li>Unmask that interrupt (The Jourdain book listed in Resources is a good place to learn how to program the Intel 8119 chip).</li>

    <li>Enable hardware interrupts again.</li>
  </ul>

  <h3>For mrv4_release():</h3>

  <ul>
    <li>Specific device operations (stop the robot).</li>

    <li>Uninstall interrupts.</li>

    <li>Disable hardware interrupts.</li>

    <li>Mask the interrupt.</li>

    <li>Enable hardware interrupts again.</li>

    <li>Leave the ports in an adequate (relaxed) state.</li>
  </ul>

  <h3>For mrv4_write():</h3>

  <ul>
    <li>Catch input arguments.</li>

    <li>Transform input into internal variables.</li>

    <li>Process input information.</li>

    <li>Write to ports.</li>

    <li>Return the number of bytes which have been written.</li>
  </ul>

  <h3>For mrv4_read():</h3>

  <ul>
    <li>Read ports.</li>

    <li>Store the incoming data into internal variables.</li>

    <li>Process the data.</li>

    <li>Return information via argument.</li>

    <li>Return the number of bytes.</li>
  </ul>

  <h3>For mrv4_ioctl():</h3>

  <ul>
    <li>Catch the command (and the argument, if any).</li>

    <li>Select from the command the function to perform.</li>

    <li>Perform the requested operation.</li>

    <li>Return an OK status.</li>
  </ul>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../048/toc048.html">Issue Table of Contents</a>
    <a class="link3" href="../048/2476.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body>
</html>
<!--
## vim: tabstop=2: shiftwidth=2: expandtab:
## kate: tab-width 2; indent-width 2; replace-tabs true;
-->
