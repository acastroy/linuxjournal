<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Palm Pilot Development Tools</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    How to program you hand-held computer using Linux.&#10;    "><meta name="keywords" content="Palm, Pilot, development, tool, device, handheld"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x1b1a580.0x1c11ab0"></a>Palm Pilot Development Tools</h1></div><div><div class="author"><h3 class="author">Eddie Harari</h3></div><div class="issuemoyr">Issue #73, May 2000</div></div><div><p>
    How to program you hand-held computer using Linux.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c12558"></a></h2></div></div><p>One of the great things we can do with
Linux and GNU tools is build an environment for cross-platform
development. The perfect example for cross-platform development
using Linux is the Palm Pilot development tools for Linux. In this
article, I will explain the tools and methods you should use in
order to program this small but very smart machine from your own
Linux machine.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c12660"></a>Background</h2></div></div><p>The Palm Pilot is a very smart hand-held computer based the
on the Motorola 68000 Dragon Ball CPU. A few models are on the
market: PalmIII, PalmIIIx, PalmV and PalmVII. (The older machines
are Palm-1000, Palm-5000, Palm-personal and Palm-professional). All
of the new models use the PalmOS-3.<span   class="emphasis"><em>x</em></span> as their
operating system. The basic functionality of these machines is the
same. The differences between the new models are mainly the RAM
size, the screen type, the battery and the shape of the machine.
Details about the Palm devices can be obtained from
<a href="http://www.palm.com" target="_self">http://www.palm.com/</a>.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c12818"></a>The File System</h2></div></div><p>The Palm Pilot operating system uses the RAM to store and
organize its &ldquo;files&rdquo;. Each file on the RAM is actually a Palm
Pilot database. Each database has a header indicating the type and
the creatorID of the database. The type can be anything: it is a
4-byte value the programmer can assign to his application or data.
A type of <b  >appl</b> is actually an application. If we
assign a different type of database to an application, we will not
be able to see it when we press the application button on the Palm
Pilot. The creatorID is another 4-byte value; the PalmOS uses this
value to identify the database (like a name for a file). The
combination of type and creatorID is unique, so we need to apply
for a creatorID if we want to give our application to other people.
Databases can store resources such as bitmaps, executable code,
forms and more. An application, for example, stores its User
Interface objects and its code.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c12978"></a>The Language</h2></div></div><p>To program the Palm Pilot, we first choose a programming
language. Many tools and compilers can be run on our Linux desktop
to program our Palm Pilot. Here, we use the
<span   class="bold"><b>gcc</b></span> ANSI C cross-compiler to
demonstrate a simple program. Palm provides its SDK (software
development kit) and documentation for free, and it is downloadable
from <a href="http://www.palm.com" target="_self">http://www.palm.com/</a>.
A handy book to have would be the MC68328 Dragon Ball manual from
Motorola (for more information, see the Palm web site).</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c12b30"></a>The Tools</h2></div></div><p>The most important tool we need to install is the gcc cross
compiler. The good news about this compiler is that by the time you
read this, it should be supported by Palm itself. You should be
able to find the gcc, binutils, gdb and prc-tools somewhere at the
<a href="http://www.palm.com/devzone" target="_self">http://www.palm.com/devzone/</a>
web site. No version of gcc comes with palmOS support out of the
box yet; there are some patches to install. The patches come with
the prc-tools package, containing the tools needed to combine all
resources into a prc (PalmPilot resource database) file. I
recommend using the gcc-2.95.2 version and not the earlier 2.7.2,
because it fixes many problems. The binutils-2.9.1 should also be
patched, as well as gdb-4.18, if you want to be able to debug your
application. There is a good chance that by the time this is
printed, this group of software will be in one big compressed tar
file. The installation instructions for the cross compiler are very
simple and may be found on J. Marshall's web page at
<a href="http://homepages.enterprise.net/jmarshall/palmos" target="_self">http://homepages.enterprise.net/jmarshall/palmos/</a>.
(This page is about to move to the official Palm site, somewhere
under the devzone section.)</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c12ce8"></a>Building the GUI</h2></div></div><p>Palm Pilot applications use FORMS to interact with the user.
These forms contain bitmaps, buttons, tables, check-boxes and many
other user-interface objects. A great tool to build these forms for
the Palm Pilot, called <span   class="bold"><b>pilrc</b></span>, was
written by Wes Cherry. The current version (2.4) can be downloaded
from
<a href="http://www.scumby.com/scumbysoft/pilot/pilrc" target="_self">http://www.scumby.com/scumbysoft/pilot/pilrc/</a>.
It comes as source code and has very good HTML documentation.
Listing 1 is an example of a simple pilrc file which builds a
simple form, alert, menu and help string. (Please note that the
Bitmap with ID 10 was created directly as a resource; there is no
reference to it in this file except the ID.)</p><p><a href="3782l1.html" target="_self">Listing 1</a></p><p>The command</p><pre     class="programlisting">
pilrc /usr/local/example/hw.rcp
</pre><p>will build the two UI objects in this file: the form and the
string. Each of these objects will be in a separate file. We will
combine these files with the actual code into a prc file
(application database) later, using the
<span   class="bold"><b>build-prc</b></span> command that comes with
the prc-tools package. To view the form without actually writing
the application, we can use the
<span   class="bold"><b>pilrcui</b></span> tool. This tool is bundled
with the pilrc package. For more information on the UI objects and
the use of pilrc, you should look at the Palm official
documentation and the pilrc HTML documentation.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c13108"></a>The Actual Programming</h2></div></div><p></p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c13210"></a>Events</h2></div></div><p>The PalmOS keeps a queue of events being handled by the
system. These events are sent to the current application in order
to execute the code to handle each event. An event is triggered
when a UI button is pressed, the Palm pen touches the screen
(penDownEvent) or when other operations occur. An application
should transfer any events it doesn't handle to the system. When
the event is handled, the PalmOS takes the next event in the queue
and passes it on to the application. The application can also put
events in the queue. Many PalmPilot functions cause all sorts of
events to be placed in the event queue. A list of all events and
what they do is in the official documentation for the Palm
Pilot.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c13318"></a>PilotMain</h2></div></div><p>The main procedure of a program is called PilotMain. When the
PalmOS calls PilotMain, it transfers a command to it. The PilotMain
procedure should find out what the command says. The command can
say, for example, that this is a normal launch of the application
(<span   class="bold"><b>sysAppLaunchCmdNormalLaunch</b></span>) or
that this is a command to find a string
(<span   class="bold"><b>sysAppLaunchCmdfind</b></span>). PilotMain
should ignore or respond to these commands in its code. An example
of an application that responds to the sysAppLaunchCmdfind is the
address book. Whenever we press the find button, the PalmOS sends
this command to all the applications. One application that will
accept this command is the address book&mdash;it starts searching for
the string we entered in its database.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c134d0"></a>EventLoop</h2></div></div><p>To handle all events, we should use an event loop. An event
loop simply takes an event, handles it, then takes the next event
in the queue. If we do not want to handle a certain event, we can
send it to the PalmOS event handlers so it will be handled for
us.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c135d8"></a>Pilot API</h2></div></div><p>To take advantage of all the functionality of the PalmOS,
there is well-documented API for your use. You should read the API
manual to see which kinds of events, functions and types of objects
exist in the PalmOS. Listing 2 is simple code that writes &ldquo;Hello
World&rdquo; on the Palm Pilot.</p><p><a href="3782l2.html" target="_self">Listing 2</a></p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x1c13790"></a>Building the Application</h2></div></div><p>The first step toward running an application on the Palm is
to build the resources. As mentioned earlier, we can build the
resources using the command pilrc.</p><pre     class="programlisting">
pilrc hw.rcp
</pre><p>To add the bitmap with ID 10 to the main form, I used a tool
that converts ppm files to Tbmp<span   class="emphasis"><em>xxx</em></span>.bin
resources. I used <span   class="bold"><b>xv</b></span> to convert
the format of peng.gif (found at
<a href="http://www.linux.org.il" target="_self">http://www.linux.org.il/</a>)
to black-and-white ppm format. Then I used
<span   class="bold"><b>ppmtoTbmp</b></span> on the peng.ppm file,
and named the result Tbmp000a.bin. The 000a in the file name is the
32-bit hexadecimal value for 10. I needed to specify this value
because this is the bitmap ID I wrote in the pilrc resource file
for the main form. This tool was written by Ian Goldberg, and it
can be found at
<a href="http://www.pilotgear.com" target="_self">http://www.pilotgear.com/</a>.
</p><p>The next step is to compile the C code. To do this, we use
the gcc m68-palmos-coff cross compiler, with the same flags as for
the normal Linux gcc:</p><pre     class="programlisting">
m68k-palmos-gcc -O2 -o hello hello.c
</pre><p>The result of this command is an m68k COFF object file named
hello. The m68k COFF object file should be combined with the
resources just created using the pilrc program. To complete this
mission, we first use the <span   class="bold"><b>obj-res</b></span>
utility that splits the COFF file into the code and data resources,
and then use the build-prc utility to combine resources.
<pre     class="programlisting">
m68k-palmos-obj-res hello
</pre>


This command will split the hello file into three resource files:
code0000.hello.grc, code0001.hello.grc and data0000.hello.grc. Now
we are ready for the final step of building the prc database.
<pre     class="programlisting">
build-prc hello.prc "hello" hwld *.grc *.bin
</pre>


This command builds a prc application with a creatorID
<b  >hwld</b> and type <b  >appl</b>.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1a580.0x200c010"></a>Testing the Application</h2></div></div><p>Testing the application on your Palm Pilot is not such a good
idea. A bug might require us to reset the machine, and programs
can't be debugged with the normal tools. The best way to test our
just-created &ldquo;Hello World&rdquo; application is with a program that
will emulate the Palm Pilot from within our desktop. POSE,
available from
<a href="http://www.palm.com" target="_self">http://www.palm.com/</a> with
source code included, is a very good emulator. It can use a special
debug ROM, also available from that site. With the debug ROM, we
can get more debugging information on our application, which makes
finding errors much easier, and we can hook gdb to it in order to
debug with this well-known debugging tool. To install POSE, you
will need the FLTK X toolkit. All instructions come with the POSE
tar file.</p><p>There is one more emulator for X, called
<span   class="bold"><b>xcopilot</b></span>. In order to use your own
machine RAM or ROM, you can use the pilot-link package. The
pilot-link package gives you the ability to communicate with the
Palm Pilot from the serial port. There are some good utilities in
this package, available from
<a href="ftp://ryeham.ee.ryerson.ca/pub/PalmOS" target="_self">ftp://ryeham.ee.ryerson.ca/pub/PalmOS/</a>.
Using the pilot-link utilities, we can also transfer databases from
our desktop to the Palm Pilot and from the Palm Pilot to the
desktop.</p><p>
<div       class="mediaobject"><img src="3782f1.jpg"><div class="caption"><p>Figure 1</p></div></div>
</p><p>Figure 1 is how POSE looks with our
<span   class="bold"><b>hello world</b></span> application for the
Palm.</p><p><a href="3782s1.html" target="_self">Resources</a></p><div class="blockquote"><blockquote class="blockquote"><p>Eddie Harari (eddie@sela.co.il) works for Sela
Systems &amp; Education in Israel as a senior manager and is
involved in some security projects. He has been hacking computers
for 13 years.</p></blockquote></div><p>All listings referred to in this article are available by
anonymous download in the file
<a href="../listings/073/3782.tgz" target="_self">ftp.linuxjournal.com/pub/lj/listings/issue73/3782.tgz</a>.</p></div></div>
<div class="authorblurb"><p>
        <div       class="mediaobject"><img src="3782aa.jpg"></div>
       </p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../073/toc073.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>