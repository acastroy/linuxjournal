<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Letters</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x1431580.0x1528ac0"></a>Letters</h1></div></div><div class="qandaset"><a name="N0x1431580.0x1528fe8"></a><h4 class="title"><a name="N0x1431580.0x1528fe8"></a>
Work the Shell Column, June 2015</h4><p>
In &ldquo;When Is a Script Not a Script?&rdquo;, Dave Taylor cautions that a loop like
<tt  >for f in *</tt> would have problems handling filenames
with spaces&mdash;for example, &ldquo;hello world&rdquo;. However, field separator processing is not performed on
the generated strings and <tt  >f</tt> would be properly set to
&ldquo;hello world&rdquo;.
</p><p>
In the two <tt  >find</tt> examples, the semicolons that terminate
the <tt  >-exec</tt>
clauses should have been quoted. Most likely a backslash was lost
between the author and the printer. In the first example (<tt  >-exec
chmod</tt>)
the &ldquo;plus&rdquo; terminator would have been a good alternative that would
not require quoting. Because the &ldquo;+&rdquo; terminator aggregates filenames
for fewer command executions, it would not be a good alternative for
the second example (<tt  >-exec echo</tt>).
</p><p>
Dave's use of the <tt  >file</tt> command to classify files with executable
permission is laudable. However, Dave's shell bias (shared by myself)
comes through as his code does not account for other scripting
languages, such as Awk or Perl.
</p><p>
The <tt  >file</tt> command looks for &ldquo;magic
strings&rdquo; to identify the file type. The strings
it knows about are listed in a file appropriately named
&ldquo;magic&rdquo;.
It is located in /usr/share/misc on my system and has its own man page,
<tt  >man -s 5 magic</tt>. My version of
<tt  >file</tt> can identify about 20
different scripting languages. They all report with the words
&ldquo;script&rdquo; and &ldquo;executable&rdquo;.
</p><p>
Compiled programs are also understood by <tt  >file</tt>. Rather than looking
for matching C source files, Dave could have checked the file
description for the words &ldquo;executable&rdquo; and &ldquo;ELF&rdquo; (Executable and
Linkable Format).

<br><br>&mdash;<br> 
Jon LaBadie  <br><br>
</p><p>
<span   class="bold"><b>Dave Taylor replies:</b></span> You raise some good
points here. Thanks for writing!
</p><a name="N0x1431580.0x1529d50"></a><h4 class="title"><a name="N0x1431580.0x1529d50"></a>
Scanning on Linux Distributions</h4><p>
Regarding Alan Lewis' letter in the June 2015 issue about printing and
scanning, I have found that Hewlett-Packard multifunction printers combined
with HP's excellent (free-to-a-good-home) HPLIP software fully supports
all printer functions over many years and three or four HP printers.
Currently, I have an HP OfficeJet Pro 8600: Ethernet interface, print,
automatic duplex print, scan, copy and fax (built-in telephone connection).
Everything works, works the way I expect, and I have zero problems. I also
have an older (about 12 years) HP Business Inkjet 2280tn with two trays
and Ethernet that is fully supported (it doesn't do much but print) by
HPLIP.
</p><p>
I bought a Canon Pixma iP 6310D a few years back. Zero Linux support from
Canon. It's a doorstop, and it's free to a good home if somebody wants to pay the
shipping.
</p><p>
HPLIP is generally included with most Linux distributions (mine is
Slackware). HP fixes any problems quickly (and adds new printer support), 
and installs and integrates with CUPS quickly and easily&mdash;just run
<tt  >hp-setup</tt> and
away you go.
</p><p>
Why go anywhere else, particularly manufacturers that don't provide Linux
support?

<br><br>&mdash;<br> 
Thomas Ronayne  <br><br>
</p><p>
Although I agree HP is usually good about Linux compatibility and Canon is
horrible, it's still always a good idea to check before buying.&mdash;Shawn
Powers
</p><a name="N0x1431580.0x152a220"></a><h4 class="title"><a name="N0x1431580.0x152a220"></a>
Typo in the June 2015 Issue</h4><p>
The <tt  >find</tt> command at the bottom of page 11 in the
Letters section is wrong [see the &ldquo;Pipes and
Xargs&rdquo; letter]:

<pre     class="programlisting">
find / -name "*.mp3' -exec rm '{}' \;
</pre>
</p><p>
It should be this:

<pre     class="programlisting">
find / -name "*.mp3" -exec rm '{}' \;
</pre>
</p><p>
The quotes must match.

<br><br>&mdash;<br> 
Alan Olsen  <br><br>
</p><p>
You are, of course, correct. I suspect Richard's right pinky is a little
quicker than his left, and Shift wasn't pressed in time! (As far as me not
catching the error, sadly I don't have a crafty excuse for that.) Thanks,
Alan.&mdash;Shawn Powers
</p><a name="N0x1431580.0x152a7a0"></a><h4 class="title"><a name="N0x1431580.0x152a7a0"></a>
A New Algorithm</h4><p>
The following may be of interest to your readers:


<pre     class="programlisting">

/* AN ALGORITHM TO FACTOR PQ PRIMES

The following is an algorithm to factor pq into the 
individual primes p and q that were multiplied 
together to form pq. It is not required to know any 
primes in the beginning and no divisions are required.

Input the number pq to begin and take the square 
root of pq.
Insure the square root is negative by subtracting 1 
if required.
Set the variables p and q equal to the negative 
square root.
Decrement p by 2 and increment q by 2.
Set up a continuous loop.
Set variable a equal to p*q.
Set up for/next loop which will terminate when a 
becomes greater than pq.
Within the for/next loop:
Add p to a.
Increment q.
When a and pq are exactly equal terminate the 
for/next loop and goto end of program.
When the for/next loop terminates because a is 
greater than pq decrement q by 1 and
decrement p by 2 then goto the beginning of the 
continuous loop.
When a and pq are equal and the program terminates 
p will be the original p prime
used to form pq and q will be the other prime. */

#include &lt;stdio.h&gt;
long long i,pq,x,y,sr,a,m,p;
int main(void)
{
/* pq = 299; */
/* pq = 989; */
/* pq = 7957; */
/* pq = 16972174847; */
/* pq = 52364476296131; */
pq = 2549809323176597;
/* pq = 29837383766136799; */
/* pq = 303703809540747433; */
/* pq = 1043931805398125881; */
/* pq = 2786765675348933501; */
/* pq = 18446744073709551617ll; */

printf("pq = %llu\n",pq);

/* Routine to calculate sr, the square root */
m = sr = p = 1;
while(m &lt;= pq) { p += 2; m += p; sr++; }
if((sr % 2) == 0) sr--;  /* If the square root is even,
                          * make sure it is odd */
x = y = sr;

printf("sr = %llu\n", sr);

/* Adjust x and y to skip the first loop iteration since
 * a square area cannot equal a rectangular area */
x -= 2;
y += 2;
Loop:

a = x*y;  /* Set a equal to the area to expand 
           * toward the area of pq */

/* The for loop expands area a toward area pq by 
 * multiple values of x until either they are equal
 * or area a is larger than pq */
for(i = 0; a &lt; pq; i++) {
    a += x;
    y++;
    if(a == pq) goto End;
    }

/* If a and pq are not equal, decrement x by two for 
 * the next try and remove the excess y count 
 * caused by the for loop */
y--;
x -= 2;


goto Loop;

End:

printf("The rectangle pq has prime sides %llu and %llu.\n",x,y);
return 0;
}

</pre>

<br><br>&mdash;<br> 
Glen A. Dobbs  <br><br>
</p><p>
Glen, I hope I wasn't just &ldquo;Rick Rolled&rdquo;, because your math and scripting
are beyond my ken. I'm sure others will appreciate the script though. Thank
you!&mdash;Shawn Powers
</p><a name="N0x1431580.0x152ac70"></a><h4 class="title"><a name="N0x1431580.0x152ac70"></a>
A General Issue with GUIs</h4><p>
Some GUIs, before initiating an action, present the user with check boxes
for &ldquo;OK&rdquo; and &ldquo;Cancel&rdquo;, in that order. Others in the same situation
present the user with boxes for &ldquo;Cancel&rdquo; and
&ldquo;OK&rdquo;, in that order.
Once in a while, out of habit, I punch the unintended box. This could
be a Very Bad Thing if I meant to punch &ldquo;Cancel&rdquo; and instead punched
&ldquo;OK&rdquo;. This is one case where we need an autocrat to dictate that only
a specific style may be used. 

<br><br>&mdash;<br> 
Jim Haynes  <br><br>
</p><p>
I <span   class="emphasis"><em>totally</em></span> feel your pain, Jim! I have no solution, nor do I have the
global influence to fix such things, but there should be an IEEE standard
for dialog boxes!&mdash;Shawn Powers
</p><a name="N0x1431580.0x1836008"></a><h4 class="title"><a name="N0x1431580.0x1836008"></a>
Scanning Tips for Linux</h4><p>
I may have part of a solution for Alan McConnell's difficulties with his
Canon scanner (see the Letters section in the June 2015 issue). Based on the description of the problem
that he sent to Canon, I suspect he has permissions issues (a problem I have
become quite familiar with using my HP printer/scanner). Try changing the
ownership of the device files located at /dev/bus/usb/xxx/yyy where you
replace
xxx and yyy by the two numbers shown after libusb (in Alan's post, that
would
be 003 and 004). By default, these devices are owned by root; you need to
have
ownership of the files yourself (unless you don't mind making them
world-read and
writeable, which is probably a bad idea). Once you have fixed the
ownership,
running <tt  >sane-find-scanner</tt> should return the human-readable version of the
vendor and product information.
Hope this helps!


<br><br>&mdash;<br> 
Greg Mahlon  <br><br>
</p><a name="N0x1431580.0x1836320"></a><h4 class="title"><a name="N0x1431580.0x1836320"></a>
Erratum</h4><p>
In the June 2015 issue, in my &ldquo;Doing Stuff with Docker&rdquo; article, I wrote this:

<pre     class="programlisting">
sudo docker run -d --net="host" \
-v /mnt/docker/plex:config \
-v /mnt/videos:data \
-p 32400:32400 \
timhaak/plex
</pre>
</p><p>
But, it should be this:

<pre     class="programlisting">
sudo docker run -d --net="host" \
-v /mnt/docker/plex:/config \
-v /mnt/videos:/data \
-p 32400:32400 \
timhaak/plex
</pre>
</p><p>
(There should be slashes after the colons.)
</p><p>
I apologize for any frustration.

<br><br>&mdash;<br> 
Shawn Powers  <br><br>
</p><a name="N0x1431580.0x18367f0"></a><h4 class="title"><a name="N0x1431580.0x18367f0"></a>
Linux Drivers for Canon and Other Unsupported Scanners</h4><p>
VueScan, a non-FOSS, non-free ($75) scanner program, may restore
functionality to Canon and other scanners lacking drivers for Linux (or
Windows 7). I've used the program to restore functionality to a Nikon
LS-5000 slide scanner at work (unsupported in Windows 7) and an older Epson
scanner at home (no Linux driver). The program was easily worth the $150 for
the two licenses. Free trials are available from the publisher:
<a href="http://hamrick.com" target="_self">hamrick.com</a>.
</p><p>
I am pleased that the Linux desktop market is large enough to attract
developers. Most of the software I use is free and open source. There is
also room on my Linux desktop for non-free, closed software.
</p><p>
<span   class="bold"><b>Update:</b></span> I just double-checked and see that the price of the
professional license for VueScan has gone from
$75.00 to $89.00 and includes free upgrades for life. The software supports
Macs as well as Linux and Windows.

<br><br>&mdash;<br> 
Steve Johnson  <br><br>
</p><p>
I can second Steve's support for VueScan. The devices it supports work
very, very well with it.&mdash;Shawn Powers
</p><a name="N0x1431580.0x1836cc0"></a><h4 class="title"><a name="N0x1431580.0x1836cc0"></a>
Re: June 2015 Letters&mdash;Canon MF4770n and SANE</h4><p>
The sane-pixma back end is supposed to support the Canon MF4770n on USB
and Ethernet. SANE's Web site says the status is &ldquo;good&rdquo;, which I assume
means that SANE works with the MF4770n, but not all of the device's
features are available.

<br><br>&mdash;<br> 
Neal   <br><br>
</p><a name="N0x1431580.0x1836f80"></a><h4 class="title"><a name="N0x1431580.0x1836f80"></a>
January 2015 Issue</h4><p>
I admit that I am way behind on my reading, but I just finished the January
2015 issue, and I am excited to try some things.
</p><p>
I read Jeramiah Bowling's article &ldquo;How to Perform an Internal Security
Review&rdquo;, and I was thinking that it would be a cool thing to try just on my
home network.
</p><p>
Then it occurred to me that in the same issue Shawn Powers wrote &ldquo;Vagrant
Simplified&rdquo;, and then the light bulb went on for me. I went looking, and
sure enough, there is a Vagrant box for Kali Linux.
</p><p>
I haven't gotten any further than that, but the Vagrant box is downloading
now, and soon I expect to be able to follow Jeramiah's steps in my own
environment.
</p><p>
Thanks for a great set of articles!

<br><br>&mdash;<br> 
Werner   <br><br>
</p><p>
Awesome! I love when our various articles complement each other. Have fun,
Werner!&mdash;Shawn Powers
</p><a name="N0x1431580.0x18374a8"></a><h4 class="title"><a name="N0x1431580.0x18374a8"></a>
Erratum, II</h4><p>
First, congratulations for the great work! In Shawn Powers' &ldquo;Gettin'
Sticky with It&rdquo;, in the June 2015 Upfront section, he uses the
example <tt  >ls -l /bin/ping</tt> to show the SUID set
in the permissions string, but in Fedora 22 and CentOS, it isn't there,
because it's not defined by a permission, but by a capability. In the
<tt  >ping</tt>, if you use the <tt  >getcap</tt>
command, it will return the following capabilities:

<pre     class="programlisting">
cap_net_admin,cap_net_raw+ep
</pre>
</p><p>
For more info about them, see <tt  >man
capabilities</tt>.
Thanks!

<br><br>&mdash;<br> 
Adail   <br><br>
</p><p>
Gosh darn progress! Back in my day, our binaries were SUID, and we liked it!
Seriously though, thanks for the info. I didn't check all major distros,
and I probably should have done so.&mdash;Shawn Powers
</p><a name="N0x1431580.0x1837a28"></a><h4 class="title"><a name="N0x1431580.0x1837a28"></a>
More on &ldquo;Gettin' Sticky with It&rdquo;</h4><p>
In response to the question that Shawn Powers had about the sticky bit [see
the June 2015 Upfront section], its
original use had no effect on directories (folders). Instead, it was used
on executable files (compiled programs, to be specific), so that when the
program was run, its text area would &ldquo;stick&rdquo; in the swap
space. So &ldquo;t&rdquo;
stands for &ldquo;text&rdquo;. This also explains the origin of the term
&ldquo;sticky bit&rdquo;.

<br><br>&mdash;<br> 
Mark Iszler  <br><br>
</p><p>
Cool info Mark, thanks!&mdash;Shawn Powers
</p><a name="N0x1431580.0x1ab4f00"></a><h4 class="title"><a name="N0x1431580.0x1ab4f00"></a>
Hacking a Safe with Bash</h4><p>
I know it's late June and I'm responding to an article from the May 2015
issue&mdash;sometimes I have more magazine than month and I get
behind&mdash;but I
wanted to comment on a few things that jumped out at me when reading this
fine article [see Adam Kosmin's &ldquo;Hacking a Safe with Bash&rdquo;].
I did learn a thing or two, and the focus of the article was
not shell script programming, but ...
</p><p>
I write a lot of shell scripts in my job and off hours, and when I write a
production-level script, my goal is portability and safety.
</p><p>
1) Even though the article was focused on using the Bourne-Again shell,
there was nothing there that really needed any of that shell's
advanced features, and I would opt for the Bourne shell (/bin/sh), which
every POSIX-compliant system <span   class="emphasis"><em>must</em></span> have. For this
script, it would
just be translating all <tt  >$(...)</tt> constructs to back
ticks <tt  >`...`</tt> and a
few other changes. On many systems, /bin/sh is either a link to /bin/bash,
/bin/dash or /bin/ash, which all understand the Bourne shell syntax as a
subset.
</p><p>
2) The Bourne shell (and Bash) has special <tt  >${}</tt> constructs for setting a
default value if the given environment variable doesn't exist&mdash;for
example, 
<tt  >SOURCE_DIR=${SOURCE_DIR:-$HOME/safe}</tt>.
</p><p>
3) Instead of <tt  >tar</tt>, I would use
<tt  >cpio</tt>, which works &ldquo;natively&rdquo; with
<tt  >find</tt>
and <tt  >xargs</tt>, and is designed to archive a list of files passed in via stdin.
I would also use the <tt  >-0</tt> for each, which is a useful GNU-ism for delimiting
the filenames with the NULL character and allows the use of filenames
with spaces.
</p><p>
4) I notice a number of &ldquo;rm&rdquo;s after some action is performed. This is
probably the thing that caught my attention the most. If the action
failed,
the script would be wiping out the safe directory or file contents,
losing everything! In all such cases, I would append the
<tt  >rm</tt> command to the
previous action with the <tt  >&amp;&amp;</tt> control operator or onto a test for the
existence of a non-zero-file-length safe file or directory existence&mdash;something that would give that warm fuzzy feeling that the action
succeeded.
</p><p>
5) All the commands used, like <tt  >rm</tt>,
<tt  >tar</tt> and <tt  >shred</tt>, are not fully
qualified,
so the first executable found in the PATH list will be used. This can lead
to a hacker placing a rogue executable script to intercept, log or screw
with your actions. So I make variables for all the commands I
use&mdash;for example,
<tt  >RM=/bin/rm; TAR=/bin/tar;</tt> and so on. 
For executables that may not be in the same location of differing systems,
you can quickly test the few likely paths and set the variable accordingly.
</p><p>
I found the article useful, and I'll probably hack my own version soon.
Thanks for the fine article.

<br><br>&mdash;<br> 
R.K. Owen  <br><br>
</p><p>
<span   class="bold"><b>Adam Kosmin replies:</b></span> All great stuff. Would you be willing to send a PR
(<a href="https://github.com/windowsrefund/safe" target="_self">https://github.com/windowsrefund/safe</a>)?
</p></div><div class="sidebar"><p class="title"><b>Write <span   class="emphasis"><em>LJ</em></span> a Letter</b></p><p>
We love hearing from our readers. Please send us your comments and
feedback
via
<a href="http://www.linuxjournal.com/contact" target="_self">www.linuxjournal.com/contact</a>.
</p></div><div class="sidebar"><p class="title"><b>Photo of the Month</b></p><p>
Remember, send your Linux-related photos to
<a href="mailto:info@linuxjournal.com">info@linuxjournal.com</a>!
</p></div></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../256/toc256.html">Issue Table of Contents</a>
    <a class="link3" href="../256/11881.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>