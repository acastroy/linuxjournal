<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Xen</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Xen is a hypervisor virtual machine that runs multiple open-source&#10;operating systems.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x17dd580.0x18d4ab0"></a>
Xen</h1></div><div><div class="author"><h3 class="author">
Irfan
 
Habib
</h3></div><div class="issuemoyr">Issue #145, May 2006</div></div><div><p>
Xen is a hypervisor virtual machine that runs multiple open-source
operating systems.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18d52f0"></a></h2></div></div><p>
In the last half century, microcomputers have become increasingly
powerful. Server systems have grown so powerful, that many enterprise
servers typically are underutilized. Modern computers are sufficiently
powerful to use virtualization to present the illusion of running
many virtual systems on a single machine. Each virtual system runs
a separate operating system instance simultaneously. So, you can run
multiple instances of Linux at the same time on the same machine, or
you can run combinations of operating systems, such as Linux, FreeBSD, Windows
and so on. This has led to a resurgence of interest in Virtual Machine
(VM) technology,
which has been around for decades on bigger iron.
</p><p>
The Systems Research Group at the University of Cambridge Computer
Laboratory originally developed Xen (open-source virtualization software) as part of the XenoServers Project, funded by the UK-EPSRC.
</p><p>
XenoServers aims to provide a &ldquo;public infrastructure for global
distributed computing&rdquo;. Xen plays a key part in that project, allowing
users to partition a single machine efficiently to enable multiple
independent clients to run their operating systems and applications
in an environment. See
<a href="http://www.cl.cam.ac.uk/xeno" target="_self">www.cl.cam.ac.uk/xeno</a> for more information on the
XenoServers Project.
</p><p>
Xen is an x86 virtual machine monitor that allows multiple commodity
operating systems, such as Linux and MS Windows, to share conventional
hardware in a safe and resource-managed fashion. It is designed with
minimal performance overhead. As a result, the virtualized instances of
operating systems have close to native performance. The Xen folks achieve
this by providing a virtual machine abstraction to which operating
systems,
such as Linux and MS Windows, can be ported with minimal effort. Xen has,
according to a number of benchmarks, considerably out-performed competing
commercial and freely available solutions.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18d5558"></a></h2></div></div><div class="sidebar"><p class="title"><b>XenSource</b></p><p>
Xen is such an effective means of lowering total cost of ownership through
virtualization that the original Xen development team launched a
consulting
business based on the project. See XenSource
(<a href="http://www.xensource.com" target="_self">www.xensource.com</a>),
which is considered &ldquo;home to the worldwide Xen
open source community&rdquo;.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18d5768"></a>
Applications of Xen</h2></div></div><p>
One of the major uses of Xen so far has been for consolidation of
servers. An organization can shift server software hosted on multiple
physically separate servers and locate them onto a single server, by
using virtual machines for each individual server. For example, it is
now possible for a company to host Sendmail on a FreeBSD installation
while hosting the Apache Web server on Red Hat Enterprise Edition, both
on the same physical server.
</p><p>
This enables enterprises to reduce their total cost of ownership by using a few servers to do tasks that used to require many
servers. Server consolidation also makes it easier to manage systems.
</p><p>
Xen can enable the development of distributed Web services. This gives
users the perception that services are hosted on separate systems,
but they, in fact, are hosted on the same physical system. This leads to huge
savings in IT budgets in deploying service-oriented applications and
provides a platform for hosting other network-centric applications.
</p><p>
Xen has been a boon in operating system research. Through Xen, it
is now possible to implement new kernel-level algorithms and test them
in a virtual environment without affecting the host OS. In Linux
kernel development, employing user-mode Linux is popular; however, Xen
has out-performed user-mode Linux in a number of benchmarks.
</p><p>
Xen's virtualization capabilities have enabled organizations to keep
their servers available 24/7. Organizations can launch a temporary
virtual server to keep services available while patching and upgrading
an OS on the virtual server they normally use to provide those
services.
</p><p>
Xen also enables organizations to run legacy applications on new hardware,
protecting their past investments.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18d5a28"></a>
Comparison to Other Approaches</h2></div></div><p>
Now that we have a taste of the potential applications and advantages Xen
offers, let's briefly look how it compares to other approaches
and explore some salient features of its internal workings.
</p><p>
Hosting different operating systems in single server is nothing new. Many
desktop PCs nowadays are dual-boot systems, where at least two different
operating systems are installed in a single machine, each running a set
of software specific to each.
</p><p>
When users require both operating systems to run at the same time,
there are several options. They can get two computer systems and dedicate
each system to each service. They can use an emulator such as Wine or
Win4Lin to run services from MS Windows on Linux, or use CoLinux to run
unmodified Linux services on MS Windows.
</p><p>
However, these approaches have certain drawbacks. Getting
two servers to host two services is inherently expensive and would lead
to underutilization of resources. Wine, Win4Lin or other emulators often
have performance, scalability and compatibility problems.
</p><p>
So, the best solution in many cases is to run virtual machine software
on a single machine and host both operating systems at once on the
same machine.
</p><p>
Proprietary virtualization systems exist, such as VMware Workstation [see
page 56 for Mick Bauer's review of VMware Workstation 5.5].
Software, such as VMware, implements what is called full virtualization.
VMware virtualizes every aspect of the computer. VMware, therefore, introduces a good deal of overhead. The concurrent operating systems
often run more slowly than usual. As hardware becomes cheaper
and more powerful and software becomes more optimized, this lag
in performance may not be noticeable in the future, but currently it poses
a problem.
</p><p>
VMware does have enterprise-level commercial products, such as ESX
Server,
which have better performance than the VMware Workstation product,
and such a product may be able to run virtualized operating systems close to their
native performance. However, benchmarks of this product are not
available,
and VMware Workstation consistently has under-performed Xen in various
benchmark tests.
</p><p>
VMware's approach does have one large advantage over Xen's approach.
VMware is capable of virtualizing proprietary operating systems. As
I discuss later in this article, you have to port an operating system's
kernel to Xen for it to work with Xen. You cannot run an operating
system on Xen otherwise.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18d5d98"></a>
Hypervisor</h2></div></div><p>
Xen is a virtual machine hypervisor. That is, it doesn't
run on any OS, it makes an OS run on it! Xen runs at the highest priority
level the x86 architecture allows (called Ring 0). It makes the OS get
the second-highest priority in x86 architecture (called Ring 1).
</p><p>
Xen provides certain libraries to which the OS kernel has to be ported
in order to work with Xen. Porting an OS to run on Xen is similar
to porting the OS to a new hardware platform; however, the process is
simplified because the paravirtual machine architecture is very similar
to the underlying native hardware. Although the kernel has to be ported,
Xen does not require any modification to user applications, which
can run unaltered on a Xen system.
</p><p>
So far, only open-source operating systems have been ported to Xen. Unless
Microsoft releases a Xen-enabled Windows version, we might not get the
benefit of a completely virtualized MS Windows. So far, Linux ports are
available, and FreeBSD, NetBSD and Solaris 10 ports are underway.
</p><p>
The developers of Xen had to overcome some major challenges to
partition successfully a modern machine's resources amongst multiple guest
operating systems. First, virtual machines had to be isolated from one
another&mdash;that is, problems in one machine must not affect the working of
other virtual machines. Second, it was necessary to support a variety of
different operating systems to accommodate the heterogeneity of popular
applications, such as enterprises commonly using a mix of Linux and MS
Windows installations to support their working. Third, the performance
overhead introduced by virtualization should be small. Xen's approach
addresses each one of these challenges successfully.
See &ldquo;Xen and the Art of Virtualization&rdquo; at <a href="http://www.cl.cam.ac.uk/Research/SRG/netos/papers/2003-xensosp.pdf" target="_self">www.cl.cam.ac.uk/Research/SRG/netos/papers/2003-xensosp.pdf</a>,
which discusses Xen's approach in detail.
</p><p>
We'll go through some salient features of Xen's approach.
</p><p>
As stated earlier, Xen is a hypervisor that uses paravirtualization,
when an operating system is ported to Xen. Xen has access to some
internal OS kernel information in order to manage the system. This
porting also gives the guest OS kernel access to real as well as
virtual information, which has specific advantages for time-critical
tasks. Paravirtualization permits very high-performance virtualization,
even on architectures like x86 that don't inherently support
virtualization.
</p><p>
Paravirtualization enables Xen to multiplex physical resources at
the granularity of an entire operating system and is able to provide
performance isolation between each VM. This also allows a range of
guest operating systems to coexist, without having any effect
on each other. Xen's paravirtualization approach allows users to run
applications in a resource-controlled fashion. Furthermore, it provides an
extremely high level of flexibility, because users can create dynamically
the precise execution environment their software requires. Unfortunate
configuration interactions between various services and applications
are avoided.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18d6108"></a>
Try It Yourself</h2></div></div><p>
As mentioned previously, Xen is primarily developed for the x86 architecture;
however, it does not support all x86-based processors&mdash;only those
that are P6
or newer, including Pentium Pro to Pentium 4 and Intel Celeron
and Intel Pentium Xeon processors. Apart from Intel, AMD processors from
Athlon to AthlonXP and FX processors are supported, as well as the AMD Duron.
</p><p>
Interested readers may want to try out Xen for themselves, without
installing the entire system.
The Xen Project provides a live CD demonstration of Xen, which comes
with both Debian and CentOS. The live CD version can be a powerful tool
for demonstrating the features of Xen. It is possible to boot in to any of the
provided distributions and start new instances of either distribution,
as many times as the system memory allows.
</p><p>
It is also possible, in the live CD version, to monitor the resource usage of all
virtual machines in real time and start applications in each virtual
machine.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18d62c0"></a>Installing Xen</h2></div></div><p>
For power users who want to get down to installing Xen, the following is
a brief guide.
Installing Xen is a three-way process. You install Xen and its user-level
tools, then configure your bootloader and, finally, define the VM configuration
files for each guest OS.
</p><p>
Installing from binary tarballs or an RPM package is the easiest way to
install Xen. For binary tarballs, simply do this:

<pre     class="programlisting">

bash# tar zxvf xen-3.0-install.tgz
bash# cd xen-3.0-install
bash# sh ./install.sh

</pre>
</p><p>
For an RPM package, do this:

<pre     class="programlisting">

bash# rpm -iv xen-3.0-i686.rpm

</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18d6528"></a></h2></div></div><p>
(or whatever the name of the RPM is).
</p><p>
Installing Xen from source is more complicated, as it involves patching
and recompiling the Linux kernel. Installing from source
is not covered in this article, and is described thoroughly in the Xen User
Manual
(<a href="http://www.cl.cam.ac.uk/Research/SRG/netos/xen/documentation.html" target="_self">www.cl.cam.ac.uk/Research/SRG/netos/xen/documentation.html</a>).
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18d66e0"></a>
Configuring the Bootloader</h2></div></div><p>
After Xen has been installed, we need to configure the bootloader.
For GRUB users, edit the menu.lst file, and add this entry:

<pre     class="programlisting">

title Xen
kernel /boot/xen-3.0.gz dom0_mem=32768 module
--&gt;/boot/vmlinuz-2.6-xen0 root=/dev/hda7 ro console=tty0

</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18d6840"></a></h2></div></div><p>
vmlinuz-2.6-xen0 is the kernel image that would have been
installed by the tarball binaries or RPM; if you install from source,
replace the name of the image here.
</p><p>
Also be sure to replace the name of the root filesystem to suit
your system (in this example, it is root=/dev/hda7).
</p><p>
For LILO users, do the following:

<pre     class="programlisting">

image="/boot/xen-3.0.gz
label="Xen"
root="/dev/hda7"
read-only
append="dom0_mem=32768"

</pre>
</p><p>
After Xen has been installed and configured, you are now ready to boot
in to Xen and start your first virtual machine.
</p><p>
After rebooting and starting your Xen installation, which resembles
a normal Linux startup, log in to Domain0. That is the most-privileged domain in a Xen system.
</p><p>
From here, users can create virtual machines that
will run guest operating systems, and start and stop virtual machines.
</p><p>
To create a new virtual machine, you need to define a
configuration file for it. Xen comes with two default configuration
files in the /etc/xen directory named xmexample1/ amd xmexample2/. The
configuration files contain many parameters, but fortunately, many of
them are optional. You need only a few configured parameters to get your virtual
machine running. Some important parameters include:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Kernel: which kernel to boot.
</p></li><li><p>
Root: the root filesystem.
</p></li><li><p>
Disk: on which disk partition the system is installed.
</p></li><li><p>
Memory: define how much memory the virtual machine should use.
</p></li></ul></div><p>
A sample configuration file may look like this:

<pre     class="programlisting">

kernel = '/boot/vmlinuz-2.6.12.6-xen'

disk = [ 'phy:hda1,hda1,w' ]

root = '/dev/hda1 ro'

memory = 128

</pre>
</p><p>
After declaring a configuration file for the virtual machine, you can
boot up the machine by typing the following:

<pre     class="programlisting">

bash# xm create -c /root/myOSconf vmid=1

</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18cd8b8"></a></h2></div></div><p>
where myOsconf is the name of the configuration file.
</p><p>
After this, a new window will pop up, and you will see a normal Linux
startup until you reach the login screen, and from there you can enjoy your new guest OS.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x17dd580.0x18cda18"></a>
Conclusion</h2></div></div><p>
Xen is mature, open-source virtualization software that creates many new
opportunities for organizations in reducing their total cost of ownership
and providing more dependable and high-availability applications.
Commodity x86-based systems provide all of this, with a minimum cost
of porting an operating system to Xen.
</p><p>
The developers of Xen have tested Xen against other popular
virtualization solutions, such as VMware Workstation and user-mode Linux.
In all tests conducted, Xen out-performed the other
approaches&mdash;in standard benchmark tests, such as Spec Int200,
Spec Web99, dbench and many more. The results were published
in a research paper, available at
<a href="http://www.cl.cam.ac.uk/Research/SRG/netos/papers/2003-xensosp.pdf" target="_self">www.cl.cam.ac.uk/Research/SRG/netos/papers/2003-xensosp.pdf</a>.
</p></div></div>
<div class="authorblurb"><p>
Irfan Habib has been an open-source enthusiast for five years. He has
great
interest in distributed computing technologies, in which he does
full-time research, and he loves to explore new solutions to common problems
in computing. Comments can be sent to
him at <a href="mailto:irfan.habib@gmail.com">irfan.habib@gmail.com</a>.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../145/toc145.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>