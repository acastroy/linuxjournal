<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Control Your Home with Vera from Mi Casa Verde
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Use Vera, a Z-Wave-based product, to automate your home, and&#10;let the computer turn the lights on and off for you.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x28ea580.0x29e1ac0"></a>
Control Your Home with Vera from Mi Casa Verde
</h1></div><div><div class="author"><h3 class="author">
Daniel
 
Bartholomew
</h3></div><div class="issuemoyr">Issue #181, May 2009</div></div><div><p>
Use Vera, a Z-Wave-based product, to automate your home, and
let the computer turn the lights on and off for you.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x28ea580.0x29e22a8"></a></h2></div></div><p>
Automating your home is one of those ideas that has been
around forever. The idea is older than the light bulb, which was itself
a form of automation&mdash;no more lighting gas lamps or candles manually,
simply flip a switch.
</p><p>
We humans are a lazy bunch&mdash;even a simple action like flipping a switch
became not easy enough&mdash;so various devices and technologies have
appeared over the years to automate lights and
other electrical devices. The type of devices available to control your
house basically can be split into two categories: professionally installed
and do-it-yourself.
</p><p>
For all home-control systems, there has to be a way to tell devices to
turn on and off. For professionally installed systems, this often means
the installation of extensive new wiring, which is fairly easy to put
into place if you are building a new house but can be very expensive
if you are trying to install a system into an existing house.
</p><p>
For the do-it-yourself crowd, the most popular system has been X10,
which sends signals over power lines. This has the advantage of not
needing any new wiring. You can build your system out slowly, and you
can do it yourself as long as you are reasonably technical. However,
X10 has several disadvantages. If you live in an apartment, for example,
and you and a neighbor are both using X10, the potential exists for
you to turn each other's lights on and off accidentally. Even in a
house, things might not work as expected, because sending signals over
power lines is problematic, and sometimes interference causes signals to
be lost or misdirected.
</p><p>
Z-Wave is a new automation technology that attempts to overcome the
limitations of earlier systems by utilizing wireless mesh
networking. Each
Z-Wave device acts as both a transmitter and a receiver. Any signals
it receives are retransmitted automatically. Additionally, whenever it
acts on a command, a Z-Wave device sends out a reply message letting
the controller know that it acted.
</p><p>
Like X10, Z-Wave lets you automate your home a few devices at a time, which
allows you to spread the cost over a longer period, rather than having to pony up a lot
of cash up front. There's nothing stopping you from doing it all at once
or even from hiring a professional to do it for you, but you don't have to.
</p><p>
The main problem that Z-Wave has, which is common to all home-control
systems, is it can be complicated to set up.
</p><p>
One new Linux-powered product, the Vera from Mi Casa Verde, advertises
itself as a Z-Wave home-control gateway that anyone can set up. To test
that claim, I gave an unopened Vera and several Z-Wave modules to a
nontechnical test user, and asked the user to set it up.
</p><div       class="mediaobject"><a href="10302f1.large.jpg"><img src="10302f1.jpg"></a><div class="caption"><p>
Figure 1. The Vera doesn't come with much, just the main box, a
dongle, a power brick and an Ethernet cable. In the background are some
Z-Wave modules.
</p></div></div><p>
The Vera comes with a four-page printed setup guide that walks you through
plugging the Vera in and connecting to it for the first time. When it
is first turned on, the Vera tries to connect to your home network using
DHCP. As the test user knows next to nothing about switches, routers, Ethernet
or DHCP, and never has needed to, I had to assist with this. 
I helped the user
plug the Vera in to a free spot on a switch, and the user powered it on.
</p><p>
The documentation at this point states that you should wait a couple
minutes after turning the Vera on so that it can boot and announce its
presence to the findvera.com Web site. After waiting, all you have to
do is go to <a href="http://findvera.com" target="_self">findvera.com</a> and click on the big green Setup Vera
on my home network button. The user did this and was able to connect to
the Vera Web interface.
</p><div       class="mediaobject"><a href="10302f2.large.jpg"><img src="10302f2.jpg"></a><div class="caption"><p>
Figure 2. When connecting to Vera, you don't have to know
the IP address, simply go to findvera.com and it will connect you.
</p></div></div><p>
So far so good. The Vera was plugged in, and the user was able to connect to
the Vera without knowing what address it had been assigned
by my home router. This integration is slick and makes connecting easy.
</p><p>
The next step in the printed documentation has a screenshot of what you
should see after you connect to Vera for the first time. However, when the
user
connected the first time, the Vera went to the firmware upgrade
screen instead of the initial setup screen. The user found this confusing.
The printed documentation should state that the firmware
upgrade screen might appear and what to do about it before continuing with
the initial setup. Or, the Vera should have realized that it was not set up
and waited until it was before prompting to upgrade the firmware.
</p><p>
Upgrading firmware on the Vera is easy, and it prompts you to make a
backup of your settings before starting, which is a nice touch. However,
it is not a process the user was comfortable doing, so 
I finished that step before we moved on.
</p><div       class="mediaobject"><a href="10302f3.large.jpg"><img src="10302f3.jpg"></a><div class="caption"><p>
Figure 3. Backing up the Vera configuration is simple.
Restoring also is easy.
</p></div></div><p>
After updating the firmware and rebooting the Vera, the user connected again,
and this time, instead of seeing the setup screen, the Vera went to the
Dashboard. This screen is supposed to appear automatically after setup,
and it provides a single screen from which to control your devices. It is
not what the user expected to see, so the user wasn't quite sure what to
do since the page was basically blank (nothing had been set up yet at
this point). I directed the user to the setup link at the top right of the
screen and after clicking on it, the screen appeared that the
printed documentation said you should see.
</p><div       class="mediaobject"><a href="10302f4.large.jpg"><img src="10302f4.jpg"></a><div class="caption"><p>
Figure 4. The Dashboard serves up all of your devices on a
single page for easy control.
</p></div></div><p>
At this point, the printed documentation basically ends (apart from
some network troubleshooting information), and the Vera relies on
embedded YouTube videos to talk you through what to do next and how to
set things up. These videos play automatically by default, which the user
found useful. This autoplay feature can be turned off by unchecking the
Autoplay button.
</p><div       class="mediaobject"><a href="10302f5.large.jpg"><img src="10302f5.jpg"></a><div class="caption"><p>
Figure 5. Helpful videos play automatically to walk you through
the initial setup of the Vera.
</p></div></div><p>
The basic sequence of events for this initial setup is to walk your
way from top to bottom through the buttons on the left-hand side of
the Vera Web interface. The first step (apart from the Intro section)
the Vera asks you to complete is to set up an account on findvera.com, so
you can connect to your Vera from anywhere in the world. The use
of this remote-access service is free for the first 90 days and costs
$7.95/month after that. The on-line documentation does state that the
service is optional, and it even points out that you can set up external
access yourself if you want to. The Web GUI doesn't mention any of this
(you have to click on a &ldquo;learn more&rdquo; link to get the
information), so I
just told the user to skip to the next section.
</p><p>
The next step, and the first real one in my opinion, is to create
&ldquo;Rooms&rdquo;. This is so the Vera can organize your devices
logically. The user
found this step easy and did not need any help from me. The embedded
video on this page even helpfully suggests that if you have outdoor
devices, you should just think of them as rooms to keep things simple.
</p><p>
The next step is to add actual Z-Wave devices to the Vera. Devices range
from simple lamp and appliance modules (lamp modules are dimmable, and
appliance modules are not), to motion detectors, automatic blinds and
thermostats. Lamp and appliance modules come in several varieties, from
small boxes that you plug in to wall outlets, to actual in-wall outlets and
light switches that you install in place of the originals. Obviously, the
in-wall devices will give your room a cleaner, more professional look,
but they are harder to install. The Vera also can interface with some
non-Z-Wave devices, including IP cameras.
</p><p>
The basic sequence for adding new devices is as follows:
</p><div class="orderedlist"><ol type="1"><li><p>
Unplug the Z-Wave dongle from the back of the Vera.
</p></li><li><p>
Take the dongle over to the Z-Wave module that you want to add.
</p></li><li><p>
Press the button on the dongle (it will start to blink).
</p></li><li><p>
Press the button on the Z-Wave module (the dongle light will go solid
for a couple seconds to let you know it detected the button press).
</p></li><li><p>
Repeat steps 2&ndash;4 for any other modules you want to add.
</p></li><li><p>
Plug the dongle back in to the Vera.
</p></li></ol></div><p>
The steps were easy to understand for me, but they were not as easy for
the user. The confusion mainly centered around the terminology. For
example, the user was not familiar with the word dongle and wouldn't have
known what it was if the documentation hadn't included a picture and
mentioned that it was black. The user said the word dongle was about as descriptive 
as the words thingy and whatchamacallit. Even with this bit of confusion,
the user was able to add the devices without help, thanks to
the clear instructions.
</p><p>
Once the user added the devices and plugged the dongle back in to the Vera,
it was time to configure them. The user also found this difficult the first
time and asked for my help on the initial one.
</p><p>
You configure devices by setting up various &ldquo;scenes&rdquo;. Scenes are basically
groups of commands. An example would be &ldquo;set all lights in the family room
to 50% brightness&rdquo;, or &ldquo;turn all lights off in the master
bedroom&rdquo;. Once
you have set up a scene, you can call it quits, leave it as is and run
it manually at any time. However, the real power of the Vera comes when
you add timers and events to scenes.
</p><div       class="mediaobject"><a href="10302f6.large.jpg"><img src="10302f6.jpg"></a><div class="caption"><p>
Figure 6. The GUI for configuring scenes has a confusing button
layout.
</p></div></div><div       class="mediaobject"><a href="10302f7.large.jpg"><img src="10302f7.jpg"></a><div class="caption"><p>
Figure 7. You can Telnet to the Vera to get into the guts of
the device.
</p></div></div><p>
Timers let you run scenes at specified times, such as &ldquo;every Monday at
8pm&rdquo;, &ldquo;every 2 hours&rdquo; or &ldquo;on 12 June 2009 at
3:24am&rdquo;. Events let you run
scenes when a certain event occurs, such as &ldquo;whenever the doorbell
rings&rdquo;,
&ldquo;if the hall motion sensor is tripped&rdquo; or &ldquo;when the master bedroom light
switch is turned on&rdquo;. 
Once I walked through the process of setting
up an event and a timer, the user understood it and was able to add scenes,
timers and events.
</p><p>
You probably are noticing a pattern here. At nearly every step, the user got
stuck and came to me with questions. One thing the Mi Casa Verde folks could do
to alleviate at least some of this would be to show someone
actually completing the steps instead of just telling you how to do it. Perhaps
they also could have you configure a virtual room with virtual devices
that you can configure and play with. The fact that they are attempting
to simplify things to the point where anyone can automate a home is
a lofty goal, and I think they actually have succeeded in many ways, even
though I ended up doing most of the configuration.
</p><p>
The basic flaw is that Vera assumes you know what certain keywords
mean. You are expected to know what dongle, LAN, Wi-Fi, DHCP,
gateway, USB port and other terms mean. For a reasonably technical
person, those terms are easy, but for someone like the nontechnical user in
this example, such terms
might not be understood. For this user, a computer is just there&mdash;you
sit in front of it, type and click the mouse. The concepts of files,
applications and programs are needlessly complicated. To this user, there are
only tasks, such as &ldquo;check my e-mail to see if Sue has written back&rdquo;,
&ldquo;print this letter so I can mail it&rdquo;, &ldquo;watch a
video on YouTube&rdquo;,
&ldquo;see if check #1234 has cleared the bank&rdquo;, &ldquo;upload photos
from the party last night to Facebook&rdquo; and so on. The user has no desire to
move past that level of understanding. Vera and other products targeted at
everyone need to realize that even the phrase &ldquo;unplug the
dongle&rdquo;
might not be understood.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x28ea580.0x2ddc650"></a>
Issues</h2></div></div><p>
I found the Vera quite easy to set up and use overall. However, I did
run into several issues.
</p><p>
The Web interface is incomplete. Some sections do not have
an explanatory video or any other documentation. I'm sure documentation
is coming, but that doesn't help me right now.
</p><p>
Besides missing bits, the Web interface is also glitchy. It relies
on AJAX-style automatic form submission when you add devices, scenes,
events and so on. This works fine most of the time, but I ran into
problems a couple times where configuration changes I made were not
applied, and I had to enter them a second or even third time before they
&ldquo;took&rdquo;. The explanatory videos also stopped during playback several
times while the interface performed housekeeping on something or other.
</p><p>
Also, on at least two occasions during my testing, the Vera stopped
working altogether. During these incidents, the Web interface still
was responsive, and it acted like things were working, but none of the lights
would turn on or off when told to. I still could turn them on and off
via the buttons on the individual modules or by using my Z-Wave remote. A
reboot of the Vera solved the issue. I do appreciate the improvements the
firmware upgrades have provided, but I hope stability and reliability
are at the top of the list for the Vera developers, especially as I
continue to add more modules.
</p><p>
Finally, I ran into issues with the Vera doing crazy things on me. I tried
at one point to set up an event that would turn on my bedside lamp whenever
the ceiling light was turned on. After setting it up, the Vera started
doing strange things like dimming and then brightening the lights in the
room, shutting the lights off at random times, turning the lights on at
equally random times and so on. After the Vera
decided to turn on the lights
in the room at 5:00am, I had had enough, and I removed the glitchy
event.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x28ea580.0x2ddc968"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Lights</b></p><p>
Being open source, the Vera is quite hackable. One thing you can do is send
it special HTTP queries to control lights. Below is a simple bash
script I wrote to turn all of the Z-Wave devices in my house on or off. It's
not the most elegant script in the world but it works:


<pre     class="programlisting">

#!/bin/bash
# This file is named "lights" and is placed in
# /usr/local/bin with chmod 755

# lights in the house
#   biglamp="12"
#   smalllamp="13"
#   desklamp="14"
#   tv="16"
#   masterbedroom="17"

# All of the lights in the house
lights="12 13 14 16 17"

function turnlight() {
    if [ "${2}" = "on" ]; then
        # Turn the light on
        curl \
          "http://vera:3451/messagesend?from=1&amp;to=${1}&amp;type=1&amp;id=192"
    else
        # Turn the light off
        curl \
          "http://vera:3451/messagesend?from=1&amp;to=${1}&amp;type=1&amp;id=193"
    fi
}

if [ "${1}" = "on" ] || [ "${1}" = "off" ]; then
    for light in ${lights}; do
        turnlight ${light} ${1}
    done
else
    echo "Usage:"
    echo "   \"${0} on\" to turn all lights on"
    echo "   \"${0} off\" to turn all lights off"
    exit
fi

exit 0

</pre>
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x28ea580.0x2ddcc28"></a>
Conclusion</h2></div></div><p>
Thankfully, none of my other timers and events have been as troublesome
as the bedroom one.
</p><p>
In fact, the Vera has been very reliable about most of my scenes. I
have one that momentarily dims the lights in the family room when it
is time for the kids to get ready for bed. I'm still working on the
part where the kids actually start getting ready for bed at that point,
but the scene itself works flawlessly. All of my other scenes, events
and timers also have worked well.
</p><p>
Above all, the thing that Vera does do well is hide a lot of the
complexity of setting up and operating a home-control system, even if
it didn't quite pass the non-geek user test this time around.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x28ea580.0x2ddcde0"></a></h2></div></div><div class="sidebar"><p class="title"><b>Pricing Information</b></p><p>
The Vera is $299 from the Mi Casa Verde on-line shop.
</p><p>
Z-Wave modules start at around $35 and go up from there, depending
on the brand and features.
</p><p>
I purchased my Z-Wave modules from Amazon.com&mdash;simply
search for &ldquo;z-wave&rdquo; for a list of the available modules.
I purchased the following:
</p><div class="itemizedlist"><ul type="disc"><li><p>
Intermatic HA06C Wireless Indoor Wall Switch: $36.86
</p></li><li><p>
Intermatic HA03C Wireless Plug-In Indoor Lamp Module: $32.54
</p></li><li><p>
Intermatic HA02C Wireless Heavy-Duty Plug-In Appliance Module: $39.97
</p></li><li><p>
Intermatic HA01C Wireless Wall Receptacle: $33.79
</p></li></ul></div></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x28ea580.0x2ddd410"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
Mi Casa Verde: <a href="http://micasaverde.com" target="_self">micasaverde.com</a>
</p><p>
Mi Casa Verde Forums: <a href="http://forum.micasaverde.com" target="_self">forum.micasaverde.com</a>
</p><p>
Mi Casa Verde Wiki: <a href="http://wiki.micasaverde.com" target="_self">wiki.micasaverde.com</a>
</p><p>
Mi Casa Verde On-line Store: <a href="https://shop.micasaverde.com" target="_self">https://shop.micasaverde.com</a>
</p><p>
Amazon has a good selection of Z-Wave devices: <a href="http://amazon.com" target="_self">amazon.com</a>
</p></div></div></div>
<div class="authorblurb"><p>
Daniel Bartholomew lives in North Carolina with his wife and children. He
can be found on-line at <a href="http://daniel-bartholomew.com" target="_self">daniel-bartholomew.com</a>.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../181/toc181.html">Issue Table of Contents</a>
    <a class="link3" href="../181/10302.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>