<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Open Database Connectivity</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    Mr. Harvey describes the ODBC open specification for&#10;    application developers.&#10;    "><meta name="keywords" content="ODBC, database"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x11ac580.0x12a3ab0"></a>Open Database Connectivity</h1></div><div><div class="author"><h3 class="author">Peter Harvey</h3></div><div class="issuemoyr">Issue #67, November 1999</div></div><div><p>
    Mr. Harvey describes the ODBC open specification for
    application developers.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a4450"></a></h2></div></div><p>Open Database Connectivity (ODBC) is an
open specification for providing application developers with a
predictable application programmers interface (API) with which to
access data sources. Data sources can be just about anything,
provided someone has created an ODBC driver for it. The most common
data source is an SQL server.
</p><p>The two major advantages of coding an application with the
ODBC API are portable data access code and dynamic data
binding.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a45b0"></a>Portable Data Access Code</h2></div></div><p>The ODBC API (or CLI, command-line interface), as outlined by
X/Open and the ISO, is available on all major platforms. Microsoft
platforms include many enhancements to this specification. The
current version from Microsoft is 3.51. The idea is that a
programmer using the ODBC API is likely to have data access code
which is portable to other platforms. The same code will also be
portable across different data sources. For example, data for an
accounting program application can reside on a light SQL server
during development and then be moved over to a heavy SQL server
just by linking to a different ODBC driver. ODBC delivers platform
and data source portability.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a46b8"></a>Dynamic Binding</h2></div></div><p>Dynamic binding allows the user or the system administrator
to easily configure an application to use any ODBC-compliant data
source. This is the single biggest advantage of coding an
application with the ODBC API and purchasing such an application.
Dynamic binding allows the end user to pick a data source, e.g., an
SQL server, and use it for all data applications. Applications do
not have to be recompiled or recoded for the new target data
source. This is achieved by the ODBC Driver Manager which will pass
the ODBC calls to the user's ODBC driver without the need to relink
the code. ODBC enables the user to choose where the data will be
stored.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a47c0"></a>unixODBC Project</h2></div></div><p>The unixODBC Project's goals are to develop and promote
unixODBC as the definitive standard for ODBC on the Linux platform.
This is to include Microsoft extensions, where they make sense, and
GUI clients. The unixODBC team is achieving this objective by
providing the best technical solution to ODBC demands on the Linux
platform. All unixODBC development is released under GPL or
LGPL.</p><p>The components of this project are the Driver Manager,
DataManager, ODBCConfig, Odbcinst, drivers and other
utilities.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a4920"></a>Driver Manager</h2></div></div><p><a href="3395f1.jpg" target="_self">Figure 1. Libraries</a></p><p>This share library is the hub of most ODBC activity, but its
function is simple. Ninety percent of the Driver Manager's function
is to validate arguments, load and unload drivers and pass the call
to the driver in a manner consistent with the ODBC specification.
Normally, an application links only to this share to get the ODBC
support it requires (see Figure 1). The Driver Manager
loads/unloads the appropriate driver and passes calls to the
driver.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a4ad8"></a>DataManager</h2></div></div><p><a href="3395f2.jpg" target="_self">Figure 2. DataManager
TreeView</a></p><p>This is a GUI-client utility. The current version is based
upon Troll Tech's Qt class library
(<a href="http://www.troll.no" target="_self">http://www.troll.no/</a>).
The DataManager allows the user to browse and manage data sources
(see Figure 2). The right side of the TreeView contains a sizable
canvas which can be extended to include properties for any TreeView
selections. An example of this has been implemented for the data
source TreeViewItem. When a data source is selected, the canvas
becomes a handy editor which can be used to submit SQL, review
results and save/load either SQL or the results. Table designers
and data editors could be easily added to the DataManager using the
same techniques. The DataManager is an easy way to manage ODBC
data-source resources.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a4ce8"></a>ODBCConfig</h2></div></div><div       class="mediaobject"><img src="3395f3.jpg"><div class="caption"><p>
Figure 3. ODBC Data Source Administrator
</p></div></div><p>This is another GUI-client utility. It has been created to be
user compatible with the Microsoft ODBC administration utility (see
Figure 3). ODBCConfig makes it easy, even for non-techies, to
configure their data sources. ODBCConfig uses the Odbcinst library
to read/write ODBC system information. ODBCConfig will make use of
any installed driver configuration libraries to present a list of
driver-specific options to edit. ODBCConfig functionality is an
excellent candidate for the KDE
(<a href="http://www.kde.org" target="_self">http://www.kde.org/</a>)
Control Center. ODBCConfig makes it easy to configure ODBC data
sources.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a5000"></a>Odbcinst</h2></div></div><p><a href="3395f4.jpg" target="_self">Figure 4. ODBC Data
Flow</a></p><p>This is a share library which implements many useful
Microsoft extensions and a number of unixODBC extensions. It
provides an API for reading and writing ODBC system information
(see Figure 4). This essentially means reading and writing the
various INI files and environment variables. unixODBC also provides
a command-line interface to this library. This command-line tool
(of the same name) can be used by driver programmers when creating
their install script/RPM. The Odbcinst library is used heavily by
ODBCConfig, the Driver Manager and drivers but is seldom used by
other applications. Odbcinst implements many Microsoft
extensions.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a51b8"></a>Drivers</h2></div></div><p>The drivers, and their data source-specific client libraries,
typically implement the vast majority of the ODBC functionality. As
important as the Driver Manager is, it is the driver that carries
out most of the work. The unixODBC Driver Manager has been designed
to be binary compatible with any compliant drivers compiled on
Linux. unixODBC includes several drivers (and their sources) as
examples. unixODBC also includes a driver template for those
wishing to write a new driver. MiniSQL, MySQL and PostgreSQL are
examples of drivers included in unixODBC. unixODBC maintains a
driver-certification process which can be found at its web site
(see Resources).</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a52c0"></a>Other Utilities</h2></div></div><p>unixODBC also includes a library for working with INI files,
a LOG library and a command-line tool for executing SQL commands.
The INI library is used by Odbcinst for reading/writing the ODBC
system information. The LOG library is used by the Driver Manager
and Odbcinst to log ODBC activity, such as errors, and implement
ODBC tracing. The <span   class="bold"><b>isql</b></span>
command-line tool allows the user to submit SQL commands in a
terminal window. isql can also be used in batch mode, which can be
quite useful because it can return results wrapped in an HTML table
or delimited with a chosen character. It supports piping and
redirection.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a5420"></a>How Do I Get Started?</h2></div></div><p>You can download the source distribution from the unixODBC
website. Unpack the file using
<span   class="bold"><b>tar</b></span>, then follow the instructions
in the README file. You will want the Qt dev libraries to build the
GUI components and you will need the database-specific client
libraries for any drivers you decide to build. The README talks
about this in more detail. You must have at least one driver
section in /etc/odbcinst.ini. You can add this section using the
Odbcinst command-line tool or your favourite editor. Normally,
odbcinst.ini will get updated by driver install scripts using the
Odbcinst command-line tool, but at this time, you may have to edit
this file directly. A driver section in odbcinst.ini should look
something like this:</p><pre     class="programlisting">
[MiniSQL 2.x]
Description = MiniSQL ODBC Driver
Driver = /usr/lib/libodbcmini.so.1.0.0
Setup = /usr/lib/libodbcminiS.so.1.0.0
FileUsage = 2
</pre><p>Now run ODBCConfig to add, edit or remove data sources. You
will need to be root to work with system data sources, but any user
can add, edit and remove user data sources. Now run the
DataManager, and you should see all ODBC data sources. When you try
to expand the TreeView below a data source, you will be prompted
for login information to connect to the data source. You can also
try to connect to your data source using the isql command-line
tool. Simply execute the command:
<pre     class="programlisting">
$isql <span   class="emphasis"><em>DataSourceName</em></span> <span   class="emphasis"><em>MyID</em></span> <span   class="emphasis"><em>MyPWD</em></span>
</pre>


</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a5790"></a>An Application's Perspective</h2></div></div><p>Most database access can be accomplished using a simple
handful of ODBC function calls. In fact, it is good practice to
keep it simple, because each driver implements its own level of
compliance and completeness. An application can expect to be used
with very modest drivers from time to time. The isql command-line
tool is an example of an application that uses only a small, simple
set of ODBC functions. I will not get too deep into ODBC APIs,
since you can pick up excellent reference material elsewhere. The
typical sequence of events goes something like this:</p><div class="orderedlist"><ol type="1"><li><p>Connect to a data source.</p></li><li><p>Create and Execute an SQL Statement.</p></li><li><p>Process results.</p></li><li><p>Close connection.</p></li></ol></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a5bb0"></a>Connect to Data Source</h2></div></div><p>Initialize ODBC by calling SQLAllocEnv and SQLAllocConnect,
then call SQLConnect.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x12a5cb8"></a>Create and Execute an SQL Statement</h2></div></div><p>Initialize a statement by calling SQLAllocStmt. Call
SQLPrepare to allow the Driver Manager a chance to preprocess the
SQL, then call SQLExecute.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x129c650"></a>Process Results</h2></div></div><p>The simplest way to process results is to call SQLFetch in a
loop and SQLGetData for each column in the result set.
SQLNumResultCols can be used to find out how many columns are in
the result set.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x129c758"></a>Close Connection</h2></div></div><div       class="mediaobject"><img src="3395f5.jpg"><div class="caption"><p>
Figure 5. Include Files
</p></div></div><p>Call SQLFreeStmt, SQLDisconnect, SQLFreeConnect and
SQLFreeEnv to clean up. Your source should include sqlext.h (see
Figure 5) and should link against libodbc.so (see Figure 1).</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x11ac580.0x129ca18"></a>A Driver's Perspective</h2></div></div><p>The driver and the Driver Manager share 98 percent of their
function names. This is not surprising when you consider that the
Driver Manager passes off most processing to the driver. An
important difference, however, is that the
<b  >Environment</b>, <b  >Connection</b> and
<b  >Statement</b> handles contain different information.
For example, the driver's <b  >Connection</b> handle will
often contain some database-specific data such as a socket handle,
while the Driver Manager's <b  >Connection</b> handle
will usually contain very little aside from a pointer to the
driver's <b  >Connection</b> handle. unixODBC contains a
driver template which should act as a good starting point for
anyone interested in creating a new driver. It should be very easy
to port a driver to/from Linux using unixODBC, because unixODBC is
designed to support driver code from other platforms. A useful
driver will implement, at a minimum, the following functions:
SQLAllocConnect, SQLFreeConnect, SQLAllocStmt, SQLFreeStmt,
SQLConnect, SQLDisconnect, SQLPrepare, SQLExecute, SQLFetch,
SQLGetData, SQLNumResultCols and SQLColAttribute.</p><p>Perhaps the best way to learn how a driver works is to look
at some driver code. unixODBC contains a number of such examples.
Your source will likely implement driver.h and driverextras.h, but
at a minimum it should include sqlext.h and odbcinst.h (see Figure
5). Driver code from other platforms may have their own version of
driver.h and driverextras.h or may not have them at all; this is
okay, because these two includes are implemented in the local
source directory and are not used by any other code. You should
link against libodbcinst.so and any database-specific libraries
(see Figure 1). unixODBC has something for just about every Linux
user.</p><p>Application developers can now create portable data access
code independent of the platform and the data source. Driver
programmers can use the unixODBC driver template to get started on
a new driver, then use Odbcinst when creating their install
script/RPM. All Linux users can easily configure ODBC data sources
for their applications with ODBCConfig, then take a look at what
resources are available in a data source by browsing in the
DataManager. Ease of use and functionality surpass other platforms
which have had ODBC for a number of years. Most importantly,
widespread adoption of unixODBC in popular Linux distributions will
allow application developers to assume a desktop has these features
and take advantage of them. Such features are of critical
importance in having Linux fully accepted on an average user's
desk.</p><p><a href="3395s1.html" target="_self">Tips</a></p><p><a href="3395s2.html" target="_self">Resources</a></p></div></div>
<div class="authorblurb"><p>
        <div       class="mediaobject"><img src="3395aa.jpg"></div>

      <span   class="bold"><b>Peter Harvey</b></span>
      started programming games on the C64
      while in the Canadian military and went on to make programming his
      occupation of choice. He is the founder of CodeByDesign, which
      recently changed its focus from developing for MS platforms to
      developing for Linux. Peter can be reached at
      pharvey@codebydesign.com.</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../067/toc067.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>