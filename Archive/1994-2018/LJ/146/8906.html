<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
USB Pendrives and Distributions for Them</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;A look at three distributions you can use to boot Linux from a USB&#10;pendrive.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x253a580.0x2631ab0"></a>
USB Pendrives and Distributions for Them</h1></div><div><div class="author"><h3 class="author">
Juan
 Marcelo 
Rodriguez
</h3></div><div class="issuemoyr">Issue #146, June 2006</div></div><div><p>
A look at three distributions you can use to boot Linux from a USB
pendrive.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x2632240"></a></h2></div></div><p>
A pendrive is a USB storage device. You plug it in to a USB port, and
if the pendrive is compatible with your operating system, it should
look exactly like another disk on your system. These days, it is easy to
find pendrives with 1GB of storage.
</p><p>
It so happens that there has been an explosion of bootable live CD
versions of Linux. Both commercial and noncommercial Linux distributions
are providing live CDs (including Linspire, SUSE, Ubuntu, Kubuntu,
Knoppix and Mepis, to name only a few&mdash;there are many more).
</p><p>
Imagine a mixture of both concepts&mdash;a USB storage device and a live CD
version of Linux. You can pack a lot of features of a GNU/Linux live CD
into 1GB. The USB pendrive has the advantage of being writable, which
the live CD lacks. So, you can boot Linux from a pendrive and store data
on it too. The end result is that, as long as you can find a machine
that will boot from a pendrive, you have a fully portable version of
Linux that carries your applications, settings and data.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x26323f8"></a>
The Choices</h2></div></div><p>
I cover three LiveUSB distributions in this article: SLAX, Damn Small Linux (DSL)
and Flash Linux. Each one has different window managers
and different apps.
</p><p>
SLAX works with tmpfs and Unification fs (UFS), which gives
it some nice advantages. SLAX is based on Slackware Linux with the
2.6 Linux kernel.
</p><p>
DSL is a little distribution of 50MB. DSL configures Fluxbox very
nicely. Some of the apps included are Mozilla Firefox, the Slypheed mail
client, xmms, text editors, graphics viewers and more. It includes
a 2.4 Linux kernel with good hardware detection, but it doesn't have
the big apps other distributions have, such as The GIMP. It is a compact
distribution with a script to install it to LiveUSB.
</p><p>
Finally, Flash Linux is a solid distribution that uses the 2.6 kernel
and the fast JFFS2 filesystem. It has good speed, both as a live CD
and LiveUSB, and it includes large applications, such as The GIMP and
OpenOffice.org. It
uses grub, bootsplash, framebuffers and GNOME, and is based on Gentoo.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x2632608"></a>
Boot from USB</h2></div></div><p>
The biggest challenge in using a USB pendrive for your Linux distribution
is booting the pendrive. Old motherboards do not support the ability to
boot from USB hardware, so you may need to use a floppy disk to boot your
USB-based distribution. Newer motherboards let you boot drives usually
referred to as USBHDD, USBZIP, USB-FDD and others, such as USB-CDROM.
</p><p>
The first step to using a pendrive is to delete the original pendrive
partitions, if there are any. Then, add a FAT16 partition, and format it
with mkdosfs. I used cfdisk to do the work, but you can use fdisk too.
</p><p>
Check your dmesg log when you plug in the device to see if it is working:

<pre     class="programlisting">
dmesg | tail
</pre>
</p><p>
You should see a message similar to the following:

<pre     class="programlisting">
sda: assuming drive cache: write through
sda: sda1
</pre>
</p><p>
Format the partition you created with the following line:

<pre     class="programlisting">
mkdosfs -F 16 /dev/sda1
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x2632978"></a></h2></div></div><p>
(Change sda1 to whatever partition is appropriate for your system.)
</p><p>
Unplug the hardware, and plug it in again. You now are ready to install the
distribution.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x2632ad8"></a>
Damn Small Linux</h2></div></div><p>
Go to the DSL Web site (see the on-line Resources) and download
the ISO image file for the current version of DSL, and burn the ISO to
a CD or DVD. Boot from this CD or DVD. The boot starts with a welcome
screen, like most live distributions.
</p><p>
DSL looks for hardware, and then it installs and configures it. Depending on
your machine, it will bring up an X server running Fluxbox in less than
two minutes.
</p><p>
After booting from the DSL live CD, right-click on the Fluxbox desktop to
open the Fluxbox menu. Go to Apps&rarr;Tools&rarr;Install to install it to your
USB pendrive. Here, you have two options for installing the distribution:
install to USBHDD or USBZIP hardware. DSL will ask about the location of
the pendrive, and it also asks if you want to install DSL from the live CD,
from a file or from the Web.
</p><p>
I suggest you use your broadband connection to download the files. In
fact, if you have a router that supports DHCP, DSL should recognize your
Ethernet card and have no problems accessing the Internet at boot time.
DSL supports PPPoE too, if your Internet connection requires it.
</p><p>
I missed the features of the 2.6 kernel (the next release of DSL should
support 2.6), but it's still a good little distribution. I think DSL
is fine as it is, but if you need a big office suite, you should use
SLAX. Resources that you <span   class="emphasis"><em>must</em></span> read if you use DSL
are the Wiki and
the complete DSL forums. You will find many tips and tricks with plenty
of information that will be helpful if you run into problems.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x2632d98"></a>
Floppy-Based Boot Process</h2></div></div><p>
If your machine doesn't allow you to boot from a USB pendrive, you can
boot DSL from a floppy. Download the file bootfloppy-usb.img from
the DSL site, and copy the image to a floppy disk with dd:

<pre     class="programlisting">
dd if=bootfloppy.img of=/dev/fd0
</pre>
</p><p>
Modify your computer BIOS to boot from the floppy first, and then boot the
floppy image file of DSL. This boot image will launch the USB version
of DSL. This process works with just about any distribution that offers
a floppy boot image for booting USB pendrives.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x2632f50"></a>
SLAX</h2></div></div><p>
The SLAX site says, &ldquo;SLAX is a fast and beautiful Linux operating
system,
which fits on small (3.14") CD-ROM disc. It runs directly from the CD
(or USB) without installing. The live CD described here is based on the
Slackware Linux distribution and uses the Unification File System (also known
as unionfs), allowing a read-only filesystem to behave as a writable one,
saving all changes to memory.&rdquo; Fortunately, when you use a pendrive,
you don't have to worry about emulating write operations because,
unlike a CD, the pendrive memory is writable.
</p><p>
You can use UFS to merge storage from several sources, including network
storage, into one local directory. This makes UFS a good solution
for diskless workstations, because it makes it easy to keep your home
directory on a network storage device.
</p><p>
SLAX is a modular distribution, so you can add features as you need them.
It lets you configure your installation for many different purposes. You
might be able to watch a DVD, use QEMU, burn CDs and DVDs, run
firewalls, antivirus apps and much, much more. Check the list available
on
the project's site (see Resources) to
find out about modules that add new features to SLAX.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x2633160"></a>
SLAX Installation</h2></div></div><p>
To install SLAX, get the latest version from
the Web site (see Resources). SLAX has many versions of the same
distributions, with certain differences in apps and size. Select among
Frodo, Standard, Popcorn or KillBill editions. I used the slax-5.0.7b.iso
standard edition of 200MB with KDE.
</p><p>
Mount the ISO image file of SLAX using the loopback device. In my case,
I called the mount directory slax. Here is the command I used:

<pre     class="programlisting">
mount -o loop  slax-5.0.7b.iso  slax/
</pre>
</p><p>
As before, format the USB pendrive to use FAT16:

<pre     class="programlisting">
mkdosfs -F 16 /dev/sda1
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x26333c8"></a></h2></div></div><p>
(Change sda1 to whatever partition is appropriate for your system.)
</p><p>
After
you have a bootable and formated FAT16 partition in the pendrive,
mount it:

<pre     class="programlisting">
mount -t vfat /dev/sda1 /mnt/usb/
</pre>
</p><p>
Copy all the files from the directory slax/, where you mounted the ISO
of SLAX, to the mounted pendrive:

<pre     class="programlisting">
cp -rav slax/* /mnt/usb/
</pre>
</p><p>
Synchronize the data:

<pre     class="programlisting">
sync
</pre>
</p><p>
And go to the pendrive location (/mnt/usb):

<pre     class="programlisting">
cd /mnt/usb/
</pre>
</p><p>
Now, copy the files vmlinuz and initrd.gz to the root directory, where
you mounted the pendrive, in our case from the directory /mnt/usb/, and do:

<pre     class="programlisting">
cp boot/vmlinuz .
cp boot/initrd.gz .
</pre>
</p><p>
Then, edit the file called isolinux.cfg:

<pre     class="programlisting">
pico isolinux.cfg
</pre>
</p><p>
Remove every string called boot/ before vmlinuz and initrd.gz. Then,
rename it to syslinux.cfg to use syslinux with the device:

<pre     class="programlisting">
mv isolinux.cfg syslinux.cfg
</pre>
</p><p>
Finally, install and update MBR with LILO or GRUB:

<pre     class="programlisting">
lilo -M /dev/sda
</pre>
</p><p>
And, use syslinux to finish the process:

<pre     class="programlisting">
syslinux -s /dev/sda1
</pre>
</p><p>
SLAX is installed&mdash;enjoy it. Umount the pendrive and reboot. Change your
BIOS to boot from the USB pendrive, and reboot again. You may need to use
LILO or GRUB to update or install the master boot record on the pendrive.
</p><p>
SLAX has KDE, Fluxbox, K3b, Media Player, a Web browser, mail, office
suite, Kopete and many other applications. You can find a complete
list on the SLAX Web site (see Resources).
</p><p>
SLAX doesn't have the speed of DSL, but has the 2.6.15 kernel, excellent
network support, the parted application (partition editor) and more. It's
by far a more complete distribution than DSL, but you pay for it in size.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x2633c08"></a>
Flash Linux</h2></div></div><p>
The Flash Linux distribution is based on Gentoo Linux. Get the
Flash Linux ISO image
file from the Web site (see Resources), and burn it to CD. Then, boot from the CD in order to install the
LiveUSB version in the pendrive. Download the three parts of the ISO from
<a href="http://sourceforge.net/project/showfiles.php?group_id=124770" target="_self">sourceforge.net/project/showfiles.php?group_id=124770</a>. Currently,
the three parts are flashlinux-0.3.4-RC2.iso-part1,
flashlinux-0.3.4-RC2.iso-part2 and flashlinux-0.3.4-RC2.iso-part3. After
you download these files, put them together:

<pre     class="programlisting">
cat flashlinux-0.3.4-RC2.iso-part1 flashlinux-0.3.4-RC2.iso-part2 \
flashlinux-0.3.4-RC2.iso-part3 &gt; flashlinux-0.3.4-RC2.iso.
</pre>
</p><p>
Flash Linux has a beautiful Bootsplash and framebuffer theme. It also
includes the accelerated NVIDIA driver, which is great if you have a
GeForce video card.
</p><p>
Hardware detection also was fantastic. Flash configured all my devices
without a hitch.
</p><p>
After you boot and log in, install Flash on the pendrive. You will need
two partitions on the pendrive: a boot partition of +4MB
and a second partition of at least 256MB.
</p><p>
The Flash Linux people suggest you set up the partitions with fdisk. Plug in
your pendrive and run:

<pre     class="programlisting">
fdisk /dev/sda
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x262a808"></a></h2></div></div><p>
(Again, change sda to the drive designation your computer uses for the
pendrive, if it is different from sda.)
</p><p>
Delete every existing partition. Then, add the 4MB partition for the
boot partition. Next, create a second partition that uses the rest of
the free space on the pendrive. Write the changes and quit fdisk.
</p><p>
Now, download the installation script for USB devices. Download the
flash_key.sh installer file from the Web site, and put
it in the root folder of your Flash Linux Live CD.
</p><p>
If the script doesn't see your device, you may need to modify the
script. Replace the line:

<pre     class="programlisting">
dev=`readlink /${i}|cut -d"/" -f11`
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x262aa70"></a></h2></div></div><p>
in PICKDEVICE with:

<pre     class="programlisting">
dev=`readlink /${i}|cut -d"/" -f12`
</pre>
</p><p>
Add execution permissions to the script, and execute it:

<pre     class="programlisting">
chmod 755 flash_key.sh
./flash_key.sh
</pre>
</p><p>
Now, follow the easy steps given by the wizard. First, select the correct
device to install Flash Linux, then the 4MB boot partition. After that,
select
the root partition, and install Flash Linux in the pendrive. First, the
script erases the pendrive, then mounts it, and finally it copies the
apps and data to the pendrive. This last step took more than eight
minutes on
my machine. Be patient, and after that enjoy Flash Linux.
</p><p>
The highlights of Flash Linux are good speed, thanks in part to the
fact that it uses JFFS2 and many applications.
Details such as as animated cursors and cursor shadows as well as good
window decorations,
make your Flash Linux Desktop nice.
</p><p>
The only downside to Flash Linux is that it takes many steps
to get the pendrive working. Also, I don't know why Flash Linux developers
don't include an installer as part of the distribution instead of making
you run a script.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x253a580.0x262ad88"></a>
Final Ideas and Impressions</h2></div></div><p>
For the desktop user, pendrives and LiveUSB are fantastic. If you have
a pendrive, experiment with it&mdash;install DSL, SLAX, Flash Linux, Feather,
Puppy or other distributions on the hardware.
</p><p>
Your mileage may vary, but I prefer SLAX. The modular nature of SLAX
offers a wide range of options and features that a Linux professional
should appreciate. SLAX has security modules, the ClamAV antivirus app, a
Qt GUI, firewalls and so on. If you work often with security live CDs,
pendrives and LiveUSB are also ideal, because with one device, you solve
two problems. You can save data, and if you are developer, have security
and development modules on the other side of your pendrive.
</p><p><span   class="bold"><b>Resources for this article:</b></span>
<a href="../146/8949.html" target="_self">/article/8949</a>.
</p></div></div>
<div class="authorblurb"><p>
Juan Marcelo Rodriguez has been working with GNU/Linux for many years. He
writes articles for magazines, works with a local LUG and also works with
LugAR/USLA. He likes to play the keyboard, read, write and listen to
music.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../146/toc146.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>