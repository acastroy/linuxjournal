<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Cooking with Linux</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Set up a simple video studio with only a Webcam, microphone and&#10;these open-source packages.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x19df580.0x1ad6ab0"></a>
Cooking with Linux</h1></div><div><h3 class="subtitle"><i>
Lights...Camera...Action!</i></h3></div><div><div class="author"><h3 class="author">Marcel Gagn&eacute;</h3></div><div class="issuemoyr">Issue #128, December 2004</div></div><div><p>
Set up a simple video studio with only a Webcam, microphone and
these open-source packages.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ad7348"></a></h2></div></div><p>
I'm afraid it's true, Fran&ccedil;ois. The camera does not lie. That's what you
look like when you are serving wine. Of course, <span   class="emphasis"><em>mon
ami</em></span>, I have no
intention of putting this little video on our restaurant's Web site. Why
am I doing this? Ah, you have not yet looked at the feature for today's
menu. Multimedia and entertainment is the ticket, <span   class="emphasis"><em>mon
ami</em></span>, and
you have to admit, this little video certainly is entertaining. Don't be
upset, Fran&ccedil;ois, I have the ultimate respect for you. Besides, there's
no time to fret, our guests will be here any moment. Ah, you see, they
are already at the door.
</p><p>
Welcome, <span   class="emphasis"><em>mes amis</em></span>, to <span   class="emphasis"><em>Chez
Marcel</em></span>! It's wonderful to see you all
today here at the finest Linux restaurant on the planet, which also happens
to be the home of one of the greatest wine cellars in the world. Please
sit and make yourselves comfortable. Fran&ccedil;ois was just heading to the
wine cellar now. The 2001 Santa Lucia Highlands Pinot Noir is drinking
very nicely. It's a showy wine, bursting with hints of stardom&mdash;perfect for today's menu.
</p><p>
As you will notice, each workstation today is equipped with a small
Webcam and microphone. The immediate idea is that we
(or someone else) will wind up as the star of our little movie, but
sometimes the software itself is the star. After all, many an application
has shone on <span   class="emphasis"><em>Chez Marcel</em></span>'s menu, <span   class="emphasis"><em>non</em></span>?
And, this is where Karl Beckers' xvidcap
comes into play. xvidcap is a great little tool for recording the action
on your X desktop using a program called ffmpeg, which
likely is already on your system.
The
result is an MPEG movie of your entire desktop or any portion thereof.
</p><p>
Why would you do such a thing, you might ask? Well, you can use this to
create a training video to show others how to use an application or to
show the world how good you are at playing your favorite first-person
shooter. To get your copy of xvidcap, head on over to the official
Web site (see the on-line Resources).
The site offers both source and some binary packages, such as RPM or
DEB. Should your particular distribution not be covered, building xvidcap
from source is a simple extract and build five-step:

<pre     class="programlisting">
tar -xzvf xvidcap-1.1.3.tar.gz
cd xvidcap-1.1.3
./configure
make
su -c "make install"
</pre>
</p><p>
The program name is either xvidcap or gvidcap. I say
either because if you have the GTK2+ development libraries (version
2.2.1 or later), you get a second binary. Both work the same but,
quite honestly, the GTK2+ interface looks and works better. If you don't
have a recent GTK2+, you still may be able to get the interface by using
one of the binary packages as opposed to source.
</p><p>
When you start either version of the program from the command line, you
see a simple toolbar with a few buttons and a red rectangle floating
below it. This is the capture window, and you can move it to cover whatever
area you want to record. The default window, however, is fairly small. To
change the area you want to record, click the crosshairs icon (second
from the right on the toolbar), then click and drag the pointer to take
in whatever area you want to include in your capture. The red rectangle
will be resized. The toolbar contains buttons to record, stop, pause and so on. Pausing
over the buttons will display tool tips. That's it, you are recording
a movie of whatever transpires inside the red rectangle (Figure 1).
</p><div       class="mediaobject"><a href="7794f1.large.jpg"><img src="7794f1.jpg"></a><div class="caption"><p>
Figure 1. Selecting
a Capture Window with xvidcap/gvidcap
</p></div></div><p>
Some preference settings let you change the
number of frames per second, the video codec
and whether you want to capture the mouse pointer in the
final video. Right-click on the frame button (first on the left) and
select Preferences (Figure 2). After you've experimented for a while,
type <tt  >man xvidcap</tt> for details on running the program without
the GUI. The added bonus is that you can capture audio as well, which is perfect
if you are creating an instructional video.
</p><div       class="mediaobject"><img src="7794f2.jpg"><div class="caption"><p>
Figure 2. The gvidcap
Preferences Dialog
</p></div></div><p>
One of the reasons I made a point of mentioning ffmpeg when
introducing xvidcap is that it is an amazingly versatile little program
and well worth getting to know. You can use ffmpeg to create your own
movies with next to no expense. A cheap Webcam and, assuming you want
sound, an equally cheap microphone are all you need (and ffmpeg,
of course).
</p><p>
A few weeks ago, I was asked to create an introductory video for a
book project. The quality wasn't expected to be exciting, because this was
mostly a proof-of-concept thing and not meant to be the final product.
Because I did not have a proper video
camera, I had to improvise and thereby created what might well be the
world's cheapest video recording studio (Figure 3). My setup was a cheap
microphone and a cheap USB Webcam with a CPIA chip. Armed with
my Linux system, I figured I was ready to go. The only question was
&ldquo;How?&rdquo;
</p><div       class="mediaobject"><a href="7794f3.large.jpg"><img src="7794f3.jpg"></a><div class="caption"><p>
Figure 3. Is this the
world's cheapest video recording studio?
</p></div></div><p>
Using ffmpeg, I created my video clip, experimented with timing,
frame rate and so on, until I had something that was getting pretty
good. With the following command, I created an AVI format video clip at
ten frames per second:

<pre     class="programlisting">
ffmpeg -vd /dev/video -ad /dev/sound/dsp -r 10 \
-s 352x288 video_test.avi
</pre>
</p><p>
That's it. My video device input (indicated by the -vd
option) is /dev/video and my sound, or audio, input was
/dev/sound/dsp. That's the -ad option. Your own devices
may be a little different of course. For instance, on another of my
machines, the USB video device is /dev/video0. As it stands,
the command continues to record until you
run out of disk space. So, to limit a recording to ten seconds, I use the
-t option:

<pre     class="programlisting">
ffmpeg -vd /dev/video -ad /dev/sound/dsp -r 10 \
-s 352x288 -t 10 video_test.avi
</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x19df580.0x1ad80b0"></a></h2></div></div><p>
The resulting clip, which I called video_test.avi, can
be played with Xine, Kmplayer, MPlayer or whatever video player you
prefer.
</p><p>
Well, <span   class="emphasis"><em>mes amis</em></span>, my foray into video production on the cheap
was a success, or so I thought. When I sent the video clip for approval,
I was asked whether they could have it in MPG format instead. Rather than
redoing what obviously was a great work of cinematography, I converted
it using the following command:

<pre     class="programlisting">
ffmpeg -i video_test.avi video_test.mpg
</pre>
</p><p>
As versatile as ffmpeg is, you certainly should spend a few minutes
looking at the man page. I promise you'll discover a lot of really cool
uses for it.
</p><p>
For those of you who already own a digital video camera, recording
high-quality video is not a problem. The challenge is to get the video
on your hard disk for editing, compressing and eventually burning to
disk for sending to friends and family. I have a Sony Handycam. It comes
with a USB port, but it also has a much faster means of getting the video
transferred through a high-performance serial bus or, as most people know
it, a FireWire port. The real techies out there refer to it as an
IEEE1394 port. Your computer also needs to have such a port (or card)
in order to transfer the information, but the performance of the IEEE1394
port truly is worth the investment.
</p><p>
To manipulate the resulting video in a friendly way, however,
you need to get your hands on a video editor like Arne Schirmacher's
Kino (see Resources). The dvgrab
program, also available from the Kino Web site, is built-in to Kino so
you don't need a separate copy. You see, <span   class="emphasis"><em>mes amis</em></span>, like xvidcap,
Kino uses a few command-line tools under the pretty interface.
One of those tools is our old friend ffmpeg.
</p><p>
These days, Arne has some great developers working on the project, and
they have put together a rather nice and easy-to-use video editor for
Linux. See the feature article on page XX.
The beauty of Kino is that you can use it to extract and edit video
directly from your IEEE1394-compatible video camera. If you have such a
device, which can be connected with a FireWire cable, Kino even lets
you control the device through the application. Before I continue on,
let me step back and say something about the IEEE1394 support. Any
recent Linux distribution should have IEEE1394 support included (through
loadable kernel modules), but on my test system, the drivers weren't
loaded automatically. No problem&mdash;I loaded them manually:

<pre     class="programlisting">
modprobe ohci1394
modprobe raw1394
chmod 666 /dev/raw1394
</pre>
</p><p>
Getting your digital video across the IEEE1394 cable and onto
your computer can be done easily from the command line
with dvgrab. After all, that's what Kino does to capture
video. Although you can type <tt  >dvgrab</tt> and start capturing,
the best way to do this is by using the -i option, meaning
interactive. You then can control the camera and capture using simple
single key presses.

<pre     class="programlisting">

dvgrab -i
Going interactive. Press '?' for help.
q=quit, p=play, c=capture, Esc=stop, h=reverse, j=backward scan,
k=pause, l=forward scan, a=rewind, z=fast forward, 0-9=trickplay,
&lt;space&gt;=play/pause
Capture Started

</pre>
</p><p>
We become accustomed to working with graphical interfaces, but this is a lot
easier and nicer to use than it sounds. The resulting video file on your
system is called dbgrab-<span   class="emphasis"><em>XXX</em></span>.avi by default, the
<span   class="emphasis"><em>XXX</em></span>
being a three-digit extension.
</p><p>
Kino's interface is clean and easy to navigate (Figure 4). To the right
of the main window, tabs indicate the various functions, from
capturing to editing to exporting the finished product. The Edit tab is
where most of the work happens (after the Capture, of course). This is
where you cut or join scenes, or even insert additional files in to
your video project. The Timeline tab breaks up the current scene (and
video clip) into multiple frames, so you can jump to any part of
the video without having to play the whole thing.
</p><p>
An FX tab lets you add various special effects to your
videos. These include things like reverse video, sepia tones, mirror and
kaleidescope effects and so on. Audio effects include fade in, fade out
and silence.
</p><div       class="mediaobject"><a href="7794f4.large.jpg"><img src="7794f4.jpg"></a><div class="caption"><p>
Figure 4. Editing a Home
Movie with Kino
</p></div></div><p>
Once you start truly enjoying your digital video camera, you are going to
record more than a few minutes of tape. The reason I mention this is
that when you are capturing output from your digital camera with Kino,
a number of large files will be created, each about 820MB in
size and each sequential for the duration of the video. Those mega-files
aren't what you want your final product to be, however. That's what the
Export tab is all about. Various options are available here (in a group
of sub-tabs) including exporting only the audio tracks to WAV files. I
also like the fact that I can export stills of individual frames. The
option I tend to use the most, however, is DV pipe, and this is where
ffmpeg makes an encore appearance.
</p><p>
After all the editing, cutting and pasting is done, I export my finished
product using ffmpeg to either video CD AVI files or DVD format. The
resulting files (for example, VCD AVI format) are much smaller and much more
manageable. One hour of digital video takes up about 9GB of
disk space. The exported video, however, fits nicely on a single 700MB
CD-ROM.
</p><p>
As you can see <span   class="emphasis"><em>mes amis</em></span>, your Linux system provides some great
tools to make you, or your software, a star. Speaking of which, it
seems as though closing time has arrived already and judging by the
wine-induced smiles on some of your faces, we have the opportunity to
capture some memorable video. I jest, of course. Fran&ccedil;ois, do be so
kind as to refill our guests' glasses one more time. Perhaps what we
should capture for posterity is our parting toast. Until next time,
<span   class="emphasis"><em>mes amis</em></span>, let us all drink to one another's health.
<span   class="emphasis"><em>A votre sant&eacute; Bon app&eacute;tit!</em></span>
</p><p><span   class="bold"><b>Resources for this article:</b></span>
<a href="http://www.linuxjournal.com/article/7808" target="_self">www.linuxjournal.com/article/7808</a>.
</p></div></div>
<div class="authorblurb"><p>
Marcel Gagn&eacute; (<a href="mailto:mggagne@salmar.com">mggagne@salmar.com</a>) lives in Mississauga,
Ontario. He is the author of
the all new <span   class="emphasis"><em>Moving to the Linux Business Desktop</em></span>
(ISBN 0-131-42192-1),
his third book from Addison-Wesley. In real life, he is president of
Salmar Consulting Inc., a systems integration and network consulting
firm.
He is also a pilot, writes science fiction and fantasy, and folds a
mean origami T-Rex.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../128/toc128.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>