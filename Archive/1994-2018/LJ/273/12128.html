<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
The Open-Source Classroom
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;What has 48TB and is full of penguins?&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x20bb580.0x21b2ac0"></a>
The Open-Source Classroom
</h1></div><div><h3 class="subtitle"><i>
My Love Affair with Synology
</i></h3></div><div><div class="author"><h3 class="author">
Shawn
 
Powers
</h3></div><div class="issuemoyr">Issue #273, January 2017</div></div><div><p>
What has 48TB and is full of penguins?
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20bb580.0x21b3358"></a></h2></div></div><p>
In my recent &ldquo;Hodge Podge&rdquo; article (in the October 2016 issue), I mentioned how much I love the
Synology NAS I have in my server closet (Figure 1). I got quite a few email messages
from people&mdash;some wanting more information, some scolding me for not
rolling my own NAS, and some asking me what on earth I need with that
much storage. Oddly, the Linux-running Synology NAS has become one of
my main server machines, and it does far more than just store data. Because
so many people wanted more information, I figured I'd share some of the cool
things I do with my Synology.
</p><div       class="mediaobject"><a href="12128f1.large.jpg"><img src="12128f1.jpg"></a><div class="caption"><p>
Figure 1. The Synology DS1815+ is what I use, but the entire line of Synology 
NAS devices shares a common interface.
</p></div></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20bb580.0x21b3720"></a>
Why So Much Storage?!</h2></div></div><p>
I guess I should address the reason I have 48TB (36 usable) of
storage (Figure 2). I store a lot of data (har har har). Seriously though,
I have a local copy of close to 100,000 photos, 1000s of hours of home
videos and several complete Linux distribution repositories. That takes a
lot of storage! The bulk of my needs, however, comes from entertainment
media. Ever since my kids first used DVDs to skate across the kitchen
floor, I've been backing up my movies digitally to my server. Through the
years, that has migrated from DVD ripping to Blu-ray ripping, but years
of movies really add up. Even those aren't the bulk of my data, however.
</p><div       class="mediaobject"><a href="12128f2.large.jpg"><img src="12128f2.jpg"></a><div class="caption"><p>
Figure 2. The dashboard shows you information on your NAS at a glance. I'm slowly
building my collection after the horrible data loss I suffered a few
years ago.
</p></div></div><p>
I collect television series. Sometimes those collections are ripped from
my TiVo, manually edited and converted to MKV. If I'm being honest,
however, most of my television shows are just downloaded from torrent
sites. Yes, I know it's not kosher to download torrents of television
shows. But I also know that I pay more than $200/month to the cable company
for every channel available, and if I wanted to take the time, I could do
the TiVo rip/edit/convert dance. I just don't have the time. Because I pay
for cable access, it doesn't bother me to download television shows. (We
actually do buy all our Blu-ray movies though. I'm not a proponent of
pirating things you don't have rights to.) It's okay if you disagree with
my choice to download television shows via torrents, I get it. Really,
I do. Just ignore those parts of this article!
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20bb580.0x21b3a38"></a>
What Kind of Drives?</h2></div></div><p>
Don't skimp on hard drives. That's generally good advice regardless of
the situation, but with NAS devices, please spend the extra money to get
drives rated for NAS. I have eight 6TB Western Digital Red NAS drives. When
I bought them, the WD Red Pro drives weren't available. Still, the
standard Red drives are rated for up to eight drive bays, so I'm still
within spec.
</p><p>
I haven't always been so picky about drives. In fact, I just used to 
get the biggest, cheapest drives I could. Since I use RAID6, a drive
or two failing isn't a big deal&mdash;except that I actually had three drives fail
at exactly the same time, and I lost all my data, including family home
movies that I didn't have backed up anywhere. It still hurts. So really,
don't skimp on drives, it's just not worth it. (Also remember to back up, even large
files. RAID isn't a backup, trust me.)
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20bb580.0x21b3bf0"></a>
Why Synology?</h2></div></div><p>
I've had Drobos, QNAPs and multiple Netgear devices. They all sucked. No,
really. The performance on every single device I've had in the past
has been horrible (even with good drives), and I've never been able to
determine exactly why. Once more than one simultaneous read happens
over the network, they all just crap out. With the Synology, I can have
four 1080p video streams going at once without any slowdown at all.
</p><p>
The other thing I like about the Synology is its software. Most other
NAS devices have apps that you can install on the Linux system, but the
Synology apps seem to be more elegant and work reliably (Figure 3). In fact,
there are some incredible things I do with the NAS device that I'm sure
weren't exactly what it was designed to do (more about that in a bit).
</p><div       class="mediaobject"><a href="12128f3.large.jpg"><img src="12128f3.jpg"></a><div class="caption"><p>
Figure 3. The apps are plentiful, and there are community-supported unofficial
apps as well.
</p></div></div><p>
Ultimately, the biggest draw for me is how well Synology keeps itself
updated and maintains its drives. It automatically does scans and
integrity checks, plus it does system updates without disrupting
the servers I have connected to it via NFS. Every other NAS I've used
stays at whatever software version it comes with, because upgrading the
firmware almost always means drive failures and server lockups. I'm sure
there are procedures for QNAP and such that make upgrading possible,
but the Synology does it automatically&mdash;and I like that a lot.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20bb580.0x21b3fb8"></a>
TV and Torrents</h2></div></div><p>
I like the SickRage program not only because it automatically searches
and downloads new episodes of my television shows, but also because
it organizes my existing collection. I have every episode of <span   class="emphasis"><em>Star
Trek</em></span> that
ever has been produced (including the animated series from the 1970s), and
SickRage does an incredible job of naming and organizing those files. As
long as I spent ripping the <span   class="emphasis"><em>Star Trek the Next Generation</em></span> DVDs, I don't
ever want to have to figure out which episode is which again! 
</p><p>
In order
to install SickRage, you actually need to install &ldquo;Sick Beard Custom&rdquo;
and then paste in the SickRage Git URL. The short version of the story
is that Sick Beard was the original program, but the developer stopped
developing it, so folks forked it, and SickRage is the best fork out
there, by far. Even if you're not using Synology, you should be running
SickRage. Head over to <a href="https://github.com/SickRage/SickRage" target="_self">https://github.com/SickRage/SickRage</a> for the repo
or <a href="http://sickrage.github.io" target="_self">sickrage.github.io</a> for the home page.
</p><p>
SickRage supports lots of torrent clients, and it supports NZB too. I've
found NZB to be less reliable than it used to be, so I've moved back
to 100% torrents. I like the Transmission web interface, so that's
what I use on Synology. It's another maintained app, so just search
for &ldquo;transmission&rdquo; in the package installer application. Integrating
Transmission and SickRage is beyond the scope of this article, but
rest assured, it's not difficult. SickRage is designed to work with
Transmission, so setting it up is easy. <span   class="emphasis"><em>Warning:</em></span> if you use SickRage and
Transmission to download television shows, you <span   class="emphasis"><em>will</em></span> get DMCA take-down
notices from your ISP. Apparently the production companies disagree with
my rationale for downloading TV episodes. Thankfully, I have a solution
for that.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20bb580.0x21b4430"></a>
Networking and Traffic Routing</h2></div></div><p>
My Synology device has four Gigabit Ethernet ports. I think that's overkill,
but since the software allows me to bond the four ports together (even with
a switch that doesn't support 802.3ad), I'm happy to have more bandwidth
than I need. I never have an issue with throughput, even when streaming
those multiple video files mentioned above.
</p><p>
Since Synology supports VPN connections, the first thing I did was set
up my privateinternetaccess.com account so my torrents would be directed
through the VPN. I haven't gotten port forwarding to work through the
VPN, but even without a redirected port, my torrents download fine. The
problem is my VPN connection occasionally goes down. When it does,
the torrents go through my gateway, and even when the VPN comes back
up, the tracker connects me via the non-VPN connection. And, I get DMCA
notices. This is very frustrating. So I decided to remove the gateway
device from the Synology altogether! Bear with me.
</p><p>
I have a network address assigned on my local network so LAN computers
can connect. That works fine. Without a gateway specified, however, the
NAS can't connect to the internet for torrents, SickRage or even system
updates. But when the VPN is connected, it sets the gateway address
automatically to an address on the other side of the VPN (Figure 4). As
long as my VPN is connected, the system has a gateway assigned, and it can
access everything through the VPN. If the VPN goes down briefly, rather
than defaulting to the local network gateway, it just can't connect to
the internet. Once the VPN is re-established, it reassigns a VPN gateway,
and boom, the NAS is back online!The only problem is how can I connect
to the VPN if I can't get on the internet? The answer: static routes.
</p><div       class="mediaobject"><a href="12128f4.large.jpg"><img src="12128f4.jpg"></a><div class="caption"><p>
Figure 4. Notice the gateway is in the 10.x.x.x range, which is not what I
use on my local network. That is assigned by the VPN.
</p></div></div><p>
If you look at Figure 5, you'll see that I have a static route set up
so that traffic going to the IP address of my VPN goes through my LAN's
gateway. Since it's only a static route for that network, the rest of
the internet is still inaccessible. I also could do fancy firewall work
and allow the NAS to access only the VPN and drop all other packets,
but I like the solution to be self-contained. That way, if I change routers
or router configs, I don't have to worry about getting DMCA notices.
</p><div       class="mediaobject"><a href="12128f5.large.jpg"><img src="12128f5.jpg"></a><div class="caption"><p>
Figure 5. This is the sneaky static route so I can connect to my VPN, but
nothing else.
</p></div></div><p>
The Synology also will act as a router, forwarding traffic. That means
I can point my Roku to the Synology as its gateway device, and I'm able
to watch local blackout games on the MLB.tv app, because all the traffic
goes through the VPN. The only change I have to make is on my DHCP server,
which gives the Synology's IP address as the Roku's gateway address. It
works perfectly and saves me setting up another VPN to get around MLB's
regional restrictions. (Honestly, I usually watch baseball games on TiVo,
but occasionally the game is on only via streaming, and I like having
that option.)
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20bb580.0x21b4a60"></a>
Backups</h2></div></div><p>
Remember when I said RAID wasn't a backup? Yeah, I meant that. I've lost
too much valuable data through the years to depend on RAID to protect my
files&mdash;even when the drives and NAS device seem to be more solid than
any I've had in the past. Thankfully, Synology has a few different backup
options (Figure 6). The most practical one for large amounts of data is
the Hyper Backup app. It has the ability to copy your entire NAS to
a variety of destinations. Whether you choose to buy another Synology
NAS and store it in your shed or back up your data to Amazon Glacier,
the same Hyper Backup program can handle the regular updates.
</p><div       class="mediaobject"><a href="12128f6.large.jpg"><img src="12128f6.jpg"></a><div class="caption"><p>
Figure 6. Backup solutions are in great supply.
</p></div></div><p>
I don't want to pay for Amazon Storage, even though the Amazon Drive
Unlimited is decently priced at $60/year. I worry that my 30TB would
cause Amazon to invent a reason to suspend my account. Plus, it would
take so long to back up my entire data store to the cloud, that it 
literally might never get done. Right now, I just back up my irreplaceable files
(home movies, photos and so on). Someday I hope to get a second Synology NAS
and set up that &ldquo;mirror in the shed&rdquo;. Still, Synology has so many backup
options, it's hard to find a reason to delay setting up a backup solution!
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20bb580.0x25ad020"></a>
Things I Don't Do</h2></div></div><p>
The Synology had a decent processor, and the RAM is even
upgradeable. Still, it's not a beefy server when it comes to resource-hungry applications. For example, even though the Plex Media Server is
available in the package management system, I'd never install it. Plex
uses way too much CPU to transcode video streams. I'm thankful the
Synology is powerful enough to stream the actual video files over
fileshares, but the thought of transcoding 1080p MKV streams in real
time? It's a bad idea. I have a standalone server I use for Plex Media Server,
and while it can transcode at least four full resolution video streams,
it's also a huge i7 CPU with a boatload of RAM. Unless you're doing
minimal streaming with low-resolution video, I encourage you to avoid
Plex Media Server on any NAS device.
</p><p>
I also can't run the really amazing reverse proxy server on Synology. The
setup is easy, and the configuration is very intuitive, but my VPN/no-gateway setup means that the reverse proxy doesn't work outside my
network. Even if I forward a port to the NAS from my router, it tries to
send responses out the VPN connection and fails. Reverse proxies are
easy enough to configure on any other machine in my network, so it's
not a huge loss, but it's worth noting that it's something my crazy
VPN system breaks.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20bb580.0x25ad1d8"></a>
Not the Only Option</h2></div></div><p>
Before you think I was paid by the folks at Synology to brag about
their product, I will freely admit that a big tower server with a bunch
of hard drives and software RAID makes for an incredible NAS. It means
you can beef up the hardware too and do things like run Plex Media
Server. I simply like the efficiency of the Synology devices. They're fast,
cool running and just sip electricity. I'm sure there are other brands of
NASes that do a decent job too, and Synology isn't perfect. In all honesty,
however, it's the best product I've been able to find, and I have literal
piles of junk NAS devices that just couldn't do the job. If you're
looking for a NAS device, in my opinion, you can't go wrong with Synology.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x20bb580.0x25ad2e0"></a></h2></div></div><div class="sidebar"><p class="title"><b></b></p><p>Send comments or feedback via <a href="http://www.linuxjournal.com/contact" target="_self">www.linuxjournal.com/contact</a> or to
<a href="mailto:info@linuxjournal.com">info@linuxjournal.com</a>.
</p></div></div></div>
<div class="authorblurb"><p>
Shawn Powers is the Associate Editor for <span   class="emphasis"><em>Linux
Journal</em></span>. He's also the
Gadget Guy for LinuxJournal.com, and he has an interesting collection
of vintage Garfield coffee mugs. Don't let his silly hairdo fool you,
he's a pretty ordinary guy and can be reached via e-mail at
<a href="mailto:info@linuxjournal.com">info@linuxjournal.com</a>. Or, swing by the #linuxjournal IRC
channel on Freenode.net.

</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../273/toc273.html">Issue Table of Contents</a>
    <a class="link3" href="../273/12128.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>