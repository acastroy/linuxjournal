<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>A Process Smorgasbord</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    Marcel serves up some truly mind-expanding ways to monitor&#10;    your processes.&#10;    "><meta name="keywords" content="system, admin, process, management, pstree, Treeps, LavaPS, psDooM"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x1b1e580.0x1c15ab0"></a>A Process Smorgasbord</h1></div><div><div class="author"><h3 class="author">Marcel Gagn&eacute;</h3></div><div class="issuemoyr">Issue #104, December 2002</div></div><div><p>
    Marcel serves up some truly mind-expanding ways to monitor
    your processes.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1b1e580.0x1c165b0"></a></h2></div></div><p>Fran&ccedil;ois,
<span   class="emphasis"><em>vite</em></span>! Our guests will be here any moment.
<span   class="emphasis"><em>Quoi</em></span>? You say you already have prepared
everything? Excellent, Fran&ccedil;ois! I see you have brought up a
healthy supply of the 1998 Barossa Valley Shiraz. It will pair
nicely with tonight's menu, don't you think? <span   class="emphasis"><em>Qu'avez-vous
dit?</em></span> Ah, the theme of this issue...it is System
Administration, <span   class="emphasis"><em>mon ami</em></span>, and tonight I have
decided to look into process management. But of course,
Fran&ccedil;ois, even something as basic as processes can be the
center of exciting dishes.
</p><p>What did you say, Fran&ccedil;ois? Ah, our guests are here!
Welcome, <span   class="emphasis"><em>mes amis</em></span>, to <span   class="emphasis"><em>Chez
Marcel</em></span>, home of fine Linux cooking, tantalizing
atmosphere and incredible wine. Your tables and the wine are ready.
Please sit and my faithful waiter will fill your glasses. I must
tell you that Fran&ccedil;ois is being unusually efficient tonight.
I don't know what has gotten into him. One less thing to manage,
<span   class="emphasis"><em>non</em></span>?</p><p>As everyone in this restaurant knows, everything running on
your Linux machine is a process; every shell, every open connection
to the Internet, every game&mdash;everything. In some cases, programs
will spawn multiple processes of their own. These are child
processes. Technically, every process is a child process of some
parent except one&mdash;that is, init, the master process. Children can
spawn more children, and they can spawn more. You can use
<b  >ps</b> to list them all, but in time, monitoring all
this procreation can be quite exhausting. <span   class="emphasis"><em>Mon Dieu, mes
amis</em></span>, I think I need a sip of my wine right now.</p><p>To obtain a quick-and-dirty view of what process is the child
of what other process, you can type the <b  >pstree</b>
command. Note the first few lines of output below and init's
position:</p><pre     class="programlisting">
init-+-apmd
     |-atd
     |-bdflush
     |-cardmgr
     |-crond
     |-gpm
     |-kalarmd
     |-kapmd
     |-kappdock-+-wmWeather
     |          `-wmmultipop3
     |-kdeinit-+-artsd
     |         |-autorun
     |         |-kdeinit
     |         |-kdeinit---2*[bash]
     |         |-kdeinit---bash
     |         |-kdeinit-+-bash---lavaps
</pre><p>While this looks neat, it is somewhat lacking in information.
You can get the same effect (but with more information) by using
your old friend, the <b  >ps</b> command. The f option
displays a <span   class="emphasis"><em>forest</em></span> view through which you can
see the process trees. A little joke, <span   class="emphasis"><em>mes
amis</em></span>.
</p><p>Transforming the sea of processes into something that readily
catches the eye is exactly what George MacDonald had in mind when
he created Treeps. This program is an interactive, graphical
process monitor with an on-the-fly, color-coded display, thereby
making it easier to nail down individual tasks. This one is
certainly worth the download, <span   class="emphasis"><em>mes amis</em></span>. Get
the source at the following URL:
<a href="http://www.orbit2orbit.com/gmd/tps/treepsfm.html" target="_self">www.orbit2orbit.com/gmd/tps/treepsfm.html</a>.</p><p>To build Treeps, extract the source (with <b  >tar -xzvf
treeps-1.2.1.tar.gz</b>, then run the
<b  >./Setup</b> script from the installation directory.
After the prebuild configuration takes place, you'll be told to do
a <b  >make install</b>. You then run the program by
typing <b  >treeps &amp;</b>.</p><p>
<div       class="mediaobject"><a href="6321f1.large.jpg"><img src="6321f1.jpg"></a><div class="caption"><p>Figure 1. Process Nirvana, Courtesy of
Treeps</p></div></div>
</p><p>The initial view is of your own processes as launched from
init, and this is where the fun starts. Moving your mouse pointer
over a process displays some basic information, the equivalent of
what you would get from a <b  >ps x</b>. Right-click and
a pop-up menu will give you the options of renicing the process,
viewing its man page and so on.</p><p>From the bar of buttons on the top, click the various
selections. Aside from a view of your own processes, you can choose
to see the d&aelig;mon processes or simply
<span   class="emphasis"><em>everything</em></span>. If you click the information
button (the one with an &ldquo;i&rdquo; on it), your mouse pointer changes to
an &ldquo;i&rdquo; as well. Click any process, and an information window
appears with more details about the running process than you would
have thought were there. From that window, you can drill down even
further. Click the File/Dir button, and you can see every file open
by that process. For the truly curious, the Mem maps button
displays where in memory every chunk of code resides.</p><p>The features are numerous to say the least, but the
color-coding is what really caught my eye. While the program is
running, turn on the &ldquo;color map viewer&rdquo; by clicking on the
color-bar button. By cycling through the various options, you can
highlight processes based on user ID, group ID, total CPU time,
current CPU load, process status (sleeping, running, zombie, etc.),
resident memory, image size and more.</p><p>Under the Program menu, there's another little treat called
System Info, which brings up the System Information App Launcher.
From this button-laden window, you quickly can view tons of
information about your system, from your routing table to loaded
modules, kernel level, PCI devices, uptime, disk partitions,
runlevels and so on.</p><p>Viewing things from a different perspective can give you a
new appreciation for even the familiar. Indeed, it can be a
mind-expanding experience, <span   class="emphasis"><em>non</em></span>? As whimsical
as the next item on our menu appears to be, I found it a lot of fun
to watch and work with. Whether it makes a great process monitor or
not will depend on your feelings toward lava lamps. Written by John
Heidemann, LavaPS was inspired by the idea of calm computing from
&ldquo;The Coming Age of Calm Technology&rdquo; by Mark Weiser and John Seely
Brown.</p><div       class="mediaobject"><img src="6321f2.jpg"><div class="caption"><p>
Figure 2. Mind-Expanding Process Management, Lava-Lamp Style
</p></div></div><p>The idea here is that processes are represented as fluid
blobs in a lava lamp. The larger the blob, the greater its memory
usage. The faster it moves, the greater its CPU usage. Like any
decent process monitor, it allows for identification of processes,
renicing and killing. Start by visiting the lavaps web site
(<a href="http://www.isi.edu/~johnh/SOFTWARE/LAVAPS/index.html" target="_self">www.isi.edu/~johnh/SOFTWARE/LAVAPS/index.html</a>)
and picking up a copy of the package.</p><p>For the Red Hat users out there, prepackaged RPMs are
available. For the others, never fear&mdash;building LavaPS is simply
another example of the famous (dare I say &ldquo;classic&rdquo;) extract and
build five-step:</p><pre     class="programlisting">
tar -xzvf lavaps-1.20.tar.gz
cd lavaps-1.20
./configure
make
su -c make install
</pre><p>To start your lava lamp, type <b  >lavaps
&amp;</b>. You'll see a small lava lamp appear on your
desktop. Right-click, and a menu pops up offering a number of
options. The proc menu tells you the process ID and the name of the
process. It also allows you to send various signals (such as kill)
to the process, from forceful termination to temporary suspension.
</p><p>Running LavaPS to monitor and administer processes certainly
sets an otherworldly kind of mood. The one thing I did not like is
that the default lamp was actually fairly small on my 1024 &times;
768 display. Overriding this requires that you set X resources.
This is done easily by modifying the $HOME/.lavapsrc configuration
file. In mine, the only thing I changed was the geometry. Here's
what my .lavapsrc file looks like:</p><pre     class="programlisting">
lavaps.geometry: 204x404+700+0
</pre><p>Speaking of otherworldly, <span   class="emphasis"><em>mes amis</em></span>, the
strangest excursion into the secret life of your processes is
probably highlighted by an unusual game of
<span   class="emphasis"><em>Doom</em></span>, the classic 3-D shooter from ID
Software. Back in 1997, ID Software released the source code to
<span   class="emphasis"><em>Doom</em></span>, and many ports followed. One of them was
<span   class="emphasis"><em>XDoom</em></span>, a UNIX X Window System version on which
David Koppenhofer's psDooM is based. As psDooM was inspired by
<span   class="emphasis"><em>XDoom</em></span>, David was inspired by Dennis Chao, and
Dennis was inspired by Vernor Vinge. If you are curious, check out
the link to Dennis' &ldquo;Doom as a tool for system administration&rdquo;
(see Resources).
</p><p>Anyhow, the idea behind psDooM is to provide a strange
alternative to process management. The monsters roaming the halls
have red process IDs floating above their heads along with the last
seven characters of the command name.</p><p>
<div       class="mediaobject"><a href="6321f3.large.jpg"><img src="6321f3.jpg"></a><div class="caption"><p>Figure 3. Killing Processes with a Vengeance:
psDooM</p></div></div>
</p><p>Source tarballs are available from the psDooM web site, but
the easiest way to install psDooM is to pick up the precompiled
binaries. Installation is fairly simple: run the
<b  >install.sh</b> script:</p><pre     class="programlisting">
tar -xzvf psdoom-2000.05.03-bin.tar.gz
cd psdoom-bin
su -c "./install.sh"
</pre><p>An IWAD is required to run psDooM, specifically Doom 1, Doom
2 or Ultimate Doom. The shareware Doom 1 IWAD also will work. If
you don't happen to have your own Doom WAD, you can download a copy
from the
<a href="http://www.doomworld.com" target="_self">www.doomworld.com</a>
site. I visited the site and picked up a copy of the file:
<pre     class="programlisting">
unzip shareware_doom_iwad.zip
su -c cp DOOM1.WAD /usr/local/games/psdoom/doom1.wad
</pre>


That's it. Now, we are ready to run psDooM:
<pre     class="programlisting">
cd /usr/local/games/psdoom
./psdoom -2
</pre>


Notice the -2 option above. By default, you'll find the screen
quite small. This option increases the size of your default screen.
If you've never played <span   class="emphasis"><em>Doom</em></span> before, I must
warn you, <span   class="emphasis"><em>mes amis</em></span>, that it can get a little
violent. Monsters and bad boys roam the halls, and your life hangs
in the balance. Wounding a process monster is equivalent to
renicing that process (<b  >renice +5</b>). Keep
shooting, and you will kill the process. System permissions are
honoured, however. You can kill a monster process that belongs to
another user (or the system), but it will be resurrected. Only your
own processes will <span   class="emphasis"><em>stay</em></span> dead.
</p><p>Perhaps you might want to consider <span   class="emphasis"><em>not</em></span>
doing this as root <span   class="emphasis"><em>ever</em></span>, and certainly not on
the corporate server.</p><p>Once again, <span   class="emphasis"><em>mes amis</em></span>, it looks as though
the clock has been racing toward closing time. It has been
wonderful having you here at <span   class="emphasis"><em>Chez Marcel</em></span>. I
certainly hope you enjoyed your exploration of process
administration. I must admit I am still a little shaken from my
psDooM experience. Perhaps a little more wine to soothe the nerves.
Fran&ccedil;ois, if you would be so kind as to refill our guests'
wineglasses and, of course, <span   class="emphasis"><em>mine</em></span>. Until next
month. <span   class="emphasis"><em>A votre sant&eacute;</em></span>! <span   class="emphasis"><em>Bon
app&eacute;tit</em></span>!</p><p><a href="6321s1.html" target="_self">Resources</a></p></div></div>
<div class="authorblurb"><p><span   class="bold"><b>Marcel
      Gagn&eacute;</b></span> lives in Mississauga, Ontario. He is the
      author of Linux System Administration: A User's Guide (ISBN
      0-201-71934-7), published by Addison-Wesley (and is currently at
      work on his next book). He can be reached via e-mail at
      <a href="mailto:mggagne@salmar.com">mggagne@salmar.com</a>.</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../104/toc104.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>