<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Features of the TCSH Shell</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    LG #35&#10;    "><meta name="keywords" content="programming, shell, development, system, admin"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x2902580.0x29f9ab0"></a>Features of the TCSH Shell</h1></div><div><div class="author"><h3 class="author">Jesper K. Pedersen</h3></div><div class="issuemoyr">Issue #35, March 1997</div></div><div><p>
    LG #35
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x29fa4a8"></a></h2></div></div><p>In this article, I will describe some of
the main features of TCSH, which I believe make it worth using as
the primary log in shell. This article is not meant to persuade
bash users to change. I've never used bash, so I know very little
about it.
</p><p>As some of you know, I've created a configuration tool called
The Dotfile Generator, http://www.imada.ou.dk/~blackie/dotfile/,
which can configure TCSH. I believe that this tool is very handy
for getting the most out of TCSH without having to read the manual
a couple of times. Therefore, I'll refer to this tool several times
throughout this article to show how it can be used to set up
TCSH.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x29fa608"></a>Why is the Shell So Important?</h2></div></div><p>The shell is your interface to executing programs, managing
files and directories, etc. Though very few people are aware of it,
they use the shell frequently in daily work, e.g., completing file
names, using history substitution and aliases. The TCSH shell
offers all of these features and a few more, which the average user
seldom optimizes.</p><p>With a high knowledge of your shell's power, you can decrease
the time you need to spend in the shell, and increase the time
spent on original tasks.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x29fa768"></a>Command Line Completions</h2></div></div><p>An important feature used by almost all users of a shell is
<span   class="emphasis"><em>command line completion</em></span>. With this feature you
don't need to type all the letters of a file name&mdash;just the
ambiguous ones. This means that if you wish to edit a file called
<b  >file.txt</b>, you may need to type only
<b  >fi</b> and press the TAB key, and the shell will
type the rest of the file name for you.</p><p>Basically, one can use completion on files and directories.
This means that you cannot use completion on host names, process
IDs, options for a given program, etc. Another thing you cannot do
with this type of completion is to complete directory names when
typing the argument for the command <b  >cd</b>.</p><p>In TCSH the completion mechanism is enhanced, so that it is
possible to tell TCSH which list to use to complete a particular
command. For example, you can tell TCSH to complete from a list of
host names for the commands <b  >rlogin</b> and
<b  >ping</b>. An alternative is to tell it to complete
only on directories when the command is
<b  >cd</b>.</p><p>To configure user-defined completion using The Dotfile
Generator (TDG), go to the TDG page <b  >completion -&gt;
userdefined</b>; this will bring up a page which looks like
Figure 1.</p><p><a href="2066f1.jpg" target="_self">Figure 1. TDG
Completion/Userdefined Page</a></p><p>For the command name, you tell TDG which command you wish to
define a completion for. In this example it is
<b  >rm</b>.</p><p>Next you have to tell TDG to which arguments to the command
this completion applies. To do this, press the button labeled
<b  >Position definition</b>. This will bring up a page,
which is split into two parts as shown in Figures 2 and 3.</p><p><a href="2066f2.jpg" target="_self">Figure 2. TDG
Position Definition Page</a></p><p>In the first part, you tell TDG the position definition that
should be defined from the index of the argument to be completed
(i.e., the one where the TAB key is pressed). Here you can tell it
that you wish to complete on the first argument, all the arguments
except the first one, and so forth.</p><p><a href="2066f3.jpg" target="_self">2066f3.gif</a>Figure 3. TDG Pattern Definition
Page</p><p>The alternative to &ldquo;position-dependent completion&rdquo; is
&ldquo;pattern-dependent completion&rdquo;. This means that you can tell TDG
that this completion should only apply if the current word, the
previous word or the word before the previous word conform to a
given pattern.</p><p>Now you have to tell TDG which list to complete from. To do
this, press the button labeled <b  >List</b>. This will
bring up a page where you can select from a lot of different lists,
e.g., aliases, user names or directories.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x29fb108"></a>Files and Directories</h2></div></div><p>Four of the lists you can select from are <b  >Commands,
Directories, File names</b> and <b  >Text
files</b>. If you select one of these, only elements from
that directory are used.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x29fb2c0"></a>Predefined Lists</h2></div></div><p>There are two ways to specify completion from a predefined
list. One is to mark the option <b  >predefined list</b>,
and type all the options in this list.</p><p>This solution is a bad idea if the list is used in several
places (e.g., a list of host names). In that case, one should
select the list to be located in a variable, then set this variable
in the <b  >.tcshrc</b> file.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x29fb4d0"></a>Output from Command</h2></div></div><p>In many cases the list should be
<span   class="emphasis"><em>calculated</em></span> when the completion takes place.
For example, a list of users located at a given host or targets in
a makefile would need to be calculated.</p><p>To set up such a completion, first develop the command which
returns the list to complete from. The command must return the
completion list on standard output as a space-separated list. When
this is done, insert this command in the entry <b  >Output From
Command</b>.</p><p>Here's a little Perl command which finds the targets in a
makefile:</p><pre     class="programlisting">
perl -ne 'if (/^([^.#][^:]+):/) {print "$1 "}'
        Makefile
If this is inserted in the entry, you can complete on targets from the file
called Makefile in the current working directory.
If someone should think I describe TCSH through it only in order
to promote TDG,(s)he should take a look at the following line, which is the
generated code for the <b  >make</b> completion:
</pre><pre     class="programlisting">
complete make  'p@*@`perl -ne \
        '"'"'&gt;if (/^([^.#][^:]+):/) \
        {print "$1"}'"'"'Makefile`@'
</pre></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x29fb840"></a>Restrict to Pattern</h2></div></div><p>With user-defined completion, you can restrict the files
which are matched for each command. Here are two very useful
examples:</p><div class="itemizedlist"><ul type="disc"><li><p>Restrict latex to *.{tex,dtx,ins} The latex command
will complete only on files ending in the extensions
<b  >.tex</b>, <b  >.dtx</b> or
<b  >.ins</b>.</p></li><li><p>Restrict <b  >rm</b> to
^*.{tex,html,c,h}.` This means that you cannot complete
<b  >rm</b> to a <b  >.tex</b>,
<b  >.html</b>, <b  >.c</b> or
<b  >.h</b> file. I've done that a few times, when I
wanted to delete a file called important.c~. Since the file
important.c existed, TCSH completed only to that name, and... I
deleted the wrong file, because I was too quick.</p></li></ul></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x2df4068"></a>Additional Examples</h2></div></div><p>Additional examples can be obtained by loading the export
file distributed with TDG. Please note that if you wish to keep the
other pages, you have to tell TDG to import only the page
<b  >completion/userdefined</b>. This is done on the
<b  >Details</b> page, which is accessible from the
<b  >reload</b> page.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x2df4278"></a>Configuring the Prompt</h2></div></div><p>Configuring the prompt is very easy with TDG. Just enter the
menu called <b  >prompt</b>. On this page you can
configure three prompts:</p><div class="orderedlist"><ol type="1"><li><p><span   class="bold"><b>prompt</b></span>: the usual
prompt, which you see on the command line, where you are about to
enter a command</p></li><li><p><span   class="bold"><b>prompt2</b></span>: is used
in <b  >foreach</b>, and <b  >while</b> loops,
and at lines continuing lines ended with a slash</p></li><li><p><span   class="bold"><b>prompt3</b></span>: is used
when TCSH tries to help you, when it meets commands it doesn't
know&mdash;i.e., spell checking</p></li></ol></div><p>The prompts are mixed with tokens and ordinary text. The
tokens are inserted by clicking on them in the menu below the
scrollbar, and the ordinary text is simply typed in. When a token
is inserted, an indication will be shown in the entry. Figure 4 is
an example of how this may look.
</p><p><a href="2066f4.jpg" target="_self"> Figure 4. Prompt and Text Mix</a></p><p>Some of the prompts may be positioned in the xterm title bar
instead of on the command line. To do this, choose <b  >font
change</b> and select <b  >Xterm</b>.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x2df4a08"></a>History</h2></div></div><p>The history mechanism of the shell makes it easier to type
similar commands after each other. To see a list of the previously
executed commands, type <b  >history</b>.</p><p>The following table lists the <span   class="emphasis"><em>event
specifiers</em></span>:</p><div class="table"><a name="N0x2902580.0x2df4c18"></a><p class="title"><b></b></p><table     summary="" border="1"><colgroup><col><col></colgroup><tbody><tr><td><p>!n</p></td><td><p>This refers to the history event, with index
<b  >n</b></p></td></tr><tr><td><p>!-n</p></td><td><p>This refers to the history event which was executed
<b  >n</b> times ago: <b  >!-1</b> for the
previous command, <b  >!-2</b> for the one before the
previous command, etc.</p></td></tr><tr><td><p>!!</p></td><td><p>This refers to the previous command</p></td></tr><tr><td><p>!#</p></td><td><p>This refers to the current command</p></td></tr><tr><td><p>!s</p></td><td><p>This refers to the most recent command whose first
word begins with the string <b  >s</b></p></td></tr><tr><td><p>!?s?</p></td><td><p>This refers to the most recent command which contains
the string <b  >s</b></p></td></tr></tbody></table></div><p>With these event specifiers, you can re-execute a command,
e.g., just type <b  >!!</b>, to re-execute the previous
command. However, this is often not what you want to do. What you
really want is to re-execute some part of a previous command, with
some new elements added. To do this, you can use one of the
following <span   class="emphasis"><em>word designators</em></span>, which is appended
to the event specifier with a colon.</p><div class="table"><a name="N0x2902580.0x2df5ae0"></a><p class="title"><b></b></p><table     summary="" border="1"><colgroup><col><col></colgroup><tbody><tr><td><p>0</p></td><td><p>The first word, i.e., the command name</p></td></tr><tr><td><p>n</p></td><td><p>The <b  >n</b>th word</p></td></tr><tr><td><p>$</p></td><td><p>The last argument</p></td></tr><tr><td><p>%</p></td><td><p>The word matched by an <b  >?s?</b>
search</p></td></tr><tr><td><p>x-y</p></td><td><p>Argument range from x to y</p></td></tr><tr><td><p>*</p></td><td><p>All the arguments to the command (equal to ^-$)</p></td></tr></tbody></table></div><p>Now it's possible to get the last argument from the previous
command, by typing <b  >!!:$</b>. You'll often see that
you need to refer to the previous command, so if no event specifier
is given, the previous command is used. This means that instead of
typing <b  >!!:$</b>, you need type only
<b  >!$</b>.</p><p>More word designators exist, and it's even possible to edit
the words with different commands. For more information and
examples, please take a look at the TCSH manual found on-line at
http://www.imada.ou.dk/Technical/Manpages/tcsh/History_substitution.html.</p><p>It is possible to expand the history references on the
command line before you evaluate them by pressing ESC-SPC or ESC-!.
(That is: first the escape key, and next the space bar or the
<b  >!</b> key). On some keyboards you may use the meta
key instead of the ESC key, i.e., M-SPC (one keystroke).</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x2d072b8"></a>Patterns</h2></div></div><p>Many operations in the shell work on many files, e.g., all
files ending with <b  >.tex</b> or starting with
<b  >test-</b>. TCSH has the ability to
<span   class="emphasis"><em>type</em></span> all these files for you, with file
patterns. The following list shows which possibilities
exist:</p><div class="table"><a name="N0x2902580.0x2d074c8"></a><p class="title"><b></b></p><table     summary="" border="1"><colgroup><col><col></colgroup><tbody><tr><td><p>*</p></td><td><p>Match any number of characters</p></td></tr><tr><td><p>?</p></td><td><p>Match a single character</p></td></tr><tr><td><p>[...]</p></td><td><p>Match any single character in the list</p></td></tr><tr><td><p>[x-y]</p></td><td><p>Match any character within the range of characters
from x to y</p></td></tr><tr><td><p>[^...]</p></td><td><p>Match elements which do not match the list</p></td></tr><tr><td><p>{...}</p></td><td><p>This expands to all the words listed. There's no need
that they match</p></td></tr><tr><td><p>^...</p></td><td><p>^ in the beginning of a pattern negates the
pattern</p></td></tr></tbody></table></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x2d08230"></a>Examples</h2></div></div><div class="itemizedlist"><ul type="disc"><li><p>*.tex: match all files ending with .tex</p></li><li><p>^*.tex: match all files which does not end with
.tex</p></li><li><p>xxx{ab,cde,hifj}yy: match xxxabyy xxxcdeyy and
xxxhifjyy</p></li><li><p>*.[ch] or *.{c,h}: match all .c and .h files</p></li></ul></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x2d085f8"></a>The Shell Expand Patterns</h2></div></div><p>An important thing to be aware of is that it is the shell
which expands the patterns, and
<span   class="bold"><b>not</b></span> the program, which is executed
with the pattern.</p><p>An example of this is the program <b  >mcopy</b>
which copies files from disk. To copy all files, you may wish to
use a asterisk, as in: <b  >mcopy a:* /tmp</b>. However,
this does not work, since the shell will try to expand the
asterisk. Since it cannot find any files which start with
<b  >a:</b>, it will signal an error. So if you wish to
send a asterisk to the program, you have to escape the asterisk:
<b  >mcopy a:\* .</b></p><p>There are two very useful key bindings which can be used with
patterns. The first is <b  >C-xg</b>, which lists all the
files matching the pattern, without executing the command. The
other is <b  >C-x*</b>, which expands the asterisk on the
command line. This is especially useful if you wish to delete all
files ending in .c except <b  >important.c</b>,
<b  >stable.c</b> and <b  >another.c</b>.
Creating a pattern for this might be very hard, so just use the
pattern <b  >*.c</b>. Then type <b  >C-x*</b>,
which will expand <b  >*.c</b> to all your .c files. Now
it's easy to remove the three files from the list.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x2d08c28"></a>Aliases</h2></div></div><p>When using the shell, you will soon recognize that certain
commands are typed again and again. One of the top ten is surely
<b  >ls -la</b>, which lists all files in a directory in
long form.</p><p>TCSH has a mechanism to create aliases for commands. This
means that you can create an alias for <b  >ls -la</b>
called <b  >la</b>.</p><p>Aliases may refer to the arguments of the command line. This
means that you can create a command called <b  >pack</b>
which takes a directory name and packs the directory with tar and
gz.</p><p>Aliases can be a bit hard to create since you often want
history/variable references expanded at the time of use, not at the
definition time. This can be done more easily with TDG; go to the
page <b  >aliases</b> to define aliases. If you end up
with an alias you cannot define on this page, but you can in TCSH,
please send me e-mail (blackie@imada.ou.dk). For more information
about aliases, see the TCSH manual at
http://www.imada.ou.dk/Technical/Manpages/tcsh/Alias_substitution.html.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x2f84cd0"></a>Timing Programs</h2></div></div><p>Have you ever needed to know how long a program took to run,
i.e., how much CPU it used? If so, you may recognize the output
from the TCSH built-in time command:</p><pre     class="programlisting">
0.020u 0.040s 0:00.11 54.5%     0+0k 0+0io 21pf+0w
</pre><p>Informative? Yes but... the GNU time command is a bit more
understandable:
<pre     class="programlisting">
0.01user 0.08system 0:00.32elapsed 28%CPU (0avgtext+0avgdata 0maxresident)k
0inputs+0outputs (0major+0minor)pagefaults 0swaps
</pre>


In TDG you can configure the output from the time command on the
page called <b  >jobs</b> shown in Figure 5.
</p><p><a href="2066f5.jpg" target="_self">Figure 5. TDG
Jobs Page</a></p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2902580.0x2f84fe8"></a>References</h2></div></div><p>As you may have guessed, TDG and this article will help you a
lot in the use of TCSH, but you may need to read a bit more to get
even more out of TCSH. Here are a few references:</p><div class="itemizedlist"><ul type="disc"><li><p>The TCSH manual page at
http://www.imada.ou.dk/Technical/Manpages/tcsh/top.html</p></li><li><p><span   class="emphasis"><em>Using csh &amp; tcsh</em></span> by Paul
DuBois, published by O'Reilly &amp; Associates, 1995:
http://www.primate.wisc.edu/software/csh-tcsh-book/</p></li><li><p>The TCSH mailing list at tcsh@mx.gw.comr (to join
send mail to listserv@mx.gw.com with body text <b  >SUBscribe
TCSH <i><tt>your name</tt></i></b>)</p></li></ul></div></div></div>
<div class="authorblurb"><p><span   class="emphasis"><em>Jesper Pedersen lives in Odense,
      Denmark, where he has studied computer science at Odense University
      since 1990. He is a system manager at the university and also
      teaches computer science. He is very proud of his &ldquo;child&rdquo;, The
      Dotfile Generator, which he wrote as part of his job at the
      university. In his spare time, he does Jiu-Jitsu, listens to music,
      drinks beer and has fun with his girlfriend. He loves pets, and has
      a 200 litre aquarium and two very cute rabbits. His home page can
      be found at http://www.imada.ou.dk/~blackie/&ldquo;, and he can be
      reached at blackie@imada.ou.dk. This article first appeared in
      Issue 12 of</em></span> Linux Gazette.</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../035/toc035.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>