<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Setting Up a Base Linux Install on a Laptop</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    In part 2 of his series on Linux and the laptop, Jay discusses&#10;    how to install and configure Sid.&#10;    "><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x1702580.0x17f9ab0"></a>Setting Up a Base Linux Install on a Laptop</h1></div><div><div class="author"><h3 class="author">Jay Docherty</h3></div><div class="issuemoyr">Issue #0, linuxjournal.com</div></div><div><p>
    In part 2 of his series on Linux and the laptop, Jay discusses
    how to install and configure Sid.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1702580.0x17fa240"></a></h2></div></div><p><a href="../000/6684.html" target="_self">In my previous
article</a>, I discussed the things one should consider when
purchasing a laptop on which Linux will run. This time I would like
discuss a few ways to get the laptop up and running with a base
Linux install. Your first step is selecting a distribution. I have
been using Debian for about five years now and have grown quite
accustomed to it. As a result, much of this article tilts to the
way Debian does things. The goal of this article is to get you up
and running with Debian Sid and the 2.4.20 kernel.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1702580.0x17fa3a0"></a>The Splendor of Sid</h2></div></div><p>Debian has a reputation for being difficult to install.
Although this is not necessarily true, Debian's installer is a far
cry from the fully automated installers of distributions such as
Mandrake and Red Hat. However, there is a benefit to your extra
labor: much more control of how the system is laid out, which
packages are installed and which kernel features are enabled or
disabled. This gives you the freedom to have a system completely
tailored to your specific needs. Debian Sid (unstable) is my
preferred flavor. At the time of this writing, Woody (stable) and
Sarge (testing) also are available. I like Sid because it offers
the latest software in binary form with the shortest release date
turn-around. The largest advantage can be found with all the Debian
flavors, the powerful apt-get system. Combine apt-get with Sid, and
you can be sure your system will be up to date with all the leading
edge (sometimes bleeding edge) applications for the Linux operating
system.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1702580.0x17fa4a8"></a>Early Decisions</h2></div></div><p>To get started, you're going to need a basic kernel to boot
from and to start the install. Before you can boot any kernel, you
need to decide from which medium you would like to boot. You have
two main choices: CD-ROM or floppy disk. This assumes you have a
high-speed internet connection; Sid is available only through
download. I suggest using a CD-ROM where possible. It is faster
than floppies, and you won't have to swap disks around. Compact
disk images can be found
<a href="http://www.Debian.org/CD/netinst" target="_self">here</a> and
floppy disk images can be found
<a href="http://ftp.us.debian.org/debian/dists/woody/main/disks-i386/current/images-1.44" target="_self">here</a>
This is where things can get a little confusing. Even though we are
eventually going to have a Sid system, you must start with the
Woody boot images. You have to trust me on this one. Make a Woody
boot CD-ROM from the ISO image or the corresponding floppy disks
from the six bin files.</p><p>Efforts are being made to try to provide an up-to-date CD-ROM
that users may acquire through snail-mail, but these efforts are
few and far between. This also defeats one of the major advantages
of using an OS that is constantly updated; often, daily updates are
applied to Sid. If you find a major bug with one of Sid's packages,
you can be sure that a fix is soon to follow.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1702580.0x17fa6b8"></a>The Basic Install</h2></div></div><p>Now you should have the CD or floppy disks ready, and your
high speed Internet connection is aching to start downloading
packages. If you're using a CD-ROM, you may have to change a
setting in your laptop's BIOS to be able boot from it; the same
goes for the floppy install. Either way, once the laptop boots a
Debian image you will be presented with a boot prompt. Press Enter
to begin the install or a different option to begin a rescue. The
rescue feature is useful for recovering from a botched kernel
install. As usual, if confusion abounds press F1 for help. An
installation is what we need, so press Enter and fire up the blue
text-based installer if booting from CD-ROM; if you're using
floppies you'll be prompted for the next disk. The Debian
installation is divided into steps. If you so choose, you may jump
around between the steps. To simplify things I outline the basic
order and syntax of the steps below.</p><div class="orderedlist"><ol type="1"><li><p>Configure the Keyboard
</p><p>This is the first step of any OS install; use QWERTY unless
you know otherwise.</p></li><li><p>Partition a Hard Disk
</p><p>This can be a hot issue amongst Linux/UNIX people. Here's my
recommendation for how to partition a laptop or desktop, but not a
server. HDA1 should be swap, and it's size should be twice the size
of your memory. HDA2 should be root and take the remainder of the
drive. In this step, use the cfdisk utility to set up the
partitions. Key tips: don't forget to make your root partition
bootable, don't forget to change your swap partition Type to swap
and don't forget to write your changes to disk.</p></li><li><p>Initialize and Activate a Swap Partition
</p><p>Select the partition you set the swap to in the previous step
and verify your choice.</p></li><li><p>Initialize a Linux Partition
</p><p>Select the partition you set as root and verify your choice.
If you created more than one partition other then swap, repeat this
step incrementally to enable each one.</p></li><li><p>Install Kernel and Driver Modules
</p><p>Select the same media type that you booted from. This is
where CD-ROM users advance much faster, because floppy disk users
have to insert up to five floppies.</p><p>If you are doing a PCMCIA device install, now is the time to
use the alternate choice; go to Configure PCMCIA Support. If you
are not doing a PCMCIA device install, continue with Configure
Device Driver Modules.</p><p>This is where you can specify what external modules the
kernel loads at boot time. Depending on your NIC card, you may have
to load a module for it. Don't fret about loading modules for
devices you are not sure about. The installer lets you know
promptly if it's unable to find your hardware.</p></li><li><p>Configure the Network
</p><p>This is perhaps the most important step of them all. This
option is available only if your kernel detected a networking
device or if you loaded the appropriate module. Go through the
menus and fill in your TCP/IP information.</p><p>A trick I like to do before I start accessing any network
network connections is to switch out of the installer by holding
Alt+Ctrl+F2. This brings you into a fresh console session, from
where you can try pinging an outside address. This is a good way to
verify your TCP/IP settings prior to starting the Net-based
install. This also is a convenient place to fix any TCP/IP problems
you may find. From here you have access not only to config files,
such as resolv.conf, but also to run commands, such as ifconfig.
Once you are confident the network configuration is running
properly, press Alt+Ctrl+F1 to continue with the install.</p></li><li><p>Install the Base System
</p><p>Time to start using that high-speed internet connection.
Select Network to begin a base Linux install from the latest stable
packages at <a href="http://www.Debian.org" target="_self">Debian.org</a>.
A progress bar indicates the download's progress.</p></li><li><p>Make the System Bootable
</p><p>This step asks you where you would like to install LILO.
Unless you have something special in mind, the default is the best
option. If you had another OS in the laptop previously and did not
completely remove all of its system records, you may be prompted to
put your previous OS in a boot menu with Debian. This is pretty
confusing, especially after you rewrote the Inode tables earlier in
the install. When prompted for this choose Ignore.</p></li><li><p>Make a Boot Floppy
</p><p>People installing from CD-ROM can ignore this step as they
may not have a floppy drive with which to format a boot floppy.
Floppy disk users may choose this option to put an emergency
recovery copy of your kernel onto a floppy disk. I skip it because
I can use the rescue floppy that I used to start the install in
case of recovery.</p></li><li><p>Reboot the System
</p><p>Nothing to say here. You're better off if you do what the man
says.</p><p>At this point the system restarts with the freshly installed
2.2.20 kernel. After the reboot is complete, it fires up your
favorite blue text-based installer. First you are asked some
questions pertaining to the date and time zone and then some
security questions. If you're not sure what to answer, go with the
defaults. Finally, it asks some basic password and user creation
questions and then goes back to the topic-based install
process.</p></li><li><p>Shall I Remove PCMCIA Packages?
</p><p>If you are not using any PCMCIA devices, remove these
packages. Its easy to add them later if you need them.</p></li><li><p>Do You Want to Use a PPP Connection to Install the
System?
</p><p>It is not out of the question to do a full Linux install over
a 56k modem. Personally I don't have the patience, and I know many
other people feel the same. If you don't plan to, say No.</p></li><li><p>Choose a Method apt Should Use to Access the Debian
Archive
</p><p>This is where things get tricky. If you were setting up a
Woody system, now would be the time when you would configure your
apt sources and run <b  >tasksel</b>. But because we're
setting up a Sid system, this is the point when we start changing
things. When asked this question, select Cancel. Then you are asked
to run tasksel or dselect; choose No. This halts the install. You
then are asked a couple of package configuration questions and then
dropped to a login prompt.</p></li></ol></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1702580.0x17fb790"></a>It's Sid Time</h2></div></div><p>Log in with root and use the password you specified earlier.
You need to edit /etc/apt/sources to point to Sid's internet-based
sources. It should contain the following lines:</p><pre     class="programlisting">
deb http://ftp.us.Debian.org/Debian/ sid main contrib
deb-src http://ftp.us.Debian.org/Debian/ sid main contrib
deb http://non-us.Debian.org/Debian-non-US sid/non-US main contrib
deb-src http://non-us.Debian.org/Debian-non-US sid/non-US main contrib
</pre><p>Now run <b  >apt-get update</b> and then
<b  >apt-get dist-upgrade</b>.
</p><p>We have just configured apt to use only the Sid package
repositories. Then we updated the system's list of potential
packages to that of Sid's. Finally, we kicked off the apt-get
dist-upgrade command to start the upgrade from Woody to Sid. This
process may take some time to complete. It is essentially updating
all the packages that we downloaded earlier in the Install a Base
System portion of the Woody install, so expect a similar download
time. Once this has completed, you are asked to configure various
packages. As usual, if you are confused, go with the defaults.
After all the new packages are configured, you are returned to the
system's prompt; reboot the system. When it comes back up you
should see Debian GNU/Linux testing/unstable in the header. Welcome
to Sid.</p><p>Now that you have established a bare bones base system, it's
time to install some packages so you can make this laptop useful.
The easiest way to start this is with tasksel. You can start
tasksel with <b  >tasksel</b>, which presents you with
many different package sets. The standard package sets I install
for a non-server system are the X Window System, C, C++ and Tcl/Tk.
If tasksel refuses to open, run <b  >dselect update</b>,
which updates your available package set.</p><p>After the download is complete, you are asked for information
necessary to configure the downloaded packages. The most
significant questions are those regarding the configuration of your
X files. Once you're done configuring the packages, reboot. If
everything goes well when your system comes up, X should start. You
can begin adding packages and customizing them to your
liking.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1702580.0x17fbbb0"></a>Kernel Compiling</h2></div></div><p>At this point it's not necessary to do any more major
modifications to the OS. However, many advantages can be had by
compiling a custom kernel specifically for your machine. The
default may not have certain features enabled that your laptop
offers. For example, power management is not enabled and wireless
support is not present. A custom kernel is vital for those of you
who want to tailor the OS completely to your laptop.</p><p>For anyone new to Linux, the kernel seems like black magic,
some mystical force driving the computer. In reality manipulating
the kernel is not that hard at all. Many utilities can help you and
plenty of documentation is available. With all this said, you can
seriously cripple your operating system with a botched kernel
install. If it doesn't boot (which is the worst case scenario), the
only way to bring it back is from an alternate media recovery. If
you are not familiar with how to recover from a floppy or CD-ROM,
please do not follow my steps for compiling a custom kernel. I
don't want to be responsible for hours of time wasted with an OS
install just to corrupt it with a bad kernel compile.</p><p>With the disclaimer out of the way, we can start the kernel
compile. You first need to download two packages, so run
<b  >apt-get install kernel-package</b> and then
<b  >apt-get install libncurses5-dev</b>.</p><p>Now you need to decide which version of the kernel you want
to build. You can go to
<a href="http://www.kernel.org" target="_self">www.kernel.org</a> and have
the pick of the litter. Here, we're going to build 2.4.20. You can
download it with <b  >apt-get install
kernel-source-2.4.20</b>.</p><p>After this has completed, change directories to /usr/src.
Next you need to link the kernel version directory to Linux with
<b  >ln -s kernel-source-2.4.20 linux</b> . Now, change
directories to Linux, and run <b  >make menuconfig</b>.
This presents you with a text-based menu where you can switch
between kernel parameters. A help menu even is available for
assistance if you are not sure what something means. To complete
this step successfully, it is imperative that you know the
intricate components that make up your laptop. Many kernel
parameters are extremely specific. Be prepared to know minute
details, for example, which AGP controller, sound card chipset,
video card chipset, USB controller or ATA Bus adapter your laptop
has.</p><p>These are the parameters I set for my IBM Thinkpad
R32:</p><div class="itemizedlist"><ul type="disc"><li><p>Loadable module support
<div class="itemizedlist"><ul type="circle"><li><p>Enable loadable module support</p></li><li><p>Set version information on all module
symbols</p></li><li><p>Kernel module loader</p></li></ul></div>

</p></li><li><p>Processor type and features
<div class="itemizedlist"><ul type="circle"><li><p>(Pentium-4) Processor family</p></li><li><p>Machine Check Exception
<div class="itemizedlist"><ul type="disc"><li><p>/dev/cpu/microcode - Intel IA32 CPU microcode
support</p></li><li><p>/dev/cpu/*/msr - Model-specific register
support</p></li><li><p>/dev/cpu/*/cpuid - CPU information support</p></li><li><p>(off) High Memory Support</p></li></ul></div>

</p></li><li><p>MTRR (Memory Type Range Register) support</p></li></ul></div>

</p></li><li><p>General setup
<div class="itemizedlist"><ul type="circle"><li><p>Networking support</p></li><li><p>PCI support</p></li><li><p>(Any) PCI access mode</p></li><li><p>ISA bus support</p></li><li><p>PCI device name database</p></li><li><p>Support for hot-pluggable devices</p></li></ul></div>

</p></li><li><p>PCMCIA/CardBus support
<div class="itemizedlist"><ul type="circle"><li><p>PCMCIA/CardBus support</p></li><li><p>CardBus support</p></li><li><p>System V IPC</p></li><li><p>BSD Process Accounting</p></li><li><p>Sysctl support</p></li><li><p>Kernel core (/proc/kcore) format</p></li><li><p>Kernel support for a.out binaries</p></li><li><p>Kernel support for ELF binaries</p></li><li><p>Kernel support for MISC binaries</p></li><li><p>Power Management support</p></li><li><p>Advanced Power Management BIOS support</p></li></ul></div>

</p></li><li><p>Plug and Play configuration
<div class="itemizedlist"><ul type="circle"><li><p>Plug and Play support</p></li></ul></div>

</p></li><li><p>Networking options
<div class="itemizedlist"><ul type="circle"><li><p>Packet socket</p></li><li><p>UNIX domain sockets</p></li><li><p>TCP/IP networking</p></li></ul></div>

</p></li><li><p>ATA/IDE/MFM/RLL support
<div class="itemizedlist"><ul type="circle"><li><p>ATA/IDE/MFM/RLL support</p></li></ul></div>

</p></li><li><p>IDE, ATA and ATAPI Block devices
<div class="itemizedlist"><ul type="circle"><li><p>Enhanced IDE/MFM/RLL disk/cdrom/tape/floppy
support</p></li><li><p>Include IDE/ATA-2 DISK support</p></li><li><p>SCSI emulation support</p></li><li><p>Generic PCI IDE chipset support</p></li><li><p>Sharing PCI IDE interrupts support</p></li><li><p>Generic PCI bus-master DMA support</p></li><li><p>Use PCI DMA by default when available</p></li><li><p>Intel PIIXn chipsets support</p></li><li><p>PIIXn Tuning support</p></li></ul></div>

</p></li><li><p>SCSI support
<div class="itemizedlist"><ul type="circle"><li><p>SCSI support</p></li><li><p>SCSI CD-ROM support</p></li><li><p>(2) Maximum number of CDROM devices that can be
loaded as modules</p></li><li><p>SCSI generic support</p></li><li><p>Enable extra checks in new queueing code</p></li><li><p>Probe all LUNs on each SCSI device</p></li></ul></div>

</p></li><li><p>Network device support
<div class="itemizedlist"><ul type="circle"><li><p>Dummy net driver support</p></li><li><p>Ethernet (10 or 100Mbit)
<div class="itemizedlist"><ul type="disc"><li><p>Ethernet (10 or 100Mbit)</p></li><li><p>EISA, VLB, PCI and on board controllers</p></li><li><p>EtherExpressPro/100 support (eepro100, original
Becker driver)</p></li></ul></div>

</p></li><li><p>Wireless LAN (non-hamradio)
<div class="itemizedlist"><ul type="disc"><li><p>Hermes chipset 802.11b support
(Orinoco/Prism2/Symbol)</p></li><li><p>Hermes PCMCIA card support</p></li></ul></div>

</p></li><li><p>Input core support
<div class="itemizedlist"><ul type="disc"><li><p>Input core support</p></li><li><p>Keyboard support</p></li><li><p>Mouse support</p></li><li><p>(1024) Horizontal screen resolution</p></li><li><p>(768) Vertical screen resolution</p></li></ul></div>

</p></li><li><p>Character devices
<div class="itemizedlist"><ul type="disc"><li><p>Virtual terminal</p></li><li><p>Support for console on virtual terminal</p></li><li><p>Standard/generic (8250/16550 and compatible UARTs)
serial support</p></li><li><p>Unix98 PTY support</p></li><li><p>(256) Maximum number of Unix98 PTYs in use
(0-2048)</p></li><li><p>Mice
<div class="itemizedlist"><ul type="circle"><li><p>Mouse Support (not serial and bus mice)</p></li><li><p>PS/2 mouse (aka &ldquo;auxiliary device&rdquo;) support</p></li></ul></div>

</p></li><li><p>Intel i8x0 Random Number Generator support</p></li><li><p>/dev/nvram support</p></li><li><p>Enhanced Real Time Clock Support</p></li><li><p>/dev/agpgart (AGP Support)</p></li><li><p>Intel 440LX/BX/GX and
I815/I820/I830M/I830MP/I840/I845/I850/I860</p></li><li><p>Direct Rendering Manager (XFree86 DRI
support)</p></li><li><p>ATI Radeon</p></li></ul></div>

</p></li><li><p>Filesystems
<div class="itemizedlist"><ul type="disc"><li><p>Kernel automounter version 4 support (also supports
v3)</p></li><li><p>Virtual memory filesystem support (former shm
fs)</p></li><li><p>ISO 9660 CDROM filesystem support</p></li><li><p>/proc filesystem support</p></li><li><p>/dev/pts filesystem for Unix98 PTYs</p></li><li><p>Second extended fs support</p></li></ul></div>

</p></li><li><p>Console drivers
<div class="itemizedlist"><ul type="disc"><li><p>VGA text console</p></li><li><p>Video mode selection support</p></li></ul></div>

</p></li><li><p>Sound
<div class="itemizedlist"><ul type="disc"><li><p>Sound card support</p></li></ul></div>

</p></li><li><p>USB support
<div class="itemizedlist"><ul type="disc"><li><p>Support for USB</p></li><li><p>Preliminary USB device filesystem</p></li><li><p>UHCI Alternate Driver (JE) support</p></li><li><p>USB Human Interface Device (full HID)
support</p></li></ul></div>

</p></li></ul></div>

</p></li></ul></div><p>After you have gone through the lengthy process of selecting
the parameters you like, there are a few different ways to compile
the kernel. One way is to run <b  >make-kpkg clean</b>
and then <b  >make-kpkg --revision yourname.1
kernel_image</b>. This uses the make-kpkg utility, a Debian
tool used to assist you with compiling kernels. It compiles the
kernel and all associated modules and puts them in a .deb package
one directory below your kernel source. After you have built the
package you can install it with the dpkg utility. I like this
because it's easy to keep multiple kernel compiles around.
Especially if you are troubleshooting a problem, your latest
compile may not be the best. If you're having a problem, all you
have to is install an older, more successful one.</p><p>The make-kpkg method replaces the more standard six step
method of</p><pre     class="programlisting">
make dep
make
make bzImage
make modules
make install
make modules_install
</pre><p>Both techniques work, but if you are trying a kernel
recompile on a non-Debian system, you do not have the make-kpkg
utility at your disposal.</p><p>After you have compiled and installed your new kernel, reboot
to see how its working. Don't fret if you get some random errors
here and there. You can always chase those down. Your main worry is
if you get to a valid prompt and the system is coming up in
multi-user mode. If the system boots completely, you have jumped
the first big hurdle. You can run <b  >uname -a</b> to
verify that you are indeed running the latest kernel.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x1702580.0x1d84768"></a>Conclusion</h2></div></div><p>As you can see, installing Sid and recompiling the kernel
definitely has a lot of steps but is not overly complicated. A
couple times through, and it becomes second nature. As with all
Linux-oriented projects, you are never alone. If you get lost,
there are almost unlimited help resources just a web browser away.
May you have a long happy life of kernel tweaking and OS updating
ahead of you.</p></div></div>
<div class="authorblurb"><p>
       email: <a href="mailto:jay@docherty.com">jay@docherty.com</a>
       </p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../000/toc000.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>