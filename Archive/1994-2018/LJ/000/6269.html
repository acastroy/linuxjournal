<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>OpenOffice.org Address Books and Form Letters</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    A quick tutorial for importing data sources to be used for&#10;    address books and form letters.&#10;    "><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x2355580.0x244cab0"></a>OpenOffice.org Address Books and Form Letters</h1></div><div><div class="author"><h3 class="author">Ralph Krause</h3></div><div class="issuemoyr">Issue #0, linuxjournal.com</div></div><div><p>
    A quick tutorial for importing data sources to be used for
    address books and form letters.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x244d240"></a></h2></div></div><p>OpenOffice 1.0 is a multi-platform office
suite based on the StarOffice code base. It includes standard
applications such as a word processor, a spreadsheet program, a
presentation manager and a drawing program. This article will
introduce the form letter ability of OpenOffice.org's word
processor and illustrate several ways to import data into the
application.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x244d348"></a>Introducing Address Books</h2></div></div><p>Form letters are documents that contain fields that are
populated when the document is printed. The information used to
populate these fields is pulled from a database called an address
book.</p><p>Address books can be imported from existing sources such as
Netscape's address book or an LDAP server. They can also be created
from a dBase file, spreadsheets or plain-text files.
OpenOffice.org's wizard, called AutoPilot (see Figure 1), can ease
the task of importing address information. Examples of using
AutoPilot are presented below.</p><p>
<div       class="mediaobject"><a href="6269f1.large.jpg"><img src="6269f1.jpg"></a><div class="caption"><p>Auto Pilot</p></div></div>
</p><p>After an address book has been created, the information it
contains can be accessed by clicking View -&gt; Data Sources (see
Figure 2). This opens up a new window along the top edge of the
document that lists all of the available data sources.</p><p>
<div       class="mediaobject"><a href="6269f2.large.jpg"><img src="6269f2.jpg"></a><div class="caption"><p>Viewing Data Sources</p></div></div>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x244d920"></a>Importing Netscape Address Books</h2></div></div><p>To import the address book from either Mozilla 1.0 or
Netscape 6, click File -&gt; AutoPilot -&gt; Address Data Source.
Select Mozilla / Netscape 6.x and click the Next button. Select
whether to use the Personal or Collected addresses, and click the
Next button. Finally, supply a name for this data source, and click
the Create button.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x244da28"></a>Importing Spreadsheets</h2></div></div><p>An OpenOffice.org spreadsheet can be used as an address data
source fairly easily. When you create a spreadsheet to use as an
address book, the first line should contain column headings such as
First Name, Last Name, Phone and Email Address. These column
headings will be used when the spreadsheet is imported.</p><p>In the AutoPilot's Address Data Source wizard, select Other
External Data Source and click Next. Click on the Settings button,
which brings up the Create Address Data Source window (see Figure
3).</p><p>
<div       class="mediaobject"><a href="6269f3.large.jpg"><img src="6269f3.jpg"></a><div class="caption"><p>Create the Address Data Source</p></div></div>
</p><p>Select Spreadsheet in the database type dropdown box, and
enter the spreadsheet filename in the Data Source URL field. Click
OK to close the Create Address Data Source window.</p><p>Next, map the spreadsheet columns to OpenOffice.org's address
fields. This is accomplished by clicking on the Field Assignment
button, selecting the appropriate spreadsheet column header for
each address field and then clicking OK (see Figure 4).</p><p>
<div       class="mediaobject"><a href="6269f4.large.jpg"><img src="6269f4.jpg"></a><div class="caption"><p>Mapping Columns to Address Fields</p></div></div>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x244e058"></a>Importing Text Files</h2></div></div><p>Plain-text files also can be imported and used as address
data sources. The first line of the file should contain field
headings separated by tabs.</p><p>Again, select Other External Data Source from the Auto Pilot
and click on the Settings button. In the Create Address Data Source
window, select Text as the database type and specify the directory
containing the text file as the Data Source URL.</p><p>Click on the Text tab and put a check next to Text Contains
Headers. Select the appropriate data field separator (tabs in this
case) and the extension that you used for the text file. Click on
the Tables tab and put a check mark next to the text file
containing your address data, then click OK. Match OpenOffice.org's
address fields with the headings in the first line of your text
file, the same way as you would with spreadsheets, and click
OK.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x244e210"></a>Connecting to LDAP Servers</h2></div></div><p>Another choice for an address data source is an LDAP server.
Selecting LDAP from the AutoPilot's Address Data Source window and
then clicking Settings will bring up the Create Address Data Source
window. Here you can specify the LDAP server's location and the
user name and password required to access the server.</p><p>A documented issue with OpenOffice 1.0 is that the first
connection to an LDAP server must be made as root. After this first
connection is made, normal users can then access the server. I was
able to connect to a test OpenLDAP server on my system, but I could
not display any information from it. The OpenOffice.org web site
indicates this is another known problem.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x244e370"></a>Importing dBase Files</h2></div></div><p>Finally, you can use dBase files as an address source. Simply
pick Other from the AutoPilot's menu and select dBase as the
Database type. Select the directory containing the .dbf file, and
then make sure the correct filename is checked. After clicking OK,
go through the field assignment procedure to map OpenOffice's
address fields to the fields in the database.</p><p>One advantage of using a dBase file is you can edit the
records it contains when the Data Sources window is displayed.
Address books from other sources can't be edited from the Data
Sources window.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x244e4d0"></a>Address Book Quirks</h2></div></div><p>OpenOffice.org does have some quirks when dealing with
address books. Clicking the refresh button on the View Data Source
window didn't actually update the data shown. The only way to show
the updated information is to restart the application.</p><p>Another problem is the application will hang if you hide the
Data Sources window while Mozilla/Netscape's address book is being
viewed.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x244e630"></a>Creating Form Letters</h2></div></div><p>A form letter is a document containing fields populated by
information from an address book. There are two ways to insert
these fields into a document. One way is to position the cursor
where you want the field and then click Insert -&gt; Fields -&gt;
Other (keyboard shortcut Ctrl-F2). Click on the Database tab and
select Form letter field in the Type list. In the Database
Selection window pick the address book and field to insert, and
then click the Insert button (see Figure 5). This will put a
placeholder in your document where information from the address
book will be inserted. Once you have inserted the fields that you
need, click Close and continue editing your document.</p><p>
<div       class="mediaobject"><a href="6269f5.large.jpg"><img src="6269f5.jpg"></a><div class="caption"><p>Creating a Placeholder</p></div></div>
</p><p>The second way to insert fields is to display an address book
in the Data Sources window and then drag column names from the
table into your document.</p><p>After you have created and saved your form letter template,
you have to generate the letters that will be sent to each
addressee. These letters can be printed out, saved as individual
files on your hard drive or sent as e-mail messages.</p><p>To generate form letters, click File -&gt; Form Letter. This
will bring up the Form Letter window where you can select which
addressees to use (all, selected or a specific range). Choose
whether the letters should be printed, saved to disk or e-mailed,
and then click OK. Note that in order to send your form letters as
e-mail, you must have Netscape 6.x installed. OpenOffice.org can't
send form letters as e-mail using Mozilla.</p><p>OpenOffice.org offers you the ability to filter your address
book data using SQL statements. Because you can create address
books with custom fields, you can target form letters to specific
customers based upon criteria such as a purchased product or a
renewal date. You can also limit your form letter to addressees in
specific area codes, zip codes or states.</p><p>To use this feature, open the Data Source Administration
window (see Figure 6) by clicking Tools -&gt; Data Sources. Select
the database you wish to use, and then click on the Queries tab.
Clicking on the New Queries button will bring up a SQL statement
builder window (see Figure 7). This window allows you to build a
query and run it to see its results. Make sure you include all the
fields in your query that you will insert into your letter. Once
the query works as you would like, you can save it with a
descriptive name and use it again.</p><p>
<div       class="mediaobject"><a href="6269f6.large.jpg"><img src="6269f6.jpg"></a><div class="caption"><p>Filtering with SQL Statements</p></div></div>
</p><p>
<div       class="mediaobject"><img src="6269f7.jpg"><div class="caption"><p>SQL Statement Building</p></div></div>
</p><p>To insert fields from an SQL query, select the query as your
database selection in the Fields dialogue (Insert -&gt; Fields
-&gt; Other). When you generate the form letters (File -&gt; Form
Letters), select the query you wish to use from the Form Letter
window instead of an address book table.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x2445808"></a>Conclusion</h2></div></div><p>Using OpenOffice.org 1.0 to write this article, I found that
it has some quirks. It did crash a few times, but I didn't lose any
of my work. Additionally, OpenOffice.org 1.0 can take a
considerable amount of time to download over a slow internet
connection. However, its price and capabilities can make the
OpenOffice suite worth a try.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x2355580.0x2445910"></a>Resources</h2></div></div><p><a href="http://www.openoffice.org" target="_self">OpenOffice.org</a></p><p><span   class="bold"><b>Ralph Krause</b></span>
(<a href="http://www.netperson.net/~rkrause" target="_self">www.netperson.net/~rkrause</a>)
lives in Michigan's lower peninsula and spends his time writing,
programming, reading and maintaining several web sites.</p></div></div>
<div class="authorblurb"><p>
       email: <a href="mailto:rkrause@netperson.net">rkrause@netperson.net</a>
       </p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../000/toc000.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>