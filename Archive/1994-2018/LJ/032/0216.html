<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>A Beginner's Guide to Compiling Source Code</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;    If you've been hesitant to compile Linux source code, hesitate no&#10;    more&mdash;this article gives complete instructions for your first&#10;    foray.&#10;    "><meta name="keywords" content="programming, operating, system, system, admin, new, user, development"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x245b580.0x2552ab0"></a>A Beginner's Guide to Compiling Source Code</h1></div><div><div class="author"><h3 class="author">Larry Ayers</h3></div><div class="issuemoyr">Issue #32, December 1996</div></div><div><p>
    If you've been hesitant to compile Linux source code, hesitate no
    more&mdash;this article gives complete instructions for your first
    foray.
    </p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x245b580.0x25535b0"></a></h2></div></div><p>One of the first things a newcomer to
Linux often does is search the Internet for interesting and useful
programs to run, quickly discovering that many programs are
available only in the form of a source-code tree (a form that can
be intimidating if one isn't a programmer). For this reason, the
new Linux user needs to become comfortable with the compilation
process, as it truly is a necessary skill for anyone running Linux.
</p><p>I'm not a programmer myself, but I do have a basic knowledge
of how source code becomes an executable file. Possibly my
non-programming status will enable me to bring up information which
might seem &ldquo;too obvious for words&rdquo; to the experienced programmer.
A good introduction to the subject is chapter six of
<span   class="emphasis"><em>Running Linux</em></span> by Matt Welsh and Lar Kaufman
(O'Reilly, 1995).</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x245b580.0x2553768"></a>Compilation Software</h2></div></div><p>The GNU programming utilities, including the gcc compiler,
the make program, the linker and a slew of related tools (many of
which you don't necessarily need to know about) are an integral
part of most Linux distributions. The Slackware distribution has a
menu-driven installation during which you are given the option of
having the GNU programming tools installed. If you elected not to
install these packages, you will have to start up the pkgtool
utility and have them copied to your hard disk.</p><p>There are other free compilers out there, but it is advisable
to stick with the GNU tools, as they are well-maintained and of
high quality. Most Linux software seems to be written with gcc in
mind as well, and the less editing of the supplied Makefiles you
have to do the better off you'll be.</p><p>Applications written in the popular Tcl/Tk programming
languages don't generally use the GNU tools; if they do, the
C-language components are subsidiary to the Tcl/Tk components. You
need to have the Tcl and Tk libraries and executables installed on
your system in order to install the source for this type of
application. These applications aren't compiled in the usual sense.
Installation consists of copying the the Tcl and Tk files to
directories specified in the makefile. These programs are
completely dependent on their ability to access an existing Tcl/Tk
installed base of files, one of the most important of which is the
Tk &ldquo;wish&rdquo; executable.</p><p>As recently as a couple of months ago, it was difficult to
maintain a current Tcl/Tk installation; development was rapid,
binaries weren't always available and the packages could be
difficult to compile successfully. Some of the newer applications
required the beta libraries to function. The situation has
stabilized recently with the release of the non-beta Tcl-7.5 and
Tk-4.1 in both binary and source versions. For these programs most
users are better off installing the binaries since, in my
experience, they can be difficult to compile from source.</p><p>Note that even if you have a reasonably current Linux
distribution, the Tcl/Tk versions included may very well be out of
date. If you want to run the latest versions of such exemplary
applications as TkDesk and TkMan it is well worthwhile to upgrade
your Tcl/Tk files.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x245b580.0x25539d0"></a>Obtaining Source Code</h2></div></div><p>FTP sites can't really be called user-friendly or inviting to
newcomers. The file names are often cryptic, and navigating through
seemingly infinite levels of a directory tree can be frustrating,
especially if you don't know where the file is located. These sites
aren't designed for casual browsing, but the maintainers of the
large archive sites (e.g., ftp://sunsite.unc.edu and its mirrors)
keep the various index files, sometimes in HTML format, which list
the available files with brief descriptions. Usually a file called
NEW exists which lists recent arrivals. The complete index files
can be very large, but are worth downloading in order to be able to
use a text editor with a good search facility to search for
keywords or file names which interest you.</p><p>In general, a file called filename.tar.gz will usually be a
source code directory tree, tarred and gzipped. The binary
distributions usually have a name patterned as filename.BIN.tar.gz,
or filename.BIN-ELF.tar.gz.</p><p>Usenet postings in the various Linux newsgroups often contain
locations of various packages.</p><p>I recommend using NcFtp as an FTP client.This well-written
interface to the command-line FTP program has many convenient
features, such as remembering every site you visit in a bookmarks
file, including the directory you were last in. This feature meshes
well with NcFtp's &ldquo;reget&rdquo; function, which allows resumption of
interrupted file transfers at the point the connection was
broken.</p><p>Another handy resource is a recent release of a CD-ROM
containing a snapshot of one of the major Linux FTP archive sites.
Several companies market these CD-ROMs and they are reasonably
priced. Linux software changes so quickly that the files on even
the most recent of these CD-ROMs will probably be back-level by a
version or two, but if you have a sudden desire to compile Xemacs
or the Andrew User Interface System, a CD-ROM will save you a
lengthy download.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x245b580.0x2553c38"></a>Dealing with *.tgz Files</h2></div></div><p>NcFtp can be easily configured to deposit downloaded files in
/usr/local/src, or wherever you like. Once you have your file it
must be unzipped and untarred. Setting up an alias in your
~/.bashrc file (if you use bash) simplifies this process. As an
example, the line</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x245b580.0x2553d40"></a>alias tgz='tar xvzf'</h2></div></div><p>in .bashrc will allow you to expand an archive by typing
<b  >tgz filename.tar.gz</b>. The great majority of
archive files will create a subdirectory, then expand the files and
subdirectories of the archive inside of it. Every now and then you
will run across one which expands right into the current directory.
You can either list the contents of the archive first (tar tzvf
filename.tar.gz), or create a directory and move the files into it
(if you've already expanded it).
</p><p>There are filemanagers available that can expedite these
processes. The Midnight Commander text-mode utility can treat *.tgz
files as virtual directories, allowing you to dive into them and
inspect the contents (read the readme files) without actually
expanding the archive.</p><p>The Tcl/Tk file/desktop manager TkDesk has right-mouse-button
menus specific to archive files; they allow you to list the
contents in an editor window and extract to the current directory
or the root directory.</p><p>One way or another you'll end up with a directory tree
containing the source code. There is a useful Unix convention by
which files that should be read before attempting the compilation
have names in all-caps, e.g., README or CHANGES. There is usually
an important file named INSTALL that should be read closely. Since
capitalized file names are displayed at the top of a directory
listing, these files are easy to find.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x245b580.0x2553fa8"></a>Three Types of Source</h2></div></div><p>Source code packages can be broadly categorized into three
types: programs which include a Configure script, programs using
imake, and programs with a default makefile.</p><p>We'll start with the easiest type, the first mentioned above.
Configure scripts are marvelous constructs&mdash;basically, they are
shell programs that wander at will throughout your Linux system,
checking for the presence of various libraries and header files.
The scripts use this information to build a proto-makefile,
converting it into a Makefile customized to your system. I've found
that programs using these scripts compile very easily. After the
script does its work, it's usually just a matter of typing
<b  >make</b>, then <b  >make install</b> when
the process is complete.</p><p>Many source packages use the <b  >imake</b>
program, usually via its shell script interface
<b  >xmkmf</b>. These packages will have an Imakefile and
a makefile.in. The compilation begins with the invocation of
<b  >imake</b>, usually by typing
<b  >xmkmf</b>. Imake is a C preprocessor; it generates
your Makefile using makefile.in as a template and information
stored in various templates and macro files, usually located in
/usr/X11R6/lib/X11/config. Fortunately, you don't need to
understand how this works to use it. The Imakefile is the only file
you should need to modify, usually just by setting preferred
installation paths and the locations of some vital
libraries.</p><p>The simplest, but most problematic, type of source package
has a default Makefile included. This Makefile will have to be
carefully edited in order to ensure that the proper libraries are
included. Sometimes, especially if the source was written for a
machine very like yours, these packages will compile with minimal
Makefile-editing. But they can also bomb, so spend a little time
trying a few things, and know when the time spent isn't worth the
dubious results.</p><p>Luckily, the most useful and popular programs tend to compile
easily, as a result of more people being involved and submitting
bug-reports. Many free programs are available that have makefiles
for a wide variety of operating systems, including OS/2, Windows
NT&mdash;even DOS.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x245b580.0x2554420"></a>The Compilation Process</h2></div></div><p>Much can be learned by watching the status messages from your
compiler scroll down the screen. Each *.c file in the source
directory is first compiled into an object file (*.o). In this
process the human-readable ASCII text source file is converted into
binary format. This phase is the most time-consuming. If you're
still watching near the end of the process, you will see a dramatic
flurry of activity as the object files are linked together, and the
shared libraries the finished executable needs in order to run are
linked as well. Then the process abruptly stops. gcc doesn't tell
you that it compiled the executable successfully. It will, however,
tell you if there were errors and it can't finish the compile. It's
always a kick to do a quick <b  >ls</b> after the
compile, to verify that there actually is a shiny, new,
never-before-executed program waiting to be tried.</p><p>In my experience, most fatal errors involve the
library-linking step. A little common sense helps here; make sure
you have the library, and that it is in a location known about by
ldd, the library loader. Sometimes the problem is a missing
symbolic link, linking a lib in a nonstandard location to one of
the normal library directories. If the version of the library you
have is outdated or wrong, gcc will say so in the error
message.</p><p>The Xpm libraries can be a source of compilation problems.
There are quite a few versions out there, and some programs are
picky about accepting them. If you upgrade to a newer Xpm lib in
order to get something to compile, don't be surprised if some of
your older X applications stop working. I have yet to figure out a
way to have more than one version of Xpm active at the same time.
As finicky as Xpm is, it has become a vital part of many X
programs. I'm beginning to realize what motivated people to create
coherent, upgradeable Linux distributions.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x245b580.0x2554630"></a>A Few Hints</h2></div></div><p>In several instances I've failed miserably with a source
distribution, then weeks or months later downloaded a later version
and had it compile cleanly. Perhaps I updated a library the
Makefile was looking for, or perhaps the author made a change in
the source which fortuitously caused the program to be compatible
with my system. In other words, it's worthwhile to try again later
when you initially have a problem.</p><p>Another situation I've found myself in: after several edits
of the Makefile and perhaps a few header files I'm getting more and
more compiler errors. Nothing seems to work and I can't seem to
make any headway. This is an ideal time to delete the entire
directory tree and reinstall it from the archive file. Sometimes a
completely fresh start helps.</p><p>One compiler flag to watch out for in the Makefile is -g (as
in <b  >gcc -g</b>). The GNU programs often have this
flag, which instructs the compiler to add bulky debugging code to
the executable. This is needed if you plan to use a debugger on the
program. I don't even have a debugger installed, so I routinely
remove that flag. The strip utility will remove this debugging
code, often reducing an executable to half its original
size.</p><p>Virtual consoles are tailor-made for compiling. Once you've
set a lengthy compilation in motion, just switch to another console
and start something else. I like to shut down X-Windows while
compiling, as gcc uses all of the processor cycles it can get. The
more resources that are available, the faster your program will
compile.</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x245b580.0x2554898"></a>Conclusion</h2></div></div><p>So what do you gain from learning to compile programs?</p><div class="itemizedlist"><ul type="disc"><li><p>The range of software available to you is
considerably increased.</p></li><li><p>I believe there is an advantage to using an
executable tuned to your system and configuration.</p></li><li><p>You have the opportunity to specify compiler flags,
like <b  >&gt;\#140&gt;O2</b>, to optimize the code.
Sometimes there are compile-time options that can be set or unset
in the Makefile.</p></li><li><p>Functions or subroutines in the program you know
you will never need can be left out of the executable.</p></li><li><p>Source code is often the only form in which
successive builds are available in beta-testing scenarios.</p></li><li><p>Often more complete documentation will be included
with source code than with a binary distribution.</p></li><li><p>It is interesting to get glimpses into the way
programs are put together. Often source files are heavily
commented, because the programmer might want to explain sections of
code to present or future collaborators in the project.</p></li></ul></div></div></div>
<div class="authorblurb"><p>
      <span   class="bold"><b>Larry Ayers</b></span>
      (<a href="mailto:layers@vax2.rain.gen.mo.us">layers@vax2.rain.gen.mo.us</a>)
      lives on a small farm in norther Missouri, where
      he is currently engaged in building a timber-frame house for his
      family. He operates a portable band-saw mill, does general
      woodworking, plays the fiddle and searches for rare prairie plants,
      as well as growing shiitake mushrooms. He is also struggling with
      configuring a Usenet news server for his local ISP.
    </p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../032/toc032.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>