<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
Be a Mechanic...with Android and Linux!
</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;Check Engine Soon&mdash;that little orange light on your car's instrument&#10;panel is possibly one of the more annoying things about modern&#10;automobiles. Ever had it pop on during a trip and wonder whether it was just&#10;something mundane, like your gas cap being loose, or whether it's something&#10;deathly serious and a piston could come shooting out the side of your&#10;engine block at any time? Well, thanks to an inexpensive little piece of&#10;hardware and an Android tablet, I'll help you decode that little orange&#10;light in your car.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x265f580.0x2756ac0"></a>
Be a Mechanic...with Android and Linux!
</h1></div><div><div class="author"><h3 class="author">
Bill
 
Childers
</h3></div><div class="issuemoyr">Issue #234, October 2013</div></div><div><p>
&ldquo;Check Engine Soon&rdquo;&mdash;that little orange light on your car's instrument
panel is possibly one of the more annoying things about modern
automobiles. Ever had it pop on during a trip and wonder whether it was just
something mundane, like your gas cap being loose, or whether it's something
deathly serious and a piston could come shooting out the side of your
engine block at any time? Well, thanks to an inexpensive little piece of
hardware and an Android tablet, I'll help you decode that little orange
light in your car.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x2757250"></a></h2></div></div><p>
The human race has had automobiles for more than 100 years now, but we've
had 
computer monitors and control engine operation only for
around 30 years or so. The first computer controls were primitive, hard
to work with and expensive. Each automotive manufacturer had its own
computer systems, protocols, connectors and trouble-code definitions. I
worked as a mechanic during the late 1980s and early 1990s, and I remember
those
systems well&mdash;not fondly, of course, but well. Some of those systems
required you to do crazy things like jump a connector with a piece of
wire, then turn the key on and off three times and observe the Check
Engine light as it flashed on and off. You'd have to count the number
of flashes accurately and then look up the &ldquo;trouble code&rdquo; that flashed in
a service manual, and you <span   class="emphasis"><em>might</em></span> get a clue as to what was wrong with
the vehicle. Those early diagnostic systems made seasoned mechanics
who were used to troubleshooting the machinery of an engine rather than
its electronics shudder with trepidation. Over time, the manufacturers
made the systems better. The Society of Automotive Engineers made
the connector, protocol and trouble codes a standard in 1996, and with
that, we've got the system in place today: OBD-II (Onboard Diagnostics,
2nd revision).
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x27574b8"></a>
OBD-II Basics</h2></div></div><p>
Any car sold in the United States after 1996 uses the OBD-II computer
system, so the majority of cars on the road today have this system. Thanks
to OBD-II's standardization and age, lots of tools have been released to
work with the system. Because OBD-II defines the connector and protocol,
that means you need both a hardware device to interface with the
connector and some software to speak the protocol.
</p><p>
The hardware I use is the Soliport ELM327 Bluetooth OBD-II Scanner (see the Amazon
link in the Resources section of this article). It's a very inexpensive
(less than $20) dongle that plugs in to the OBD-II port under your dashboard,
draws its power directly from the car and converts the OBD-II-specific
signals to serial-over-Bluetooth. There are other OBD-II scan tools on
the market. Some are just plain-old cables to hook straight into a
computer's RS-232 serial port, and others are as fancy as full-on bridges
to a Wi-Fi network. And, there are other manufacturers of Bluetooth OBD-II scan
tools, but just make sure whatever you get is based on the ELM327 chipset.
</p><p>
Another piece of hardware you'll need is a computer of some kind. Any
Linux-powered laptop with Bluetooth will suffice, but the form factor is
kind of clunky when you're dealing with a cramped automotive cockpit. (See
the Using a Laptop to Scan Your OBD-II System sidebar if you want to use a laptop.) My personal preference is to
use an Android device to interpret the signals coming from the OBD-II
system in the car. I use a Nexus 7 tablet for this, but any Android
device should work. I've used a Motorola Droid RAZR and the
very first HTC G1 Android phone for this as well.
</p><div       class="mediaobject"><a href="11497f1.large.jpg"><img src="11497f1.jpg"></a><div class="caption"><p>
Figure 1. Tools of the Trade: a Nexus 7 Tablet and a Soliport
Bluetooth OBD-II Scanner
</p></div></div><p>
Software-wise, my choice for this on Android is Torque, an excellent
app that not only can collect all the OBD-II stats, but also graph and log
them in myriad ways. (There's also a free version, Torque Lite, that
has a fair deal of the functionality of the full version.) Grab either
one from the Google Play store.
</p><p>
Note that this solution is for read-only access to the OBD-II system in
the car. You can't modify the running parameters of the vehicle with this
adapter, unfortunately (or fortunately, perhaps, as it's very easy to
make a mess of things). Flashing your car's computer with a new fuel
curve or ignition timing map is a nontrivial exercise that requires
an adapter with different voltage levels and different software. So,
don't worry about breaking your car with this solution&mdash;you're just
&ldquo;peeking under the hood&rdquo;.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x2757988"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Using a Laptop to Scan Your OBD-II System</b></p><p>
Although it's possible to use a laptop to do the same duty as an Android
device, it's a little more involved, as the Bluetooth protocol stack on
a Linux laptop requires some more massaging than simply pairing up an
Android device. However, if you're comfortable with the command line and
Bluetooth commands like <tt  >rfcomm</tt>, it's absolutely possible, and
there are some good OBD-II packages like pyobd and openobd. You won't
get some of Torque's value-add features, like accelerometer and GPS
integration, but you still can use the laptop for diagnostic purposes
and data logging.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x2757bf0"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Using an Old Nokia Internet Tablet to Scan Your OBD-II System</b></p><p>
In the December 2008 issue of <span   class="emphasis"><em>LJ</em></span>, I wrote an article
called &ldquo;Hacking the Nokia
Internet Tablet&rdquo;, and I talked about ways to hack and extend the Nokia
N800 tablet. It turns out there's an application for the N800 and N810
called Carman that was designed to work with wired OBD-II adapters,
but it works just fine with the Soliport Bluetooth Scanner. Carman used
to be in the Maemo repositories. I no longer have a working N800,
so I can't check that now, but when my N800 <span   class="emphasis"><em>did</em></span> work, I used it a few
times to diagnose the car. So, if you've got a Nokia device sitting in
a drawer gathering dust, pull it out and put it to use!
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x2757f08"></a>
Using Torque and the Soliport Bluetooth Adapter</h2></div></div><p>
The Soliport adapter comes with a little CD-ROM in the box, but it's not
required for use with an Android device. To get started, you first need to
find the OBD-II port in your car. In most cars sold in the United
States, the port is under the dash on the driver's side of the car. Find
the port, and plug the Soliport in to it.
</p><p>
Next, start the car, because the OBD-II port isn't powered until the car's
ignition is on. (Make sure your garage door is open, please. I don't
want to receive hate mail from your relatives on how you suffocated
from carbon monoxide poisoning!) Next, you need to go through the
standard Bluetooth pairing process to pair your Android device to the
Soliport adapter. (The pairing code is 1234 if you can't find it in
the instructions&mdash;coincidentally, it's the same combination that's on
my luggage.)
</p><p>
Once you've got your Android device all paired up to the Soliport, you're
ready to fire up Torque. Start Torque on your Android device, and you'll
be greeted with the Torque main screen.
</p><div       class="mediaobject"><a href="11497f2.large.jpg"><img src="11497f2.jpg"></a><div class="caption"><p>
Figure 2. The Torque Home Screen
</p></div></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x2758278"></a>
Setting Up Torque</h2></div></div><p>
Now that you have Torque up, select the little &ldquo;settings&rdquo;
slider on the
bottom left of the screen, and select &ldquo;OBD2 Adapter Settings&rdquo;. Set the
connection type as Bluetooth, and choose the Soliport if prompted. Go
back to the main settings screen and select your desired units (Imperial
or Metric), and any other preferences you choose, then flip back to the
Torque main screen.
</p><p>
Next, you're going to create a &ldquo;profile&rdquo; for your vehicle. Select
the settings slider from the main screen as before, then select
&ldquo;Vehicle Profile&rdquo; and &ldquo;Create new profile&rdquo;. Then, fill in the pertinent
information about your vehicle. This information is used by Torque to
compute things that can be calculated, like horsepower, fuel economy
and other metrics. When you're done, go back to the main screen.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x2758590"></a>
Checking for Fault Codes</h2></div></div><p>
Let's start by doing basic diagnostics on your car. From the main screen,
select Fault Codes, then press the large magnifying glass to start a
scan of your car's computer for trouble codes. If your Check Engine light
is on, you'll probably find your issue represented as a code here. My
father's 2001 Chevy Silverado pickup was showing a Check Engine light, and
I ran a quick scan on it with Torque. It resulted in a trouble code of
P1416. A quick Google search of that trouble code showed that it was the
Secondary Air Valve, Bank 2. It turned out that was a little smog system
valve right on top of the engine, on the passenger side. Amazon.com had
that particular part for $37, and we had it at his house in two days.
</p><p>
I had the Check Engine light on my wife's Durango pop on not long after,
and I used the tool to scan her car. Her car came back with a P0440
code, which means &ldquo;Evaporative Emission Control System
Malfunction&rdquo;. I
searched a bit more on the Internet and found that the most common
cause of this code is a broken or mis-installed fuel filler cap. It turned
out that was exactly the case&mdash;her fuel filler cap wasn't tightened
all the way. I tightened the cap and cleared the code via the Torque app,
and it never returned.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x2758748"></a>
Getting Performance Data</h2></div></div><p>
Those two cases listed above more than paid for the cost of the Soliport
adapter and the Torque application, but Torque can do so much more. Torque
can pull data from sources other than your OBD-II sensors. It also
can poll your Android device's accelerometer and GPS. This means it can do
performance calculations, such as 0&ndash;60 mph time (or 0&ndash;100 kph time), 1/4
mile time or even horsepower calculations. This requires that you get
your car's data entered correctly into the vehicle profile during setup
time, particularly the vehicle weight (including your weight as driver,
and any other stuff you may have inside the car). If you do performance
testing, make sure you're doing it safely&mdash;and don't violate any laws
in your locality.
</p><p>
However, I think one of the coolest things that Torque and the Soliport
adapter can do is they can act as an auxiliary instrument panel for your
car. Any bit of information that passes through the OBD-II sensors can
be logged, graphed or placed on a digital dial. You can pick and choose
how you want that information presented as well&mdash;including the size
and position of the graphs and dials. This information can be extremely
valuable, for instance, displaying the current engine manifold vacuum. As
a general rule, under cruise conditions, higher manifold vacuum means
higher fuel economy, so having this gauge up can be handy on long trips.
</p><div       class="mediaobject"><a href="11497f3.large.jpg"><img src="11497f3.jpg"></a><div class="caption"><p>
Figure 3. Torque's Virtual Instrument Panel
</p></div></div><p>
Torque also has other features, like the ability to log your data for
future analysis. It also can graph that data and correlate it to your
GPS position and accelerometer data. This can be useful if you happen to
be an amateur racer and would like to get information about your car's
performance at certain points on the racetrack. Most people won't need
that ability, but it's nice to know that the developer of Torque thought
that out. All the data necessary to do those calculations is there,
it just needs to be glued together.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x2758b10"></a>
Closing</h2></div></div><p>
Computer control systems in cars used to be mysterious, overly
complicated, finicky pieces of technological voodoo to even
the most seasoned mechanic. Scan tools were proprietary and cost
thousands of dollars, and mechanics needed a special tool for each car
manufacturer. With the advent of OBD-II and inexpensive computers,
it's now easy to de-mystify and diagnose your car. Don't let the strange
terms fool you&mdash;like the computers you're already familiar with, an
automobile is just a collection of technology and machinery, and you can
troubleshoot it just like a computer.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x2758c18"></a></h2></div></div><div class="sidebar"><p class="title"><b>
Resources</b></p><p>
Soliport ELM327 Bluetooth OBD-II Scanner:
<a href="http://www.amazon.com/Soliport-Bluetooth-OBDII-Diagnostic-Scanner/dp/B004KL0I9I" target="_self">www.amazon.com/Soliport-Bluetooth-OBDII-Diagnostic-Scanner/dp/B004KL0I9I</a>
</p><p>
Torque Android OBD-II Scanner App:
<a href="https://play.google.com/store/apps/details?id=org.prowl.torque&amp;hl=en" target="_self">https://play.google.com/store/apps/details?id=org.prowl.torque&amp;hl=en</a>
</p><p>
Torque Lite (FREE) Android OBD-II Scanner App: <a href="https://play.google.com/store/apps/details?id=org.prowl.torquefree&amp;hl=en" target="_self">https://play.google.com/store/apps/details?id=org.prowl.torquefree&amp;hl=en</a>
</p><p>
OBD-II Trouble Code Lookup: <a href="http://www.obd-codes.com/trouble_codes" target="_self">www.obd-codes.com/trouble_codes</a>
</p><p>
PyOBD Home Page:
<a href="http://www.obdtester.com/pyobd" target="_self">www.obdtester.com/pyobd</a>
</p><p>
OpenOBD Home Page:
<a href="http://sourceforge.net/apps/mediawiki/openobd/index.php?title=OpenOBD" target="_self">sourceforge.net/apps/mediawiki/openobd/index.php?title=OpenOBD</a>
</p><p>
Carman on the Nokia N800: <a href="http://tabletblog.com/2007/02/carman-bluetooth-elmscan-5-and-n800.html" target="_self">tabletblog.com/2007/02/carman-bluetooth-elmscan-5-and-n800.html</a>
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x265f580.0x2b514f0"></a></h2></div></div><div class="sidebar"><p class="title"><b></b></p><p>Send comments or feedback via <a href="http://www.linuxjournal.com/contact" target="_self">www.linuxjournal.com/contact</a> or to
<a href="mailto:info@linuxjournal.com">info@linuxjournal.com</a>.
</p></div></div></div>
<div class="authorblurb"><p>
Bill Childers is an IT Manager in Silicon Valley, where he lives with his
wife and
two children. He enjoys Linux far too much, and probably should get more sun
from
time to time.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../234/toc234.html">Issue Table of Contents</a>
    <a class="link3" href="../234/11497.html">Article</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>