<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>
OpenOffice.org in the Limelight</title><link rel="stylesheet" href="../css/archive.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.57.0"><meta name="description" content="&#10;How CHIP Special Linux uses OpenOffice.org Writer as&#10;an editorial tool in a multiplatform publishing&#10;house.&#10;"><link rel="stylesheet" href="../../css/archive.css" type="text/css"><script type="text/javascript" src="../../js/archive.js"></script><script type="text/javascript" src="../../js/highlight.js"></script></head><body onload="search_highlight();">
  <div class="headerdiv">
    <a href="../../index.html">
      <img class="topimg" src="../../images/CD_HeaderBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="tophrdiv">
  </div>
  
  <div id="top_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  <div class="article" lang="en"><div class="titlepage"><div><h1 class="title"><a name="N0x18e9580.0x19e0ab0"></a>
OpenOffice.org in the Limelight</h1></div><div><div class="author"><h3 class="author">
Cezary M. Kruk</h3></div><div class="issuemoyr">Issue #130, February 2005</div></div><div><p>
How <span   class="emphasis"><em>CHIP Special Linux</em></span> uses OpenOffice.org Writer as
an editorial tool in a multiplatform publishing
house.
</p></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x18e9580.0x19e13a0"></a></h2></div></div><p>
OpenOffice.org is a great set of software, consisting of several
useful components that offer a lot of options. It is customizable
and introduces many open formats for documents. In order to adapt
the basic configurations to your particular needs, OpenOffice.org allows
you to prepare macros and
additional scripts.
</p><p>
I work as an editor at a Polish free software magazine.
At the beginning of the editorial process,
the author supplies the text and the editor edits it. Editing means
removing common content-related and formal mistakes or errors, as well as
preparing the text in a standard form to make it easier to process at
further stages. The proofreader then corrects the text and the editor
looks through it again and makes the final changes. Finally, the typesetter
prepares the text for printing, and the editor checks the
entire work one last time.
</p><p>
The processed text is in a different format at each stage of this process. Our publishing
house prefers open formats for documents, so our authors deliver
the documents in text or HTML formats and the graphics in PNG
or EPS formats. After editing the document, the editor sends a copy to
the author&mdash;that copy is in HTML. Our proofreaders work on Microsoft
Windows systems and use Microsoft Word, so they need the documents to be in
the .doc file format. Our
typesetters work on Macintosh systems and use QuarkXPress. They
need two kind of documents: Microsoft Word files for printing and checking the
required formats for the article and Macintosh text files for opening the
files in
Quark and processing them.
</p><p>
When our quarterly started in autumn 2000, I was using StarOffice.
Since then, I switched to OpenOffice.org. The methods
to work with authors' text files are similar for StarOffice and
OpenOffice.org. I import the document in text or HTML format using
StarWriter (previously) or
OpenOffice.org Writer (at present), and&mdash;after processing it&mdash;I export it to HTML, Microsoft Word or
the corresponding SDW or SXW file formats.
</p><div       class="mediaobject"><a href="7140f1.large.jpg"><img src="7140f1.jpg"></a><div class="caption"><p>
Figure 1. The KillparZ macro facilitates preprocessing of the imported
text files.
</p></div></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x18e9580.0x19e1768"></a>
Importing Text and HTML Files</h2></div></div><p>
If a source file is prepared well, there should be no problems when
importing it. If
a file is damaged, it must be repaired. This is not difficult to do if you take into account
the open formats of the documents.
</p><p>
Once a file is imported, you need to change it to the proper format. The
editors of Polish, German, French or other non-English language
publications
should change the codepage as well. A standard codepage for Polish
documents, for example, is ISO-8859-2, and the standard codepage for all OpenOffice.org
documents is UTF-8. To convert imported documents in a convenient
way, you need a macro.
The macros I've built for OpenOffice.org consist of several codepage
converters,
including converters from ISO-8859-2 to UTF-8 and vice versa.
</p><p>
Paragraphs in text files written in some text editors
may be broken into a number of lines. To consolidate them,
you need to use the KillparZ macro, which is an
improved version of the killpars macro by Andrew Brown (Figure 1). KillparZ is
a component of the ooo-macro bundle.
</p><p>
Assuming the author of the document declared the appropriate charset, there
shouldn't be a problem with the codepage when you import an HTML file. But
another problem may arise&mdash;the shortcuts associated with your macros stop
working in HTML documents. To make macros work, you need to create an empty
OpenOffice.org Writer document, open the HTML file, copy it, close the HTML
file
and, finally, paste the content into the Writer document.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x18e9580.0x19e1978"></a>
Codepages and DOCs</h2></div></div><p>
Our magazine is published in Polish, so I need to use more sophisticated
methods when exporting files. Specifically, I need to use fonts with
Polish diacritics. My tests of StarWriter and OpenOffice.org Writer
have shown that if you want to avoid problems related to codepages in
non-English language documents, you should use TrueType fonts instead
of Type1 fonts. Moreover, you obtain the best effects of exporting
documents to the Microsoft Word format if you use the same fonts as are used in Microsoft
Windows. The Microsoft fonts,
bundled in Microsoft FontPack, including Times New Roman, Arial and Courier
New, are
sufficient in most cases.
</p><p>
The authors of StarOffice and OpenOffice.org had
to use some reverse engineering to discover how
the Microsoft Word format is constructed. As a
result, the export filter from Writer to Word works
well but not perfectly. Therefore, if you want
to exchange standard document types with
other users, prepare one typical document using all the
necessary formatting, including headers, italics
and boldface. Then make the sample available to
coworkers and ask them if everything works well.
</p><p>
The articles we publish are a simple kind of document. Our
editorial office uses the three above-mentioned fonts,
as well as italic and bold, two levels of headers
and straight tables. We do not include the
graphics in our documents; we simply list the names
of the files in PNG or EPS format. Such
documents can be exported from SDW or SXW formats
to Microsoft Word without any problems.
</p><div       class="mediaobject"><a href="7140f2.large.jpg"><img src="7140f2.jpg"></a><div class="caption"><p>
Figure 2. An HTML file as exported by OpenOffice.org&mdash;it uses styles,
classes and a lot of other unwanted formatting.
</p></div></div><div       class="mediaobject"><a href="7140f3.large.jpg"><img src="7140f3.jpg"></a><div class="caption"><p>
Figure 3. The same HTML file converted using the soffice2html
filter&mdash;more standardized and more readable.
</p></div></div><div       class="mediaobject"><a href="7140f4.large.jpg"><img src="7140f4.jpg"></a><div class="caption"><p>
Figure 4. <span  class="emphasis"><em>CHIP Special</em></span> editorial staff, from left to right: Robert Bielecki
(editor),
Romek Gnitecki (editor in chief), Cezary M. Kruk (<span  class="emphasis"><em>CHIP Special
Linux</em></span>) and
Tomek Borukalo (editor).
</p></div></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x18e9580.0x19e2108"></a>
HTML Format</h2></div></div><p>
Obtaining proper documents in HTML format is slightly more difficult. StarWriter and OpenOffice.org Writer produce sophisticated
HTML, as shown in Figure 2. You can convert this HTML, however, by using a simple Perl script. I
call mine soffice2html. At the beginning of the script, you should
instruct it
to replace line
endings by spaces, like this:

<pre     class="programlisting">

s/\n/ /;

</pre>
</p><p>
Next, you can replace some elements of the code with different ones. For
example, using the commands:

<pre     class="programlisting">

s/&lt;(\/?)B&gt;/&lt;$1STRONG&gt;/g;
s/&lt;(\/?)I&gt;/&lt;$1EM&gt;/g;

</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x18e9580.0x19e2318"></a></h2></div></div><p>
you can replace all &lt;B&gt; ... &lt;/B&gt; and &lt;I&gt; ... &lt;/I&gt; tag pairs
with
&lt;STRONG&gt; ... &lt;/STRONG&gt; and &lt;EM&gt; ... &lt;/EM&gt; tag pairs, so bold
and italic is noted according to established standards.
You then can remove unwanted tags,
such as:

<pre     class="programlisting">

s/&lt;EM&gt;&lt;EM&gt;/&lt;EM&gt;/g;
s/&lt;\/EM&gt;&lt;\/EM&gt;/&lt;\/EM&gt;/g;

</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x18e9580.0x19e2478"></a></h2></div></div><p>
After this, it is good idea to restore some line endings. Simple commands
such as:

<pre     class="programlisting">

s/(.+?)&lt;/$1\n&lt;/g;
s/&gt;(.+?)/&gt;\n$1/g;

</pre>
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x18e9580.0x19e25d8"></a></h2></div></div><p>
put the marks of the line end before and after each HTML tag. To make
your script more professional, you can add the finishing touch by using
the command:

<pre     class="programlisting">

print OUT "&lt;!-- ", "soffice2html: ",
          scalar localtime, " --&gt;\n";

</pre>
</p><p>
This adds a comment to the processed HTML file, which is something like:

<pre     class="programlisting">

&lt;!-- soffice2html: Wed Jul 23 17:34:35 2003 --&gt;

</pre>
</p><p>
Now, if you start with document.sxw and export it to document.html,
you should process the latter one using the command <tt  >soffice2html
document.html</tt> (Figure 3). Filtering HTML files in this way
produces better&mdash;that is, more standardized and more
readable&mdash;code and from 15%&ndash;40%
smaller files. The current version of the ooo-macro bundle includes
the soffice2html script.
</p><p>
To produce a simple Macintosh text file from a document, you should
save it in the Text Encoded file type that uses the appropriate character
set. For Polish documents, for example, the valid set is Eastern Europe.
</p><p>
This method of exporting is good enough for common
tasks, but it's not so good for typographic purposes.
Our articles often need to use symbols for keystrokes when discussing
specific tasks and other
special characters. When you
use the standard method to produce Macintosh text files, you lose all
those characters. To keep them, you need a macro to convert the characters from UTF-8 to
the Macintosh codepage. The appropriate macro,
recode_utf_8_to_apple_macintosh, is a part of the ooo-macro bundle.
</p><p>
In order to produce a text file using the above-mentioned macro,
run it and then save the document as a Text Encoded file type by using
System character set and CR paragraph breaks. The
file includes information that makes the typesetter's job faster
and easier.
</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><h2 class="title"><a name="N0x18e9580.0x19e29a0"></a>
In the Limelight</h2></div></div><p>
Using OpenOffice.org Writer as an editorial tool allows you to process documents
and share them among authors, proofreaders and typesetters in a
way that is transparent for everyone involved. You need only Writer,
some TrueType fonts, a small bundle of macros and the Perl script for
preparing nice HTML files.
</p><p><span   class="bold"><b>Resources for this article:</b></span>
<a href="http://www.linuxjournal.com/article/7925" target="_self">www.linuxjournal.com/article/7925</a>.
</p></div></div>
<div class="authorblurb"><p>
Cezary M. Kruk lives in Wroclaw, Poland. He is an editor for the Polish
quarterly, <span   class="emphasis"><em>CHIP Special Linux</em></span>.
</p></div>

  <div class="toclinks">
    <a class="link1" href="../tocindex.html">Archive Index</a>
    <a class="link2" href="../130/toc130.html">Issue Table of Contents</a>
  </div>
  <div class="bottomhrdiv">
  </div>
  
  <div id="bottom_search">
  <table class="page_search" summary="">
    <tr>
      <td valign="top" align="left">
        <p class="small_shutdown"><a href="/.exit">Shutdown Archive web server</a></p>
      </td>
      <td valign="top" align="right">
        <form method="get" action="/zoom/search.cgi">
          <input type="hidden" name="zoom_sort" value="0" />
          <input type="hidden" name="zoom_xml" value="0" />
          <input type="hidden" name="zoom_per_page" value="10" />
          <input type="hidden" name="zoom_and" value="1" />
          Search: <input type="text" name="zoom_query" size="20" value="" class="zoom_searchbox" />
          <input type="submit" value="Submit" />
        </form>
      </td>
    </tr>
  </table>
  </div>
  
  <div class="footerdiv">
    <a href="../../index.html">
      <img class="bottomimg" src="../../images/CD_FooterBanner.png" alt="LJ Archive"/>
    </a>
  </div>
  
  <div class="copyright">
    Copyright &copy; 1994 - 2018 <cite>Linux Journal</cite>.  All rights reserved.
  </div>
  </body></html>